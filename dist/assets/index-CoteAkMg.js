(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function _S(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Iv={exports:{}},Zu={},Tv={exports:{}},se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Aa=Symbol.for("react.element"),vS=Symbol.for("react.portal"),wS=Symbol.for("react.fragment"),ES=Symbol.for("react.strict_mode"),IS=Symbol.for("react.profiler"),TS=Symbol.for("react.provider"),SS=Symbol.for("react.context"),AS=Symbol.for("react.forward_ref"),RS=Symbol.for("react.suspense"),PS=Symbol.for("react.memo"),CS=Symbol.for("react.lazy"),Ag=Symbol.iterator;function xS(n){return n===null||typeof n!="object"?null:(n=Ag&&n[Ag]||n["@@iterator"],typeof n=="function"?n:null)}var Sv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Av=Object.assign,Rv={};function Ds(n,e,t){this.props=n,this.context=e,this.refs=Rv,this.updater=t||Sv}Ds.prototype.isReactComponent={};Ds.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Ds.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function Pv(){}Pv.prototype=Ds.prototype;function Tf(n,e,t){this.props=n,this.context=e,this.refs=Rv,this.updater=t||Sv}var Sf=Tf.prototype=new Pv;Sf.constructor=Tf;Av(Sf,Ds.prototype);Sf.isPureReactComponent=!0;var Rg=Array.isArray,Cv=Object.prototype.hasOwnProperty,Af={current:null},xv={key:!0,ref:!0,__self:!0,__source:!0};function kv(n,e,t){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Cv.call(e,r)&&!xv.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=t;else if(1<a){for(var u=Array(a),c=0;c<a;c++)u[c]=arguments[c+2];i.children=u}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Aa,type:n,key:s,ref:o,props:i,_owner:Af.current}}function kS(n,e){return{$$typeof:Aa,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Rf(n){return typeof n=="object"&&n!==null&&n.$$typeof===Aa}function DS(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Pg=/\/+/g;function hh(n,e){return typeof n=="object"&&n!==null&&n.key!=null?DS(""+n.key):e.toString(36)}function Ol(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case Aa:case vS:o=!0}}if(o)return o=n,i=i(o),n=r===""?"."+hh(o,0):r,Rg(i)?(t="",n!=null&&(t=n.replace(Pg,"$&/")+"/"),Ol(i,e,t,"",function(c){return c})):i!=null&&(Rf(i)&&(i=kS(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Pg,"$&/")+"/")+n)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Rg(n))for(var a=0;a<n.length;a++){s=n[a];var u=r+hh(s,a);o+=Ol(s,e,t,u,i)}else if(u=xS(n),typeof u=="function")for(n=u.call(n),a=0;!(s=n.next()).done;)s=s.value,u=r+hh(s,a++),o+=Ol(s,e,t,u,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ll(n,e,t){if(n==null)return n;var r=[],i=0;return Ol(n,r,"","",function(s){return e.call(t,s,i++)}),r}function bS(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var _t={current:null},Ll={transition:null},NS={ReactCurrentDispatcher:_t,ReactCurrentBatchConfig:Ll,ReactCurrentOwner:Af};function Dv(){throw Error("act(...) is not supported in production builds of React.")}se.Children={map:ll,forEach:function(n,e,t){ll(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return ll(n,function(){e++}),e},toArray:function(n){return ll(n,function(e){return e})||[]},only:function(n){if(!Rf(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};se.Component=Ds;se.Fragment=wS;se.Profiler=IS;se.PureComponent=Tf;se.StrictMode=ES;se.Suspense=RS;se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NS;se.act=Dv;se.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=Av({},n.props),i=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Af.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(u in e)Cv.call(e,u)&&!xv.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&a!==void 0?a[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=t;else if(1<u){a=Array(u);for(var c=0;c<u;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Aa,type:n.type,key:i,ref:s,props:r,_owner:o}};se.createContext=function(n){return n={$$typeof:SS,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:TS,_context:n},n.Consumer=n};se.createElement=kv;se.createFactory=function(n){var e=kv.bind(null,n);return e.type=n,e};se.createRef=function(){return{current:null}};se.forwardRef=function(n){return{$$typeof:AS,render:n}};se.isValidElement=Rf;se.lazy=function(n){return{$$typeof:CS,_payload:{_status:-1,_result:n},_init:bS}};se.memo=function(n,e){return{$$typeof:PS,type:n,compare:e===void 0?null:e}};se.startTransition=function(n){var e=Ll.transition;Ll.transition={};try{n()}finally{Ll.transition=e}};se.unstable_act=Dv;se.useCallback=function(n,e){return _t.current.useCallback(n,e)};se.useContext=function(n){return _t.current.useContext(n)};se.useDebugValue=function(){};se.useDeferredValue=function(n){return _t.current.useDeferredValue(n)};se.useEffect=function(n,e){return _t.current.useEffect(n,e)};se.useId=function(){return _t.current.useId()};se.useImperativeHandle=function(n,e,t){return _t.current.useImperativeHandle(n,e,t)};se.useInsertionEffect=function(n,e){return _t.current.useInsertionEffect(n,e)};se.useLayoutEffect=function(n,e){return _t.current.useLayoutEffect(n,e)};se.useMemo=function(n,e){return _t.current.useMemo(n,e)};se.useReducer=function(n,e,t){return _t.current.useReducer(n,e,t)};se.useRef=function(n){return _t.current.useRef(n)};se.useState=function(n){return _t.current.useState(n)};se.useSyncExternalStore=function(n,e,t){return _t.current.useSyncExternalStore(n,e,t)};se.useTransition=function(){return _t.current.useTransition()};se.version="18.3.1";Tv.exports=se;var Q=Tv.exports;const or=_S(Q);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VS=Q,OS=Symbol.for("react.element"),LS=Symbol.for("react.fragment"),MS=Object.prototype.hasOwnProperty,FS=VS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jS={key:!0,ref:!0,__self:!0,__source:!0};function bv(n,e,t){var r,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)MS.call(e,r)&&!jS.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:OS,type:n,key:s,ref:o,props:i,_owner:FS.current}}Zu.Fragment=LS;Zu.jsx=bv;Zu.jsxs=bv;Iv.exports=Zu;var w=Iv.exports,Xh={},Nv={exports:{}},Lt={},Vv={exports:{}},Ov={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(U,Z){var ne=U.length;U.push(Z);e:for(;0<ne;){var Re=ne-1>>>1,ge=U[Re];if(0<i(ge,Z))U[Re]=Z,U[ne]=ge,ne=Re;else break e}}function t(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var Z=U[0],ne=U.pop();if(ne!==Z){U[0]=ne;e:for(var Re=0,ge=U.length,Ve=ge>>>1;Re<Ve;){var fn=2*(Re+1)-1,pn=U[fn],mn=fn+1,gn=U[mn];if(0>i(pn,ne))mn<ge&&0>i(gn,pn)?(U[Re]=gn,U[mn]=ne,Re=mn):(U[Re]=pn,U[fn]=ne,Re=fn);else if(mn<ge&&0>i(gn,ne))U[Re]=gn,U[mn]=ne,Re=mn;else break e}}return Z}function i(U,Z){var ne=U.sortIndex-Z.sortIndex;return ne!==0?ne:U.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var u=[],c=[],d=1,p=null,m=3,E=!1,R=!1,D=!1,L=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(U){for(var Z=t(c);Z!==null;){if(Z.callback===null)r(c);else if(Z.startTime<=U)r(c),Z.sortIndex=Z.expirationTime,e(u,Z);else break;Z=t(c)}}function V(U){if(D=!1,P(U),!R)if(t(u)!==null)R=!0,te(M);else{var Z=t(c);Z!==null&&de(V,Z.startTime-U)}}function M(U,Z){R=!1,D&&(D=!1,C(g),g=-1),E=!0;var ne=m;try{for(P(Z),p=t(u);p!==null&&(!(p.expirationTime>Z)||U&&!x());){var Re=p.callback;if(typeof Re=="function"){p.callback=null,m=p.priorityLevel;var ge=Re(p.expirationTime<=Z);Z=n.unstable_now(),typeof ge=="function"?p.callback=ge:p===t(u)&&r(u),P(Z)}else r(u);p=t(u)}if(p!==null)var Ve=!0;else{var fn=t(c);fn!==null&&de(V,fn.startTime-Z),Ve=!1}return Ve}finally{p=null,m=ne,E=!1}}var k=!1,_=null,g=-1,I=5,T=-1;function x(){return!(n.unstable_now()-T<I)}function A(){if(_!==null){var U=n.unstable_now();T=U;var Z=!0;try{Z=_(!0,U)}finally{Z?v():(k=!1,_=null)}}else k=!1}var v;if(typeof S=="function")v=function(){S(A)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,ie=J.port2;J.port1.onmessage=A,v=function(){ie.postMessage(null)}}else v=function(){L(A,0)};function te(U){_=U,k||(k=!0,v())}function de(U,Z){g=L(function(){U(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(U){U.callback=null},n.unstable_continueExecution=function(){R||E||(R=!0,te(M))},n.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<U?Math.floor(1e3/U):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(U){switch(m){case 1:case 2:case 3:var Z=3;break;default:Z=m}var ne=m;m=Z;try{return U()}finally{m=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(U,Z){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var ne=m;m=U;try{return Z()}finally{m=ne}},n.unstable_scheduleCallback=function(U,Z,ne){var Re=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?Re+ne:Re):ne=Re,U){case 1:var ge=-1;break;case 2:ge=250;break;case 5:ge=1073741823;break;case 4:ge=1e4;break;default:ge=5e3}return ge=ne+ge,U={id:d++,callback:Z,priorityLevel:U,startTime:ne,expirationTime:ge,sortIndex:-1},ne>Re?(U.sortIndex=ne,e(c,U),t(u)===null&&U===t(c)&&(D?(C(g),g=-1):D=!0,de(V,ne-Re))):(U.sortIndex=ge,e(u,U),R||E||(R=!0,te(M))),U},n.unstable_shouldYield=x,n.unstable_wrapCallback=function(U){var Z=m;return function(){var ne=m;m=Z;try{return U.apply(this,arguments)}finally{m=ne}}}})(Ov);Vv.exports=Ov;var US=Vv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BS=Q,Vt=US;function B(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Lv=new Set,qo={};function yi(n,e){ls(n,e),ls(n+"Capture",e)}function ls(n,e){for(qo[n]=e,n=0;n<e.length;n++)Lv.add(e[n])}var kn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zh=Object.prototype.hasOwnProperty,zS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Cg={},xg={};function $S(n){return Zh.call(xg,n)?!0:Zh.call(Cg,n)?!1:zS.test(n)?xg[n]=!0:(Cg[n]=!0,!1)}function qS(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function KS(n,e,t,r){if(e===null||typeof e>"u"||qS(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function vt(n,e,t,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var nt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){nt[n]=new vt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];nt[e]=new vt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){nt[n]=new vt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){nt[n]=new vt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){nt[n]=new vt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){nt[n]=new vt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){nt[n]=new vt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){nt[n]=new vt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){nt[n]=new vt(n,5,!1,n.toLowerCase(),null,!1,!1)});var Pf=/[\-:]([a-z])/g;function Cf(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Pf,Cf);nt[e]=new vt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Pf,Cf);nt[e]=new vt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Pf,Cf);nt[e]=new vt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){nt[n]=new vt(n,1,!1,n.toLowerCase(),null,!1,!1)});nt.xlinkHref=new vt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){nt[n]=new vt(n,1,!1,n.toLowerCase(),null,!0,!0)});function xf(n,e,t,r){var i=nt.hasOwnProperty(e)?nt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(KS(e,t,i,r)&&(t=null),r||i===null?$S(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Fn=BS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ul=Symbol.for("react.element"),Mi=Symbol.for("react.portal"),Fi=Symbol.for("react.fragment"),kf=Symbol.for("react.strict_mode"),ed=Symbol.for("react.profiler"),Mv=Symbol.for("react.provider"),Fv=Symbol.for("react.context"),Df=Symbol.for("react.forward_ref"),td=Symbol.for("react.suspense"),nd=Symbol.for("react.suspense_list"),bf=Symbol.for("react.memo"),Hn=Symbol.for("react.lazy"),jv=Symbol.for("react.offscreen"),kg=Symbol.iterator;function to(n){return n===null||typeof n!="object"?null:(n=kg&&n[kg]||n["@@iterator"],typeof n=="function"?n:null)}var De=Object.assign,dh;function yo(n){if(dh===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);dh=e&&e[1]||""}return`
`+dh+n}var fh=!1;function ph(n,e){if(!n||fh)return"";fh=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var u=`
`+i[o].replace(" at new "," at ");return n.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",n.displayName)),u}while(1<=o&&0<=a);break}}}finally{fh=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?yo(n):""}function GS(n){switch(n.tag){case 5:return yo(n.type);case 16:return yo("Lazy");case 13:return yo("Suspense");case 19:return yo("SuspenseList");case 0:case 2:case 15:return n=ph(n.type,!1),n;case 11:return n=ph(n.type.render,!1),n;case 1:return n=ph(n.type,!0),n;default:return""}}function rd(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Fi:return"Fragment";case Mi:return"Portal";case ed:return"Profiler";case kf:return"StrictMode";case td:return"Suspense";case nd:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Fv:return(n.displayName||"Context")+".Consumer";case Mv:return(n._context.displayName||"Context")+".Provider";case Df:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case bf:return e=n.displayName||null,e!==null?e:rd(n.type)||"Memo";case Hn:e=n._payload,n=n._init;try{return rd(n(e))}catch{}}return null}function WS(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rd(e);case 8:return e===kf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Er(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Uv(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function HS(n){var e=Uv(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function cl(n){n._valueTracker||(n._valueTracker=HS(n))}function Bv(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=Uv(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function ou(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function id(n,e){var t=e.checked;return De({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Dg(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Er(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function zv(n,e){e=e.checked,e!=null&&xf(n,"checked",e,!1)}function sd(n,e){zv(n,e);var t=Er(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?od(n,e.type,t):e.hasOwnProperty("defaultValue")&&od(n,e.type,Er(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function bg(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function od(n,e,t){(e!=="number"||ou(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var _o=Array.isArray;function Xi(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Er(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function ad(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(B(91));return De({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Ng(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(B(92));if(_o(t)){if(1<t.length)throw Error(B(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Er(t)}}function $v(n,e){var t=Er(e.value),r=Er(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function Vg(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function qv(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ld(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?qv(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var hl,Kv=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(hl=hl||document.createElement("div"),hl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=hl.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Ko(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Po={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},QS=["Webkit","ms","Moz","O"];Object.keys(Po).forEach(function(n){QS.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Po[e]=Po[n]})});function Gv(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Po.hasOwnProperty(n)&&Po[n]?(""+e).trim():e+"px"}function Wv(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=Gv(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var YS=De({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ud(n,e){if(e){if(YS[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(B(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(B(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(B(61))}if(e.style!=null&&typeof e.style!="object")throw Error(B(62))}}function cd(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hd=null;function Nf(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var dd=null,Zi=null,es=null;function Og(n){if(n=Ca(n)){if(typeof dd!="function")throw Error(B(280));var e=n.stateNode;e&&(e=ic(e),dd(n.stateNode,n.type,e))}}function Hv(n){Zi?es?es.push(n):es=[n]:Zi=n}function Qv(){if(Zi){var n=Zi,e=es;if(es=Zi=null,Og(n),e)for(n=0;n<e.length;n++)Og(e[n])}}function Yv(n,e){return n(e)}function Jv(){}var mh=!1;function Xv(n,e,t){if(mh)return n(e,t);mh=!0;try{return Yv(n,e,t)}finally{mh=!1,(Zi!==null||es!==null)&&(Jv(),Qv())}}function Go(n,e){var t=n.stateNode;if(t===null)return null;var r=ic(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(B(231,e,typeof t));return t}var fd=!1;if(kn)try{var no={};Object.defineProperty(no,"passive",{get:function(){fd=!0}}),window.addEventListener("test",no,no),window.removeEventListener("test",no,no)}catch{fd=!1}function JS(n,e,t,r,i,s,o,a,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(d){this.onError(d)}}var Co=!1,au=null,lu=!1,pd=null,XS={onError:function(n){Co=!0,au=n}};function ZS(n,e,t,r,i,s,o,a,u){Co=!1,au=null,JS.apply(XS,arguments)}function eA(n,e,t,r,i,s,o,a,u){if(ZS.apply(this,arguments),Co){if(Co){var c=au;Co=!1,au=null}else throw Error(B(198));lu||(lu=!0,pd=c)}}function _i(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function Zv(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Lg(n){if(_i(n)!==n)throw Error(B(188))}function tA(n){var e=n.alternate;if(!e){if(e=_i(n),e===null)throw Error(B(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return Lg(i),n;if(s===r)return Lg(i),e;s=s.sibling}throw Error(B(188))}if(t.return!==r.return)t=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o)throw Error(B(189))}}if(t.alternate!==r)throw Error(B(190))}if(t.tag!==3)throw Error(B(188));return t.stateNode.current===t?n:e}function ew(n){return n=tA(n),n!==null?tw(n):null}function tw(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=tw(n);if(e!==null)return e;n=n.sibling}return null}var nw=Vt.unstable_scheduleCallback,Mg=Vt.unstable_cancelCallback,nA=Vt.unstable_shouldYield,rA=Vt.unstable_requestPaint,Oe=Vt.unstable_now,iA=Vt.unstable_getCurrentPriorityLevel,Vf=Vt.unstable_ImmediatePriority,rw=Vt.unstable_UserBlockingPriority,uu=Vt.unstable_NormalPriority,sA=Vt.unstable_LowPriority,iw=Vt.unstable_IdlePriority,ec=null,an=null;function oA(n){if(an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(ec,n,void 0,(n.current.flags&128)===128)}catch{}}var Qt=Math.clz32?Math.clz32:uA,aA=Math.log,lA=Math.LN2;function uA(n){return n>>>=0,n===0?32:31-(aA(n)/lA|0)|0}var dl=64,fl=4194304;function vo(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function cu(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~i;a!==0?r=vo(a):(s&=o,s!==0&&(r=vo(s)))}else o=t&~i,o!==0?r=vo(o):s!==0&&(r=vo(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Qt(e),i=1<<t,r|=n[t],e&=~i;return r}function cA(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hA(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-Qt(s),a=1<<o,u=i[o];u===-1?(!(a&t)||a&r)&&(i[o]=cA(a,e)):u<=e&&(n.expiredLanes|=a),s&=~a}}function md(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function sw(){var n=dl;return dl<<=1,!(dl&4194240)&&(dl=64),n}function gh(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Ra(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Qt(e),n[e]=t}function dA(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Qt(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function Of(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Qt(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var pe=0;function ow(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var aw,Lf,lw,uw,cw,gd=!1,pl=[],ar=null,lr=null,ur=null,Wo=new Map,Ho=new Map,Yn=[],fA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fg(n,e){switch(n){case"focusin":case"focusout":ar=null;break;case"dragenter":case"dragleave":lr=null;break;case"mouseover":case"mouseout":ur=null;break;case"pointerover":case"pointerout":Wo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ho.delete(e.pointerId)}}function ro(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Ca(e),e!==null&&Lf(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function pA(n,e,t,r,i){switch(e){case"focusin":return ar=ro(ar,n,e,t,r,i),!0;case"dragenter":return lr=ro(lr,n,e,t,r,i),!0;case"mouseover":return ur=ro(ur,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return Wo.set(s,ro(Wo.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Ho.set(s,ro(Ho.get(s)||null,n,e,t,r,i)),!0}return!1}function hw(n){var e=Yr(n.target);if(e!==null){var t=_i(e);if(t!==null){if(e=t.tag,e===13){if(e=Zv(t),e!==null){n.blockedOn=e,cw(n.priority,function(){lw(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Ml(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=yd(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);hd=r,t.target.dispatchEvent(r),hd=null}else return e=Ca(t),e!==null&&Lf(e),n.blockedOn=t,!1;e.shift()}return!0}function jg(n,e,t){Ml(n)&&t.delete(e)}function mA(){gd=!1,ar!==null&&Ml(ar)&&(ar=null),lr!==null&&Ml(lr)&&(lr=null),ur!==null&&Ml(ur)&&(ur=null),Wo.forEach(jg),Ho.forEach(jg)}function io(n,e){n.blockedOn===e&&(n.blockedOn=null,gd||(gd=!0,Vt.unstable_scheduleCallback(Vt.unstable_NormalPriority,mA)))}function Qo(n){function e(i){return io(i,n)}if(0<pl.length){io(pl[0],n);for(var t=1;t<pl.length;t++){var r=pl[t];r.blockedOn===n&&(r.blockedOn=null)}}for(ar!==null&&io(ar,n),lr!==null&&io(lr,n),ur!==null&&io(ur,n),Wo.forEach(e),Ho.forEach(e),t=0;t<Yn.length;t++)r=Yn[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Yn.length&&(t=Yn[0],t.blockedOn===null);)hw(t),t.blockedOn===null&&Yn.shift()}var ts=Fn.ReactCurrentBatchConfig,hu=!0;function gA(n,e,t,r){var i=pe,s=ts.transition;ts.transition=null;try{pe=1,Mf(n,e,t,r)}finally{pe=i,ts.transition=s}}function yA(n,e,t,r){var i=pe,s=ts.transition;ts.transition=null;try{pe=4,Mf(n,e,t,r)}finally{pe=i,ts.transition=s}}function Mf(n,e,t,r){if(hu){var i=yd(n,e,t,r);if(i===null)Rh(n,e,r,du,t),Fg(n,r);else if(pA(i,n,e,t,r))r.stopPropagation();else if(Fg(n,r),e&4&&-1<fA.indexOf(n)){for(;i!==null;){var s=Ca(i);if(s!==null&&aw(s),s=yd(n,e,t,r),s===null&&Rh(n,e,r,du,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else Rh(n,e,r,null,t)}}var du=null;function yd(n,e,t,r){if(du=null,n=Nf(r),n=Yr(n),n!==null)if(e=_i(n),e===null)n=null;else if(t=e.tag,t===13){if(n=Zv(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return du=n,null}function dw(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(iA()){case Vf:return 1;case rw:return 4;case uu:case sA:return 16;case iw:return 536870912;default:return 16}default:return 16}}var rr=null,Ff=null,Fl=null;function fw(){if(Fl)return Fl;var n,e=Ff,t=e.length,r,i="value"in rr?rr.value:rr.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===i[s-r];r++);return Fl=i.slice(n,1<r?1-r:void 0)}function jl(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function ml(){return!0}function Ug(){return!1}function Mt(n){function e(t,r,i,s,o){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ml:Ug,this.isPropagationStopped=Ug,this}return De(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=ml)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=ml)},persist:function(){},isPersistent:ml}),e}var bs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jf=Mt(bs),Pa=De({},bs,{view:0,detail:0}),_A=Mt(Pa),yh,_h,so,tc=De({},Pa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uf,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==so&&(so&&n.type==="mousemove"?(yh=n.screenX-so.screenX,_h=n.screenY-so.screenY):_h=yh=0,so=n),yh)},movementY:function(n){return"movementY"in n?n.movementY:_h}}),Bg=Mt(tc),vA=De({},tc,{dataTransfer:0}),wA=Mt(vA),EA=De({},Pa,{relatedTarget:0}),vh=Mt(EA),IA=De({},bs,{animationName:0,elapsedTime:0,pseudoElement:0}),TA=Mt(IA),SA=De({},bs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),AA=Mt(SA),RA=De({},bs,{data:0}),zg=Mt(RA),PA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},CA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kA(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=xA[n])?!!e[n]:!1}function Uf(){return kA}var DA=De({},Pa,{key:function(n){if(n.key){var e=PA[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=jl(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?CA[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uf,charCode:function(n){return n.type==="keypress"?jl(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?jl(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),bA=Mt(DA),NA=De({},tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$g=Mt(NA),VA=De({},Pa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uf}),OA=Mt(VA),LA=De({},bs,{propertyName:0,elapsedTime:0,pseudoElement:0}),MA=Mt(LA),FA=De({},tc,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),jA=Mt(FA),UA=[9,13,27,32],Bf=kn&&"CompositionEvent"in window,xo=null;kn&&"documentMode"in document&&(xo=document.documentMode);var BA=kn&&"TextEvent"in window&&!xo,pw=kn&&(!Bf||xo&&8<xo&&11>=xo),qg=" ",Kg=!1;function mw(n,e){switch(n){case"keyup":return UA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gw(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var ji=!1;function zA(n,e){switch(n){case"compositionend":return gw(e);case"keypress":return e.which!==32?null:(Kg=!0,qg);case"textInput":return n=e.data,n===qg&&Kg?null:n;default:return null}}function $A(n,e){if(ji)return n==="compositionend"||!Bf&&mw(n,e)?(n=fw(),Fl=Ff=rr=null,ji=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return pw&&e.locale!=="ko"?null:e.data;default:return null}}var qA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gg(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!qA[n.type]:e==="textarea"}function yw(n,e,t,r){Hv(r),e=fu(e,"onChange"),0<e.length&&(t=new jf("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var ko=null,Yo=null;function KA(n){Cw(n,0)}function nc(n){var e=zi(n);if(Bv(e))return n}function GA(n,e){if(n==="change")return e}var _w=!1;if(kn){var wh;if(kn){var Eh="oninput"in document;if(!Eh){var Wg=document.createElement("div");Wg.setAttribute("oninput","return;"),Eh=typeof Wg.oninput=="function"}wh=Eh}else wh=!1;_w=wh&&(!document.documentMode||9<document.documentMode)}function Hg(){ko&&(ko.detachEvent("onpropertychange",vw),Yo=ko=null)}function vw(n){if(n.propertyName==="value"&&nc(Yo)){var e=[];yw(e,Yo,n,Nf(n)),Xv(KA,e)}}function WA(n,e,t){n==="focusin"?(Hg(),ko=e,Yo=t,ko.attachEvent("onpropertychange",vw)):n==="focusout"&&Hg()}function HA(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return nc(Yo)}function QA(n,e){if(n==="click")return nc(e)}function YA(n,e){if(n==="input"||n==="change")return nc(e)}function JA(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Zt=typeof Object.is=="function"?Object.is:JA;function Jo(n,e){if(Zt(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!Zh.call(e,i)||!Zt(n[i],e[i]))return!1}return!0}function Qg(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Yg(n,e){var t=Qg(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Qg(t)}}function ww(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?ww(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Ew(){for(var n=window,e=ou();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=ou(n.document)}return e}function zf(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function XA(n){var e=Ew(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&ww(t.ownerDocument.documentElement,t)){if(r!==null&&zf(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=Yg(t,s);var o=Yg(t,r);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var ZA=kn&&"documentMode"in document&&11>=document.documentMode,Ui=null,_d=null,Do=null,vd=!1;function Jg(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;vd||Ui==null||Ui!==ou(r)||(r=Ui,"selectionStart"in r&&zf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Do&&Jo(Do,r)||(Do=r,r=fu(_d,"onSelect"),0<r.length&&(e=new jf("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Ui)))}function gl(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Bi={animationend:gl("Animation","AnimationEnd"),animationiteration:gl("Animation","AnimationIteration"),animationstart:gl("Animation","AnimationStart"),transitionend:gl("Transition","TransitionEnd")},Ih={},Iw={};kn&&(Iw=document.createElement("div").style,"AnimationEvent"in window||(delete Bi.animationend.animation,delete Bi.animationiteration.animation,delete Bi.animationstart.animation),"TransitionEvent"in window||delete Bi.transitionend.transition);function rc(n){if(Ih[n])return Ih[n];if(!Bi[n])return n;var e=Bi[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in Iw)return Ih[n]=e[t];return n}var Tw=rc("animationend"),Sw=rc("animationiteration"),Aw=rc("animationstart"),Rw=rc("transitionend"),Pw=new Map,Xg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(n,e){Pw.set(n,e),yi(e,[n])}for(var Th=0;Th<Xg.length;Th++){var Sh=Xg[Th],eR=Sh.toLowerCase(),tR=Sh[0].toUpperCase()+Sh.slice(1);Pr(eR,"on"+tR)}Pr(Tw,"onAnimationEnd");Pr(Sw,"onAnimationIteration");Pr(Aw,"onAnimationStart");Pr("dblclick","onDoubleClick");Pr("focusin","onFocus");Pr("focusout","onBlur");Pr(Rw,"onTransitionEnd");ls("onMouseEnter",["mouseout","mouseover"]);ls("onMouseLeave",["mouseout","mouseover"]);ls("onPointerEnter",["pointerout","pointerover"]);ls("onPointerLeave",["pointerout","pointerover"]);yi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yi("onBeforeInput",["compositionend","keypress","textInput","paste"]);yi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nR=new Set("cancel close invalid load scroll toggle".split(" ").concat(wo));function Zg(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,eA(r,e,void 0,n),n.currentTarget=null}function Cw(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],u=a.instance,c=a.currentTarget;if(a=a.listener,u!==s&&i.isPropagationStopped())break e;Zg(i,a,c),s=u}else for(o=0;o<r.length;o++){if(a=r[o],u=a.instance,c=a.currentTarget,a=a.listener,u!==s&&i.isPropagationStopped())break e;Zg(i,a,c),s=u}}}if(lu)throw n=pd,lu=!1,pd=null,n}function Ee(n,e){var t=e[Sd];t===void 0&&(t=e[Sd]=new Set);var r=n+"__bubble";t.has(r)||(xw(e,n,2,!1),t.add(r))}function Ah(n,e,t){var r=0;e&&(r|=4),xw(t,n,r,e)}var yl="_reactListening"+Math.random().toString(36).slice(2);function Xo(n){if(!n[yl]){n[yl]=!0,Lv.forEach(function(t){t!=="selectionchange"&&(nR.has(t)||Ah(t,!1,n),Ah(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[yl]||(e[yl]=!0,Ah("selectionchange",!1,e))}}function xw(n,e,t,r){switch(dw(e)){case 1:var i=gA;break;case 4:i=yA;break;default:i=Mf}t=i.bind(null,e,t,n),i=void 0,!fd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Rh(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Yr(a),o===null)return;if(u=o.tag,u===5||u===6){r=s=o;continue e}a=a.parentNode}}r=r.return}Xv(function(){var c=s,d=Nf(t),p=[];e:{var m=Pw.get(n);if(m!==void 0){var E=jf,R=n;switch(n){case"keypress":if(jl(t)===0)break e;case"keydown":case"keyup":E=bA;break;case"focusin":R="focus",E=vh;break;case"focusout":R="blur",E=vh;break;case"beforeblur":case"afterblur":E=vh;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=Bg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=wA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=OA;break;case Tw:case Sw:case Aw:E=TA;break;case Rw:E=MA;break;case"scroll":E=_A;break;case"wheel":E=jA;break;case"copy":case"cut":case"paste":E=AA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=$g}var D=(e&4)!==0,L=!D&&n==="scroll",C=D?m!==null?m+"Capture":null:m;D=[];for(var S=c,P;S!==null;){P=S;var V=P.stateNode;if(P.tag===5&&V!==null&&(P=V,C!==null&&(V=Go(S,C),V!=null&&D.push(Zo(S,V,P)))),L)break;S=S.return}0<D.length&&(m=new E(m,R,null,t,d),p.push({event:m,listeners:D}))}}if(!(e&7)){e:{if(m=n==="mouseover"||n==="pointerover",E=n==="mouseout"||n==="pointerout",m&&t!==hd&&(R=t.relatedTarget||t.fromElement)&&(Yr(R)||R[Dn]))break e;if((E||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,E?(R=t.relatedTarget||t.toElement,E=c,R=R?Yr(R):null,R!==null&&(L=_i(R),R!==L||R.tag!==5&&R.tag!==6)&&(R=null)):(E=null,R=c),E!==R)){if(D=Bg,V="onMouseLeave",C="onMouseEnter",S="mouse",(n==="pointerout"||n==="pointerover")&&(D=$g,V="onPointerLeave",C="onPointerEnter",S="pointer"),L=E==null?m:zi(E),P=R==null?m:zi(R),m=new D(V,S+"leave",E,t,d),m.target=L,m.relatedTarget=P,V=null,Yr(d)===c&&(D=new D(C,S+"enter",R,t,d),D.target=P,D.relatedTarget=L,V=D),L=V,E&&R)t:{for(D=E,C=R,S=0,P=D;P;P=Pi(P))S++;for(P=0,V=C;V;V=Pi(V))P++;for(;0<S-P;)D=Pi(D),S--;for(;0<P-S;)C=Pi(C),P--;for(;S--;){if(D===C||C!==null&&D===C.alternate)break t;D=Pi(D),C=Pi(C)}D=null}else D=null;E!==null&&ey(p,m,E,D,!1),R!==null&&L!==null&&ey(p,L,R,D,!0)}}e:{if(m=c?zi(c):window,E=m.nodeName&&m.nodeName.toLowerCase(),E==="select"||E==="input"&&m.type==="file")var M=GA;else if(Gg(m))if(_w)M=YA;else{M=HA;var k=WA}else(E=m.nodeName)&&E.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(M=QA);if(M&&(M=M(n,c))){yw(p,M,t,d);break e}k&&k(n,m,c),n==="focusout"&&(k=m._wrapperState)&&k.controlled&&m.type==="number"&&od(m,"number",m.value)}switch(k=c?zi(c):window,n){case"focusin":(Gg(k)||k.contentEditable==="true")&&(Ui=k,_d=c,Do=null);break;case"focusout":Do=_d=Ui=null;break;case"mousedown":vd=!0;break;case"contextmenu":case"mouseup":case"dragend":vd=!1,Jg(p,t,d);break;case"selectionchange":if(ZA)break;case"keydown":case"keyup":Jg(p,t,d)}var _;if(Bf)e:{switch(n){case"compositionstart":var g="onCompositionStart";break e;case"compositionend":g="onCompositionEnd";break e;case"compositionupdate":g="onCompositionUpdate";break e}g=void 0}else ji?mw(n,t)&&(g="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(g="onCompositionStart");g&&(pw&&t.locale!=="ko"&&(ji||g!=="onCompositionStart"?g==="onCompositionEnd"&&ji&&(_=fw()):(rr=d,Ff="value"in rr?rr.value:rr.textContent,ji=!0)),k=fu(c,g),0<k.length&&(g=new zg(g,n,null,t,d),p.push({event:g,listeners:k}),_?g.data=_:(_=gw(t),_!==null&&(g.data=_)))),(_=BA?zA(n,t):$A(n,t))&&(c=fu(c,"onBeforeInput"),0<c.length&&(d=new zg("onBeforeInput","beforeinput",null,t,d),p.push({event:d,listeners:c}),d.data=_))}Cw(p,e)})}function Zo(n,e,t){return{instance:n,listener:e,currentTarget:t}}function fu(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Go(n,t),s!=null&&r.unshift(Zo(n,s,i)),s=Go(n,e),s!=null&&r.push(Zo(n,s,i))),n=n.return}return r}function Pi(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function ey(n,e,t,r,i){for(var s=e._reactName,o=[];t!==null&&t!==r;){var a=t,u=a.alternate,c=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&c!==null&&(a=c,i?(u=Go(t,s),u!=null&&o.unshift(Zo(t,u,a))):i||(u=Go(t,s),u!=null&&o.push(Zo(t,u,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var rR=/\r\n?/g,iR=/\u0000|\uFFFD/g;function ty(n){return(typeof n=="string"?n:""+n).replace(rR,`
`).replace(iR,"")}function _l(n,e,t){if(e=ty(e),ty(n)!==e&&t)throw Error(B(425))}function pu(){}var wd=null,Ed=null;function Id(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Td=typeof setTimeout=="function"?setTimeout:void 0,sR=typeof clearTimeout=="function"?clearTimeout:void 0,ny=typeof Promise=="function"?Promise:void 0,oR=typeof queueMicrotask=="function"?queueMicrotask:typeof ny<"u"?function(n){return ny.resolve(null).then(n).catch(aR)}:Td;function aR(n){setTimeout(function(){throw n})}function Ph(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),Qo(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);Qo(e)}function cr(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function ry(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Ns=Math.random().toString(36).slice(2),rn="__reactFiber$"+Ns,ea="__reactProps$"+Ns,Dn="__reactContainer$"+Ns,Sd="__reactEvents$"+Ns,lR="__reactListeners$"+Ns,uR="__reactHandles$"+Ns;function Yr(n){var e=n[rn];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Dn]||t[rn]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=ry(n);n!==null;){if(t=n[rn])return t;n=ry(n)}return e}n=t,t=n.parentNode}return null}function Ca(n){return n=n[rn]||n[Dn],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function zi(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(B(33))}function ic(n){return n[ea]||null}var Ad=[],$i=-1;function Cr(n){return{current:n}}function Ie(n){0>$i||(n.current=Ad[$i],Ad[$i]=null,$i--)}function _e(n,e){$i++,Ad[$i]=n.current,n.current=e}var Ir={},dt=Cr(Ir),At=Cr(!1),ni=Ir;function us(n,e){var t=n.type.contextTypes;if(!t)return Ir;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function Rt(n){return n=n.childContextTypes,n!=null}function mu(){Ie(At),Ie(dt)}function iy(n,e,t){if(dt.current!==Ir)throw Error(B(168));_e(dt,e),_e(At,t)}function kw(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(B(108,WS(n)||"Unknown",i));return De({},t,r)}function gu(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Ir,ni=dt.current,_e(dt,n),_e(At,At.current),!0}function sy(n,e,t){var r=n.stateNode;if(!r)throw Error(B(169));t?(n=kw(n,e,ni),r.__reactInternalMemoizedMergedChildContext=n,Ie(At),Ie(dt),_e(dt,n)):Ie(At),_e(At,t)}var wn=null,sc=!1,Ch=!1;function Dw(n){wn===null?wn=[n]:wn.push(n)}function cR(n){sc=!0,Dw(n)}function xr(){if(!Ch&&wn!==null){Ch=!0;var n=0,e=pe;try{var t=wn;for(pe=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}wn=null,sc=!1}catch(i){throw wn!==null&&(wn=wn.slice(n+1)),nw(Vf,xr),i}finally{pe=e,Ch=!1}}return null}var qi=[],Ki=0,yu=null,_u=0,Ft=[],jt=0,ri=null,En=1,In="";function zr(n,e){qi[Ki++]=_u,qi[Ki++]=yu,yu=n,_u=e}function bw(n,e,t){Ft[jt++]=En,Ft[jt++]=In,Ft[jt++]=ri,ri=n;var r=En;n=In;var i=32-Qt(r)-1;r&=~(1<<i),t+=1;var s=32-Qt(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,En=1<<32-Qt(e)+i|t<<i|r,In=s+n}else En=1<<s|t<<i|r,In=n}function $f(n){n.return!==null&&(zr(n,1),bw(n,1,0))}function qf(n){for(;n===yu;)yu=qi[--Ki],qi[Ki]=null,_u=qi[--Ki],qi[Ki]=null;for(;n===ri;)ri=Ft[--jt],Ft[jt]=null,In=Ft[--jt],Ft[jt]=null,En=Ft[--jt],Ft[jt]=null}var bt=null,kt=null,Se=!1,Ht=null;function Nw(n,e){var t=Ut(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function oy(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,bt=n,kt=cr(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,bt=n,kt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=ri!==null?{id:En,overflow:In}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Ut(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,bt=n,kt=null,!0):!1;default:return!1}}function Rd(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Pd(n){if(Se){var e=kt;if(e){var t=e;if(!oy(n,e)){if(Rd(n))throw Error(B(418));e=cr(t.nextSibling);var r=bt;e&&oy(n,e)?Nw(r,t):(n.flags=n.flags&-4097|2,Se=!1,bt=n)}}else{if(Rd(n))throw Error(B(418));n.flags=n.flags&-4097|2,Se=!1,bt=n}}}function ay(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;bt=n}function vl(n){if(n!==bt)return!1;if(!Se)return ay(n),Se=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Id(n.type,n.memoizedProps)),e&&(e=kt)){if(Rd(n))throw Vw(),Error(B(418));for(;e;)Nw(n,e),e=cr(e.nextSibling)}if(ay(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(B(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){kt=cr(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}kt=null}}else kt=bt?cr(n.stateNode.nextSibling):null;return!0}function Vw(){for(var n=kt;n;)n=cr(n.nextSibling)}function cs(){kt=bt=null,Se=!1}function Kf(n){Ht===null?Ht=[n]:Ht.push(n)}var hR=Fn.ReactCurrentBatchConfig;function oo(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(B(309));var r=t.stateNode}if(!r)throw Error(B(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(B(284));if(!t._owner)throw Error(B(290,n))}return n}function wl(n,e){throw n=Object.prototype.toString.call(e),Error(B(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function ly(n){var e=n._init;return e(n._payload)}function Ow(n){function e(C,S){if(n){var P=C.deletions;P===null?(C.deletions=[S],C.flags|=16):P.push(S)}}function t(C,S){if(!n)return null;for(;S!==null;)e(C,S),S=S.sibling;return null}function r(C,S){for(C=new Map;S!==null;)S.key!==null?C.set(S.key,S):C.set(S.index,S),S=S.sibling;return C}function i(C,S){return C=pr(C,S),C.index=0,C.sibling=null,C}function s(C,S,P){return C.index=P,n?(P=C.alternate,P!==null?(P=P.index,P<S?(C.flags|=2,S):P):(C.flags|=2,S)):(C.flags|=1048576,S)}function o(C){return n&&C.alternate===null&&(C.flags|=2),C}function a(C,S,P,V){return S===null||S.tag!==6?(S=Oh(P,C.mode,V),S.return=C,S):(S=i(S,P),S.return=C,S)}function u(C,S,P,V){var M=P.type;return M===Fi?d(C,S,P.props.children,V,P.key):S!==null&&(S.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Hn&&ly(M)===S.type)?(V=i(S,P.props),V.ref=oo(C,S,P),V.return=C,V):(V=Gl(P.type,P.key,P.props,null,C.mode,V),V.ref=oo(C,S,P),V.return=C,V)}function c(C,S,P,V){return S===null||S.tag!==4||S.stateNode.containerInfo!==P.containerInfo||S.stateNode.implementation!==P.implementation?(S=Lh(P,C.mode,V),S.return=C,S):(S=i(S,P.children||[]),S.return=C,S)}function d(C,S,P,V,M){return S===null||S.tag!==7?(S=ei(P,C.mode,V,M),S.return=C,S):(S=i(S,P),S.return=C,S)}function p(C,S,P){if(typeof S=="string"&&S!==""||typeof S=="number")return S=Oh(""+S,C.mode,P),S.return=C,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ul:return P=Gl(S.type,S.key,S.props,null,C.mode,P),P.ref=oo(C,null,S),P.return=C,P;case Mi:return S=Lh(S,C.mode,P),S.return=C,S;case Hn:var V=S._init;return p(C,V(S._payload),P)}if(_o(S)||to(S))return S=ei(S,C.mode,P,null),S.return=C,S;wl(C,S)}return null}function m(C,S,P,V){var M=S!==null?S.key:null;if(typeof P=="string"&&P!==""||typeof P=="number")return M!==null?null:a(C,S,""+P,V);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case ul:return P.key===M?u(C,S,P,V):null;case Mi:return P.key===M?c(C,S,P,V):null;case Hn:return M=P._init,m(C,S,M(P._payload),V)}if(_o(P)||to(P))return M!==null?null:d(C,S,P,V,null);wl(C,P)}return null}function E(C,S,P,V,M){if(typeof V=="string"&&V!==""||typeof V=="number")return C=C.get(P)||null,a(S,C,""+V,M);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case ul:return C=C.get(V.key===null?P:V.key)||null,u(S,C,V,M);case Mi:return C=C.get(V.key===null?P:V.key)||null,c(S,C,V,M);case Hn:var k=V._init;return E(C,S,P,k(V._payload),M)}if(_o(V)||to(V))return C=C.get(P)||null,d(S,C,V,M,null);wl(S,V)}return null}function R(C,S,P,V){for(var M=null,k=null,_=S,g=S=0,I=null;_!==null&&g<P.length;g++){_.index>g?(I=_,_=null):I=_.sibling;var T=m(C,_,P[g],V);if(T===null){_===null&&(_=I);break}n&&_&&T.alternate===null&&e(C,_),S=s(T,S,g),k===null?M=T:k.sibling=T,k=T,_=I}if(g===P.length)return t(C,_),Se&&zr(C,g),M;if(_===null){for(;g<P.length;g++)_=p(C,P[g],V),_!==null&&(S=s(_,S,g),k===null?M=_:k.sibling=_,k=_);return Se&&zr(C,g),M}for(_=r(C,_);g<P.length;g++)I=E(_,C,g,P[g],V),I!==null&&(n&&I.alternate!==null&&_.delete(I.key===null?g:I.key),S=s(I,S,g),k===null?M=I:k.sibling=I,k=I);return n&&_.forEach(function(x){return e(C,x)}),Se&&zr(C,g),M}function D(C,S,P,V){var M=to(P);if(typeof M!="function")throw Error(B(150));if(P=M.call(P),P==null)throw Error(B(151));for(var k=M=null,_=S,g=S=0,I=null,T=P.next();_!==null&&!T.done;g++,T=P.next()){_.index>g?(I=_,_=null):I=_.sibling;var x=m(C,_,T.value,V);if(x===null){_===null&&(_=I);break}n&&_&&x.alternate===null&&e(C,_),S=s(x,S,g),k===null?M=x:k.sibling=x,k=x,_=I}if(T.done)return t(C,_),Se&&zr(C,g),M;if(_===null){for(;!T.done;g++,T=P.next())T=p(C,T.value,V),T!==null&&(S=s(T,S,g),k===null?M=T:k.sibling=T,k=T);return Se&&zr(C,g),M}for(_=r(C,_);!T.done;g++,T=P.next())T=E(_,C,g,T.value,V),T!==null&&(n&&T.alternate!==null&&_.delete(T.key===null?g:T.key),S=s(T,S,g),k===null?M=T:k.sibling=T,k=T);return n&&_.forEach(function(A){return e(C,A)}),Se&&zr(C,g),M}function L(C,S,P,V){if(typeof P=="object"&&P!==null&&P.type===Fi&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case ul:e:{for(var M=P.key,k=S;k!==null;){if(k.key===M){if(M=P.type,M===Fi){if(k.tag===7){t(C,k.sibling),S=i(k,P.props.children),S.return=C,C=S;break e}}else if(k.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Hn&&ly(M)===k.type){t(C,k.sibling),S=i(k,P.props),S.ref=oo(C,k,P),S.return=C,C=S;break e}t(C,k);break}else e(C,k);k=k.sibling}P.type===Fi?(S=ei(P.props.children,C.mode,V,P.key),S.return=C,C=S):(V=Gl(P.type,P.key,P.props,null,C.mode,V),V.ref=oo(C,S,P),V.return=C,C=V)}return o(C);case Mi:e:{for(k=P.key;S!==null;){if(S.key===k)if(S.tag===4&&S.stateNode.containerInfo===P.containerInfo&&S.stateNode.implementation===P.implementation){t(C,S.sibling),S=i(S,P.children||[]),S.return=C,C=S;break e}else{t(C,S);break}else e(C,S);S=S.sibling}S=Lh(P,C.mode,V),S.return=C,C=S}return o(C);case Hn:return k=P._init,L(C,S,k(P._payload),V)}if(_o(P))return R(C,S,P,V);if(to(P))return D(C,S,P,V);wl(C,P)}return typeof P=="string"&&P!==""||typeof P=="number"?(P=""+P,S!==null&&S.tag===6?(t(C,S.sibling),S=i(S,P),S.return=C,C=S):(t(C,S),S=Oh(P,C.mode,V),S.return=C,C=S),o(C)):t(C,S)}return L}var hs=Ow(!0),Lw=Ow(!1),vu=Cr(null),wu=null,Gi=null,Gf=null;function Wf(){Gf=Gi=wu=null}function Hf(n){var e=vu.current;Ie(vu),n._currentValue=e}function Cd(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function ns(n,e){wu=n,Gf=Gi=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(It=!0),n.firstContext=null)}function zt(n){var e=n._currentValue;if(Gf!==n)if(n={context:n,memoizedValue:e,next:null},Gi===null){if(wu===null)throw Error(B(308));Gi=n,wu.dependencies={lanes:0,firstContext:n}}else Gi=Gi.next=n;return e}var Jr=null;function Qf(n){Jr===null?Jr=[n]:Jr.push(n)}function Mw(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,Qf(e)):(t.next=i.next,i.next=t),e.interleaved=t,bn(n,r)}function bn(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Qn=!1;function Yf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fw(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Cn(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function hr(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,ue&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,bn(n,t)}return i=r.interleaved,i===null?(e.next=e,Qf(r)):(e.next=i.next,i.next=e),r.interleaved=e,bn(n,t)}function Ul(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Of(n,t)}}function uy(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Eu(n,e,t,r){var i=n.updateQueue;Qn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var u=a,c=u.next;u.next=null,o===null?s=c:o.next=c,o=u;var d=n.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=u))}if(s!==null){var p=i.baseState;o=0,d=c=u=null,a=s;do{var m=a.lane,E=a.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:E,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var R=n,D=a;switch(m=e,E=t,D.tag){case 1:if(R=D.payload,typeof R=="function"){p=R.call(E,p,m);break e}p=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=D.payload,m=typeof R=="function"?R.call(E,p,m):R,m==null)break e;p=De({},p,m);break e;case 2:Qn=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,m=i.effects,m===null?i.effects=[a]:m.push(a))}else E={eventTime:E,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=E,u=p):d=d.next=E,o|=m;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;m=a,a=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(d===null&&(u=p),i.baseState=u,i.firstBaseUpdate=c,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);si|=o,n.lanes=o,n.memoizedState=p}}function cy(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(B(191,i));i.call(r)}}}var xa={},ln=Cr(xa),ta=Cr(xa),na=Cr(xa);function Xr(n){if(n===xa)throw Error(B(174));return n}function Jf(n,e){switch(_e(na,e),_e(ta,n),_e(ln,xa),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ld(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=ld(e,n)}Ie(ln),_e(ln,e)}function ds(){Ie(ln),Ie(ta),Ie(na)}function jw(n){Xr(na.current);var e=Xr(ln.current),t=ld(e,n.type);e!==t&&(_e(ta,n),_e(ln,t))}function Xf(n){ta.current===n&&(Ie(ln),Ie(ta))}var Pe=Cr(0);function Iu(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var xh=[];function Zf(){for(var n=0;n<xh.length;n++)xh[n]._workInProgressVersionPrimary=null;xh.length=0}var Bl=Fn.ReactCurrentDispatcher,kh=Fn.ReactCurrentBatchConfig,ii=0,xe=null,Be=null,We=null,Tu=!1,bo=!1,ra=0,dR=0;function ot(){throw Error(B(321))}function ep(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Zt(n[t],e[t]))return!1;return!0}function tp(n,e,t,r,i,s){if(ii=s,xe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Bl.current=n===null||n.memoizedState===null?gR:yR,n=t(r,i),bo){s=0;do{if(bo=!1,ra=0,25<=s)throw Error(B(301));s+=1,We=Be=null,e.updateQueue=null,Bl.current=_R,n=t(r,i)}while(bo)}if(Bl.current=Su,e=Be!==null&&Be.next!==null,ii=0,We=Be=xe=null,Tu=!1,e)throw Error(B(300));return n}function np(){var n=ra!==0;return ra=0,n}function nn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return We===null?xe.memoizedState=We=n:We=We.next=n,We}function $t(){if(Be===null){var n=xe.alternate;n=n!==null?n.memoizedState:null}else n=Be.next;var e=We===null?xe.memoizedState:We.next;if(e!==null)We=e,Be=n;else{if(n===null)throw Error(B(310));Be=n,n={memoizedState:Be.memoizedState,baseState:Be.baseState,baseQueue:Be.baseQueue,queue:Be.queue,next:null},We===null?xe.memoizedState=We=n:We=We.next=n}return We}function ia(n,e){return typeof e=="function"?e(n):e}function Dh(n){var e=$t(),t=e.queue;if(t===null)throw Error(B(311));t.lastRenderedReducer=n;var r=Be,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,u=null,c=s;do{var d=c.lane;if((ii&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var p={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(a=u=p,o=r):u=u.next=p,xe.lanes|=d,si|=d}c=c.next}while(c!==null&&c!==s);u===null?o=r:u.next=a,Zt(r,e.memoizedState)||(It=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,xe.lanes|=s,si|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function bh(n){var e=$t(),t=e.queue;if(t===null)throw Error(B(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do s=n(s,o.action),o=o.next;while(o!==i);Zt(s,e.memoizedState)||(It=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function Uw(){}function Bw(n,e){var t=xe,r=$t(),i=e(),s=!Zt(r.memoizedState,i);if(s&&(r.memoizedState=i,It=!0),r=r.queue,rp(qw.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||We!==null&&We.memoizedState.tag&1){if(t.flags|=2048,sa(9,$w.bind(null,t,r,i,e),void 0,null),He===null)throw Error(B(349));ii&30||zw(t,e,i)}return i}function zw(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=xe.updateQueue,e===null?(e={lastEffect:null,stores:null},xe.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function $w(n,e,t,r){e.value=t,e.getSnapshot=r,Kw(e)&&Gw(n)}function qw(n,e,t){return t(function(){Kw(e)&&Gw(n)})}function Kw(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Zt(n,t)}catch{return!0}}function Gw(n){var e=bn(n,1);e!==null&&Yt(e,n,1,-1)}function hy(n){var e=nn();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:n},e.queue=n,n=n.dispatch=mR.bind(null,xe,n),[e.memoizedState,n]}function sa(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=xe.updateQueue,e===null?(e={lastEffect:null,stores:null},xe.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function Ww(){return $t().memoizedState}function zl(n,e,t,r){var i=nn();xe.flags|=n,i.memoizedState=sa(1|e,t,void 0,r===void 0?null:r)}function oc(n,e,t,r){var i=$t();r=r===void 0?null:r;var s=void 0;if(Be!==null){var o=Be.memoizedState;if(s=o.destroy,r!==null&&ep(r,o.deps)){i.memoizedState=sa(e,t,s,r);return}}xe.flags|=n,i.memoizedState=sa(1|e,t,s,r)}function dy(n,e){return zl(8390656,8,n,e)}function rp(n,e){return oc(2048,8,n,e)}function Hw(n,e){return oc(4,2,n,e)}function Qw(n,e){return oc(4,4,n,e)}function Yw(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function Jw(n,e,t){return t=t!=null?t.concat([n]):null,oc(4,4,Yw.bind(null,e,n),t)}function ip(){}function Xw(n,e){var t=$t();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&ep(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function Zw(n,e){var t=$t();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&ep(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function eE(n,e,t){return ii&21?(Zt(t,e)||(t=sw(),xe.lanes|=t,si|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,It=!0),n.memoizedState=t)}function fR(n,e){var t=pe;pe=t!==0&&4>t?t:4,n(!0);var r=kh.transition;kh.transition={};try{n(!1),e()}finally{pe=t,kh.transition=r}}function tE(){return $t().memoizedState}function pR(n,e,t){var r=fr(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},nE(n))rE(e,t);else if(t=Mw(n,e,t,r),t!==null){var i=gt();Yt(t,n,r,i),iE(t,e,r)}}function mR(n,e,t){var r=fr(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(nE(n))rE(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(i.hasEagerState=!0,i.eagerState=a,Zt(a,o)){var u=e.interleaved;u===null?(i.next=i,Qf(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}t=Mw(n,e,i,r),t!==null&&(i=gt(),Yt(t,n,r,i),iE(t,e,r))}}function nE(n){var e=n.alternate;return n===xe||e!==null&&e===xe}function rE(n,e){bo=Tu=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function iE(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Of(n,t)}}var Su={readContext:zt,useCallback:ot,useContext:ot,useEffect:ot,useImperativeHandle:ot,useInsertionEffect:ot,useLayoutEffect:ot,useMemo:ot,useReducer:ot,useRef:ot,useState:ot,useDebugValue:ot,useDeferredValue:ot,useTransition:ot,useMutableSource:ot,useSyncExternalStore:ot,useId:ot,unstable_isNewReconciler:!1},gR={readContext:zt,useCallback:function(n,e){return nn().memoizedState=[n,e===void 0?null:e],n},useContext:zt,useEffect:dy,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,zl(4194308,4,Yw.bind(null,e,n),t)},useLayoutEffect:function(n,e){return zl(4194308,4,n,e)},useInsertionEffect:function(n,e){return zl(4,2,n,e)},useMemo:function(n,e){var t=nn();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=nn();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=pR.bind(null,xe,n),[r.memoizedState,n]},useRef:function(n){var e=nn();return n={current:n},e.memoizedState=n},useState:hy,useDebugValue:ip,useDeferredValue:function(n){return nn().memoizedState=n},useTransition:function(){var n=hy(!1),e=n[0];return n=fR.bind(null,n[1]),nn().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=xe,i=nn();if(Se){if(t===void 0)throw Error(B(407));t=t()}else{if(t=e(),He===null)throw Error(B(349));ii&30||zw(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,dy(qw.bind(null,r,s,n),[n]),r.flags|=2048,sa(9,$w.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=nn(),e=He.identifierPrefix;if(Se){var t=In,r=En;t=(r&~(1<<32-Qt(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=ra++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=dR++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},yR={readContext:zt,useCallback:Xw,useContext:zt,useEffect:rp,useImperativeHandle:Jw,useInsertionEffect:Hw,useLayoutEffect:Qw,useMemo:Zw,useReducer:Dh,useRef:Ww,useState:function(){return Dh(ia)},useDebugValue:ip,useDeferredValue:function(n){var e=$t();return eE(e,Be.memoizedState,n)},useTransition:function(){var n=Dh(ia)[0],e=$t().memoizedState;return[n,e]},useMutableSource:Uw,useSyncExternalStore:Bw,useId:tE,unstable_isNewReconciler:!1},_R={readContext:zt,useCallback:Xw,useContext:zt,useEffect:rp,useImperativeHandle:Jw,useInsertionEffect:Hw,useLayoutEffect:Qw,useMemo:Zw,useReducer:bh,useRef:Ww,useState:function(){return bh(ia)},useDebugValue:ip,useDeferredValue:function(n){var e=$t();return Be===null?e.memoizedState=n:eE(e,Be.memoizedState,n)},useTransition:function(){var n=bh(ia)[0],e=$t().memoizedState;return[n,e]},useMutableSource:Uw,useSyncExternalStore:Bw,useId:tE,unstable_isNewReconciler:!1};function Gt(n,e){if(n&&n.defaultProps){e=De({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function xd(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:De({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var ac={isMounted:function(n){return(n=n._reactInternals)?_i(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=gt(),i=fr(n),s=Cn(r,i);s.payload=e,t!=null&&(s.callback=t),e=hr(n,s,i),e!==null&&(Yt(e,n,i,r),Ul(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=gt(),i=fr(n),s=Cn(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=hr(n,s,i),e!==null&&(Yt(e,n,i,r),Ul(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=gt(),r=fr(n),i=Cn(t,r);i.tag=2,e!=null&&(i.callback=e),e=hr(n,i,r),e!==null&&(Yt(e,n,r,t),Ul(e,n,r))}};function fy(n,e,t,r,i,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Jo(t,r)||!Jo(i,s):!0}function sE(n,e,t){var r=!1,i=Ir,s=e.contextType;return typeof s=="object"&&s!==null?s=zt(s):(i=Rt(e)?ni:dt.current,r=e.contextTypes,s=(r=r!=null)?us(n,i):Ir),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ac,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function py(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&ac.enqueueReplaceState(e,e.state,null)}function kd(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},Yf(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=zt(s):(s=Rt(e)?ni:dt.current,i.context=us(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(xd(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&ac.enqueueReplaceState(i,i.state,null),Eu(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function fs(n,e){try{var t="",r=e;do t+=GS(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function Nh(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Dd(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var vR=typeof WeakMap=="function"?WeakMap:Map;function oE(n,e,t){t=Cn(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Ru||(Ru=!0,Bd=r),Dd(n,e)},t}function aE(n,e,t){t=Cn(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){Dd(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){Dd(n,e),typeof r!="function"&&(dr===null?dr=new Set([this]):dr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function my(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new vR;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=NR.bind(null,n,e,t),e.then(n,n))}function gy(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function yy(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Cn(-1,1),e.tag=2,hr(t,e,1))),t.lanes|=1),n)}var wR=Fn.ReactCurrentOwner,It=!1;function mt(n,e,t,r){e.child=n===null?Lw(e,null,t,r):hs(e,n.child,t,r)}function _y(n,e,t,r,i){t=t.render;var s=e.ref;return ns(e,i),r=tp(n,e,t,r,s,i),t=np(),n!==null&&!It?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Nn(n,e,i)):(Se&&t&&$f(e),e.flags|=1,mt(n,e,r,i),e.child)}function vy(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!dp(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,lE(n,e,s,r,i)):(n=Gl(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:Jo,t(o,r)&&n.ref===e.ref)return Nn(n,e,i)}return e.flags|=1,n=pr(s,r),n.ref=e.ref,n.return=e,e.child=n}function lE(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(Jo(s,r)&&n.ref===e.ref)if(It=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(It=!0);else return e.lanes=n.lanes,Nn(n,e,i)}return bd(n,e,t,r,i)}function uE(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_e(Hi,xt),xt|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,_e(Hi,xt),xt|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,_e(Hi,xt),xt|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,_e(Hi,xt),xt|=r;return mt(n,e,i,t),e.child}function cE(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function bd(n,e,t,r,i){var s=Rt(t)?ni:dt.current;return s=us(e,s),ns(e,i),t=tp(n,e,t,r,s,i),r=np(),n!==null&&!It?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Nn(n,e,i)):(Se&&r&&$f(e),e.flags|=1,mt(n,e,t,i),e.child)}function wy(n,e,t,r,i){if(Rt(t)){var s=!0;gu(e)}else s=!1;if(ns(e,i),e.stateNode===null)$l(n,e),sE(e,t,r),kd(e,t,r,i),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var u=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=zt(c):(c=Rt(t)?ni:dt.current,c=us(e,c));var d=t.getDerivedStateFromProps,p=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||u!==c)&&py(e,o,r,c),Qn=!1;var m=e.memoizedState;o.state=m,Eu(e,r,o,i),u=e.memoizedState,a!==r||m!==u||At.current||Qn?(typeof d=="function"&&(xd(e,t,d,r),u=e.memoizedState),(a=Qn||fy(e,t,a,r,m,u,c))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Fw(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:Gt(e.type,a),o.props=c,p=e.pendingProps,m=o.context,u=t.contextType,typeof u=="object"&&u!==null?u=zt(u):(u=Rt(t)?ni:dt.current,u=us(e,u));var E=t.getDerivedStateFromProps;(d=typeof E=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||m!==u)&&py(e,o,r,u),Qn=!1,m=e.memoizedState,o.state=m,Eu(e,r,o,i);var R=e.memoizedState;a!==p||m!==R||At.current||Qn?(typeof E=="function"&&(xd(e,t,E,r),R=e.memoizedState),(c=Qn||fy(e,t,c,r,m,R,u)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=u,r=c):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),r=!1)}return Nd(n,e,t,r,s,i)}function Nd(n,e,t,r,i,s){cE(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&sy(e,t,!1),Nn(n,e,s);r=e.stateNode,wR.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=hs(e,n.child,null,s),e.child=hs(e,null,a,s)):mt(n,e,a,s),e.memoizedState=r.state,i&&sy(e,t,!0),e.child}function hE(n){var e=n.stateNode;e.pendingContext?iy(n,e.pendingContext,e.pendingContext!==e.context):e.context&&iy(n,e.context,!1),Jf(n,e.containerInfo)}function Ey(n,e,t,r,i){return cs(),Kf(i),e.flags|=256,mt(n,e,t,r),e.child}var Vd={dehydrated:null,treeContext:null,retryLane:0};function Od(n){return{baseLanes:n,cachePool:null,transitions:null}}function dE(n,e,t){var r=e.pendingProps,i=Pe.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),_e(Pe,i&1),n===null)return Pd(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=cc(o,r,0,null),n=ei(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=Od(t),e.memoizedState=Vd,n):sp(e,o));if(i=n.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return ER(n,e,o,r,a,i,t);if(s){s=r.fallback,o=e.mode,i=n.child,a=i.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=pr(i,u),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=pr(a,s):(s=ei(s,o,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=n.child.memoizedState,o=o===null?Od(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=Vd,r}return s=n.child,n=s.sibling,r=pr(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function sp(n,e){return e=cc({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function El(n,e,t,r){return r!==null&&Kf(r),hs(e,n.child,null,t),n=sp(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function ER(n,e,t,r,i,s,o){if(t)return e.flags&256?(e.flags&=-257,r=Nh(Error(B(422))),El(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=cc({mode:"visible",children:r.children},i,0,null),s=ei(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&hs(e,n.child,null,o),e.child.memoizedState=Od(o),e.memoizedState=Vd,s);if(!(e.mode&1))return El(n,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(B(419)),r=Nh(s,r,void 0),El(n,e,o,r)}if(a=(o&n.childLanes)!==0,It||a){if(r=He,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,bn(n,i),Yt(r,n,i,-1))}return hp(),r=Nh(Error(B(421))),El(n,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=VR.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,kt=cr(i.nextSibling),bt=e,Se=!0,Ht=null,n!==null&&(Ft[jt++]=En,Ft[jt++]=In,Ft[jt++]=ri,En=n.id,In=n.overflow,ri=e),e=sp(e,r.children),e.flags|=4096,e)}function Iy(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),Cd(n.return,e,t)}function Vh(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function fE(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(mt(n,e,r.children,t),r=Pe.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Iy(n,t,e);else if(n.tag===19)Iy(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(_e(Pe,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Iu(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),Vh(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Iu(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}Vh(e,!0,t,null,s);break;case"together":Vh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $l(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Nn(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),si|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(B(153));if(e.child!==null){for(n=e.child,t=pr(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=pr(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function IR(n,e,t){switch(e.tag){case 3:hE(e),cs();break;case 5:jw(e);break;case 1:Rt(e.type)&&gu(e);break;case 4:Jf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;_e(vu,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(_e(Pe,Pe.current&1),e.flags|=128,null):t&e.child.childLanes?dE(n,e,t):(_e(Pe,Pe.current&1),n=Nn(n,e,t),n!==null?n.sibling:null);_e(Pe,Pe.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return fE(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),_e(Pe,Pe.current),r)break;return null;case 22:case 23:return e.lanes=0,uE(n,e,t)}return Nn(n,e,t)}var pE,Ld,mE,gE;pE=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Ld=function(){};mE=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Xr(ln.current);var s=null;switch(t){case"input":i=id(n,i),r=id(n,r),s=[];break;case"select":i=De({},i,{value:void 0}),r=De({},r,{value:void 0}),s=[];break;case"textarea":i=ad(n,i),r=ad(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=pu)}ud(t,r);var o;t=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(qo.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var u=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&u!==a&&(u!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in u)u.hasOwnProperty(o)&&a[o]!==u[o]&&(t||(t={}),t[o]=u[o])}else t||(s||(s=[]),s.push(c,t)),t=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(s=s||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(qo.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&Ee("scroll",n),s||a===u||(s=[])):(s=s||[]).push(c,u))}t&&(s=s||[]).push("style",t);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};gE=function(n,e,t,r){t!==r&&(e.flags|=4)};function ao(n,e){if(!Se)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function at(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function TR(n,e,t){var r=e.pendingProps;switch(qf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return at(e),null;case 1:return Rt(e.type)&&mu(),at(e),null;case 3:return r=e.stateNode,ds(),Ie(At),Ie(dt),Zf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(vl(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ht!==null&&(qd(Ht),Ht=null))),Ld(n,e),at(e),null;case 5:Xf(e);var i=Xr(na.current);if(t=e.type,n!==null&&e.stateNode!=null)mE(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(B(166));return at(e),null}if(n=Xr(ln.current),vl(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[rn]=e,r[ea]=s,n=(e.mode&1)!==0,t){case"dialog":Ee("cancel",r),Ee("close",r);break;case"iframe":case"object":case"embed":Ee("load",r);break;case"video":case"audio":for(i=0;i<wo.length;i++)Ee(wo[i],r);break;case"source":Ee("error",r);break;case"img":case"image":case"link":Ee("error",r),Ee("load",r);break;case"details":Ee("toggle",r);break;case"input":Dg(r,s),Ee("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ee("invalid",r);break;case"textarea":Ng(r,s),Ee("invalid",r)}ud(t,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&_l(r.textContent,a,n),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&_l(r.textContent,a,n),i=["children",""+a]):qo.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ee("scroll",r)}switch(t){case"input":cl(r),bg(r,s,!0);break;case"textarea":cl(r),Vg(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=pu)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=qv(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[rn]=e,n[ea]=r,pE(n,e,!1,!1),e.stateNode=n;e:{switch(o=cd(t,r),t){case"dialog":Ee("cancel",n),Ee("close",n),i=r;break;case"iframe":case"object":case"embed":Ee("load",n),i=r;break;case"video":case"audio":for(i=0;i<wo.length;i++)Ee(wo[i],n);i=r;break;case"source":Ee("error",n),i=r;break;case"img":case"image":case"link":Ee("error",n),Ee("load",n),i=r;break;case"details":Ee("toggle",n),i=r;break;case"input":Dg(n,r),i=id(n,r),Ee("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=De({},r,{value:void 0}),Ee("invalid",n);break;case"textarea":Ng(n,r),i=ad(n,r),Ee("invalid",n);break;default:i=r}ud(t,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var u=a[s];s==="style"?Wv(n,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Kv(n,u)):s==="children"?typeof u=="string"?(t!=="textarea"||u!=="")&&Ko(n,u):typeof u=="number"&&Ko(n,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(qo.hasOwnProperty(s)?u!=null&&s==="onScroll"&&Ee("scroll",n):u!=null&&xf(n,s,u,o))}switch(t){case"input":cl(n),bg(n,r,!1);break;case"textarea":cl(n),Vg(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Er(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?Xi(n,!!r.multiple,s,!1):r.defaultValue!=null&&Xi(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=pu)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return at(e),null;case 6:if(n&&e.stateNode!=null)gE(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(B(166));if(t=Xr(na.current),Xr(ln.current),vl(e)){if(r=e.stateNode,t=e.memoizedProps,r[rn]=e,(s=r.nodeValue!==t)&&(n=bt,n!==null))switch(n.tag){case 3:_l(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&_l(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[rn]=e,e.stateNode=r}return at(e),null;case 13:if(Ie(Pe),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Se&&kt!==null&&e.mode&1&&!(e.flags&128))Vw(),cs(),e.flags|=98560,s=!1;else if(s=vl(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(B(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(B(317));s[rn]=e}else cs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;at(e),s=!1}else Ht!==null&&(qd(Ht),Ht=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Pe.current&1?$e===0&&($e=3):hp())),e.updateQueue!==null&&(e.flags|=4),at(e),null);case 4:return ds(),Ld(n,e),n===null&&Xo(e.stateNode.containerInfo),at(e),null;case 10:return Hf(e.type._context),at(e),null;case 17:return Rt(e.type)&&mu(),at(e),null;case 19:if(Ie(Pe),s=e.memoizedState,s===null)return at(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)ao(s,!1);else{if($e!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Iu(n),o!==null){for(e.flags|=128,ao(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return _e(Pe,Pe.current&1|2),e.child}n=n.sibling}s.tail!==null&&Oe()>ps&&(e.flags|=128,r=!0,ao(s,!1),e.lanes=4194304)}else{if(!r)if(n=Iu(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),ao(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Se)return at(e),null}else 2*Oe()-s.renderingStartTime>ps&&t!==1073741824&&(e.flags|=128,r=!0,ao(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Oe(),e.sibling=null,t=Pe.current,_e(Pe,r?t&1|2:t&1),e):(at(e),null);case 22:case 23:return cp(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?xt&1073741824&&(at(e),e.subtreeFlags&6&&(e.flags|=8192)):at(e),null;case 24:return null;case 25:return null}throw Error(B(156,e.tag))}function SR(n,e){switch(qf(e),e.tag){case 1:return Rt(e.type)&&mu(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return ds(),Ie(At),Ie(dt),Zf(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Xf(e),null;case 13:if(Ie(Pe),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(B(340));cs()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Ie(Pe),null;case 4:return ds(),null;case 10:return Hf(e.type._context),null;case 22:case 23:return cp(),null;case 24:return null;default:return null}}var Il=!1,ct=!1,AR=typeof WeakSet=="function"?WeakSet:Set,G=null;function Wi(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Ne(n,e,r)}else t.current=null}function Md(n,e,t){try{t()}catch(r){Ne(n,e,r)}}var Ty=!1;function RR(n,e){if(wd=hu,n=Ew(),zf(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,u=-1,c=0,d=0,p=n,m=null;t:for(;;){for(var E;p!==t||i!==0&&p.nodeType!==3||(a=o+i),p!==s||r!==0&&p.nodeType!==3||(u=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(E=p.firstChild)!==null;)m=p,p=E;for(;;){if(p===n)break t;if(m===t&&++c===i&&(a=o),m===s&&++d===r&&(u=o),(E=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=E}t=a===-1||u===-1?null:{start:a,end:u}}else t=null}t=t||{start:0,end:0}}else t=null;for(Ed={focusedElem:n,selectionRange:t},hu=!1,G=e;G!==null;)if(e=G,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,G=n;else for(;G!==null;){e=G;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var D=R.memoizedProps,L=R.memoizedState,C=e.stateNode,S=C.getSnapshotBeforeUpdate(e.elementType===e.type?D:Gt(e.type,D),L);C.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var P=e.stateNode.containerInfo;P.nodeType===1?P.textContent="":P.nodeType===9&&P.documentElement&&P.removeChild(P.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(B(163))}}catch(V){Ne(e,e.return,V)}if(n=e.sibling,n!==null){n.return=e.return,G=n;break}G=e.return}return R=Ty,Ty=!1,R}function No(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&Md(e,t,s)}i=i.next}while(i!==r)}}function lc(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Fd(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function yE(n){var e=n.alternate;e!==null&&(n.alternate=null,yE(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[rn],delete e[ea],delete e[Sd],delete e[lR],delete e[uR])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function _E(n){return n.tag===5||n.tag===3||n.tag===4}function Sy(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||_E(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function jd(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=pu));else if(r!==4&&(n=n.child,n!==null))for(jd(n,e,t),n=n.sibling;n!==null;)jd(n,e,t),n=n.sibling}function Ud(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(Ud(n,e,t),n=n.sibling;n!==null;)Ud(n,e,t),n=n.sibling}var Je=null,Wt=!1;function qn(n,e,t){for(t=t.child;t!==null;)vE(n,e,t),t=t.sibling}function vE(n,e,t){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(ec,t)}catch{}switch(t.tag){case 5:ct||Wi(t,e);case 6:var r=Je,i=Wt;Je=null,qn(n,e,t),Je=r,Wt=i,Je!==null&&(Wt?(n=Je,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Je.removeChild(t.stateNode));break;case 18:Je!==null&&(Wt?(n=Je,t=t.stateNode,n.nodeType===8?Ph(n.parentNode,t):n.nodeType===1&&Ph(n,t),Qo(n)):Ph(Je,t.stateNode));break;case 4:r=Je,i=Wt,Je=t.stateNode.containerInfo,Wt=!0,qn(n,e,t),Je=r,Wt=i;break;case 0:case 11:case 14:case 15:if(!ct&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Md(t,e,o),i=i.next}while(i!==r)}qn(n,e,t);break;case 1:if(!ct&&(Wi(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){Ne(t,e,a)}qn(n,e,t);break;case 21:qn(n,e,t);break;case 22:t.mode&1?(ct=(r=ct)||t.memoizedState!==null,qn(n,e,t),ct=r):qn(n,e,t);break;default:qn(n,e,t)}}function Ay(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new AR),e.forEach(function(r){var i=OR.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function Kt(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Je=a.stateNode,Wt=!1;break e;case 3:Je=a.stateNode.containerInfo,Wt=!0;break e;case 4:Je=a.stateNode.containerInfo,Wt=!0;break e}a=a.return}if(Je===null)throw Error(B(160));vE(s,o,i),Je=null,Wt=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(c){Ne(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)wE(e,n),e=e.sibling}function wE(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Kt(e,n),tn(n),r&4){try{No(3,n,n.return),lc(3,n)}catch(D){Ne(n,n.return,D)}try{No(5,n,n.return)}catch(D){Ne(n,n.return,D)}}break;case 1:Kt(e,n),tn(n),r&512&&t!==null&&Wi(t,t.return);break;case 5:if(Kt(e,n),tn(n),r&512&&t!==null&&Wi(t,t.return),n.flags&32){var i=n.stateNode;try{Ko(i,"")}catch(D){Ne(n,n.return,D)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,u=n.updateQueue;if(n.updateQueue=null,u!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&zv(i,s),cd(a,o);var c=cd(a,s);for(o=0;o<u.length;o+=2){var d=u[o],p=u[o+1];d==="style"?Wv(i,p):d==="dangerouslySetInnerHTML"?Kv(i,p):d==="children"?Ko(i,p):xf(i,d,p,c)}switch(a){case"input":sd(i,s);break;case"textarea":$v(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var E=s.value;E!=null?Xi(i,!!s.multiple,E,!1):m!==!!s.multiple&&(s.defaultValue!=null?Xi(i,!!s.multiple,s.defaultValue,!0):Xi(i,!!s.multiple,s.multiple?[]:"",!1))}i[ea]=s}catch(D){Ne(n,n.return,D)}}break;case 6:if(Kt(e,n),tn(n),r&4){if(n.stateNode===null)throw Error(B(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(D){Ne(n,n.return,D)}}break;case 3:if(Kt(e,n),tn(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Qo(e.containerInfo)}catch(D){Ne(n,n.return,D)}break;case 4:Kt(e,n),tn(n);break;case 13:Kt(e,n),tn(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(lp=Oe())),r&4&&Ay(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(ct=(c=ct)||d,Kt(e,n),ct=c):Kt(e,n),tn(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!d&&n.mode&1)for(G=n,d=n.child;d!==null;){for(p=G=d;G!==null;){switch(m=G,E=m.child,m.tag){case 0:case 11:case 14:case 15:No(4,m,m.return);break;case 1:Wi(m,m.return);var R=m.stateNode;if(typeof R.componentWillUnmount=="function"){r=m,t=m.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(D){Ne(r,t,D)}}break;case 5:Wi(m,m.return);break;case 22:if(m.memoizedState!==null){Py(p);continue}}E!==null?(E.return=m,G=E):Py(p)}d=d.sibling}e:for(d=null,p=n;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=p.stateNode,u=p.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=Gv("display",o))}catch(D){Ne(n,n.return,D)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=c?"":p.memoizedProps}catch(D){Ne(n,n.return,D)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===n)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===n)break e;for(;p.sibling===null;){if(p.return===null||p.return===n)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Kt(e,n),tn(n),r&4&&Ay(n);break;case 21:break;default:Kt(e,n),tn(n)}}function tn(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(_E(t)){var r=t;break e}t=t.return}throw Error(B(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ko(i,""),r.flags&=-33);var s=Sy(n);Ud(n,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Sy(n);jd(n,a,o);break;default:throw Error(B(161))}}catch(u){Ne(n,n.return,u)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function PR(n,e,t){G=n,EE(n)}function EE(n,e,t){for(var r=(n.mode&1)!==0;G!==null;){var i=G,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Il;if(!o){var a=i.alternate,u=a!==null&&a.memoizedState!==null||ct;a=Il;var c=ct;if(Il=o,(ct=u)&&!c)for(G=i;G!==null;)o=G,u=o.child,o.tag===22&&o.memoizedState!==null?Cy(i):u!==null?(u.return=o,G=u):Cy(i);for(;s!==null;)G=s,EE(s),s=s.sibling;G=i,Il=a,ct=c}Ry(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,G=s):Ry(n)}}function Ry(n){for(;G!==null;){var e=G;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ct||lc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ct)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Gt(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&cy(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}cy(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&t.focus();break;case"img":u.src&&(t.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&Qo(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(B(163))}ct||e.flags&512&&Fd(e)}catch(m){Ne(e,e.return,m)}}if(e===n){G=null;break}if(t=e.sibling,t!==null){t.return=e.return,G=t;break}G=e.return}}function Py(n){for(;G!==null;){var e=G;if(e===n){G=null;break}var t=e.sibling;if(t!==null){t.return=e.return,G=t;break}G=e.return}}function Cy(n){for(;G!==null;){var e=G;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{lc(4,e)}catch(u){Ne(e,t,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){Ne(e,i,u)}}var s=e.return;try{Fd(e)}catch(u){Ne(e,s,u)}break;case 5:var o=e.return;try{Fd(e)}catch(u){Ne(e,o,u)}}}catch(u){Ne(e,e.return,u)}if(e===n){G=null;break}var a=e.sibling;if(a!==null){a.return=e.return,G=a;break}G=e.return}}var CR=Math.ceil,Au=Fn.ReactCurrentDispatcher,op=Fn.ReactCurrentOwner,Bt=Fn.ReactCurrentBatchConfig,ue=0,He=null,je=null,et=0,xt=0,Hi=Cr(0),$e=0,oa=null,si=0,uc=0,ap=0,Vo=null,Et=null,lp=0,ps=1/0,vn=null,Ru=!1,Bd=null,dr=null,Tl=!1,ir=null,Pu=0,Oo=0,zd=null,ql=-1,Kl=0;function gt(){return ue&6?Oe():ql!==-1?ql:ql=Oe()}function fr(n){return n.mode&1?ue&2&&et!==0?et&-et:hR.transition!==null?(Kl===0&&(Kl=sw()),Kl):(n=pe,n!==0||(n=window.event,n=n===void 0?16:dw(n.type)),n):1}function Yt(n,e,t,r){if(50<Oo)throw Oo=0,zd=null,Error(B(185));Ra(n,t,r),(!(ue&2)||n!==He)&&(n===He&&(!(ue&2)&&(uc|=t),$e===4&&Jn(n,et)),Pt(n,r),t===1&&ue===0&&!(e.mode&1)&&(ps=Oe()+500,sc&&xr()))}function Pt(n,e){var t=n.callbackNode;hA(n,e);var r=cu(n,n===He?et:0);if(r===0)t!==null&&Mg(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&Mg(t),e===1)n.tag===0?cR(xy.bind(null,n)):Dw(xy.bind(null,n)),oR(function(){!(ue&6)&&xr()}),t=null;else{switch(ow(r)){case 1:t=Vf;break;case 4:t=rw;break;case 16:t=uu;break;case 536870912:t=iw;break;default:t=uu}t=xE(t,IE.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function IE(n,e){if(ql=-1,Kl=0,ue&6)throw Error(B(327));var t=n.callbackNode;if(rs()&&n.callbackNode!==t)return null;var r=cu(n,n===He?et:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Cu(n,r);else{e=r;var i=ue;ue|=2;var s=SE();(He!==n||et!==e)&&(vn=null,ps=Oe()+500,Zr(n,e));do try{DR();break}catch(a){TE(n,a)}while(!0);Wf(),Au.current=s,ue=i,je!==null?e=0:(He=null,et=0,e=$e)}if(e!==0){if(e===2&&(i=md(n),i!==0&&(r=i,e=$d(n,i))),e===1)throw t=oa,Zr(n,0),Jn(n,r),Pt(n,Oe()),t;if(e===6)Jn(n,r);else{if(i=n.current.alternate,!(r&30)&&!xR(i)&&(e=Cu(n,r),e===2&&(s=md(n),s!==0&&(r=s,e=$d(n,s))),e===1))throw t=oa,Zr(n,0),Jn(n,r),Pt(n,Oe()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(B(345));case 2:$r(n,Et,vn);break;case 3:if(Jn(n,r),(r&130023424)===r&&(e=lp+500-Oe(),10<e)){if(cu(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){gt(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=Td($r.bind(null,n,Et,vn),e);break}$r(n,Et,vn);break;case 4:if(Jn(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var o=31-Qt(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Oe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*CR(r/1960))-r,10<r){n.timeoutHandle=Td($r.bind(null,n,Et,vn),r);break}$r(n,Et,vn);break;case 5:$r(n,Et,vn);break;default:throw Error(B(329))}}}return Pt(n,Oe()),n.callbackNode===t?IE.bind(null,n):null}function $d(n,e){var t=Vo;return n.current.memoizedState.isDehydrated&&(Zr(n,e).flags|=256),n=Cu(n,e),n!==2&&(e=Et,Et=t,e!==null&&qd(e)),n}function qd(n){Et===null?Et=n:Et.push.apply(Et,n)}function xR(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!Zt(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Jn(n,e){for(e&=~ap,e&=~uc,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Qt(e),r=1<<t;n[t]=-1,e&=~r}}function xy(n){if(ue&6)throw Error(B(327));rs();var e=cu(n,0);if(!(e&1))return Pt(n,Oe()),null;var t=Cu(n,e);if(n.tag!==0&&t===2){var r=md(n);r!==0&&(e=r,t=$d(n,r))}if(t===1)throw t=oa,Zr(n,0),Jn(n,e),Pt(n,Oe()),t;if(t===6)throw Error(B(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,$r(n,Et,vn),Pt(n,Oe()),null}function up(n,e){var t=ue;ue|=1;try{return n(e)}finally{ue=t,ue===0&&(ps=Oe()+500,sc&&xr())}}function oi(n){ir!==null&&ir.tag===0&&!(ue&6)&&rs();var e=ue;ue|=1;var t=Bt.transition,r=pe;try{if(Bt.transition=null,pe=1,n)return n()}finally{pe=r,Bt.transition=t,ue=e,!(ue&6)&&xr()}}function cp(){xt=Hi.current,Ie(Hi)}function Zr(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,sR(t)),je!==null)for(t=je.return;t!==null;){var r=t;switch(qf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&mu();break;case 3:ds(),Ie(At),Ie(dt),Zf();break;case 5:Xf(r);break;case 4:ds();break;case 13:Ie(Pe);break;case 19:Ie(Pe);break;case 10:Hf(r.type._context);break;case 22:case 23:cp()}t=t.return}if(He=n,je=n=pr(n.current,null),et=xt=e,$e=0,oa=null,ap=uc=si=0,Et=Vo=null,Jr!==null){for(e=0;e<Jr.length;e++)if(t=Jr[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}t.pending=r}Jr=null}return n}function TE(n,e){do{var t=je;try{if(Wf(),Bl.current=Su,Tu){for(var r=xe.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Tu=!1}if(ii=0,We=Be=xe=null,bo=!1,ra=0,op.current=null,t===null||t.return===null){$e=1,oa=e,je=null;break}e:{var s=n,o=t.return,a=t,u=e;if(e=et,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=a,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var E=gy(o);if(E!==null){E.flags&=-257,yy(E,o,a,s,e),E.mode&1&&my(s,c,e),e=E,u=c;var R=e.updateQueue;if(R===null){var D=new Set;D.add(u),e.updateQueue=D}else R.add(u);break e}else{if(!(e&1)){my(s,c,e),hp();break e}u=Error(B(426))}}else if(Se&&a.mode&1){var L=gy(o);if(L!==null){!(L.flags&65536)&&(L.flags|=256),yy(L,o,a,s,e),Kf(fs(u,a));break e}}s=u=fs(u,a),$e!==4&&($e=2),Vo===null?Vo=[s]:Vo.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var C=oE(s,u,e);uy(s,C);break e;case 1:a=u;var S=s.type,P=s.stateNode;if(!(s.flags&128)&&(typeof S.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(dr===null||!dr.has(P)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=aE(s,a,e);uy(s,V);break e}}s=s.return}while(s!==null)}RE(t)}catch(M){e=M,je===t&&t!==null&&(je=t=t.return);continue}break}while(!0)}function SE(){var n=Au.current;return Au.current=Su,n===null?Su:n}function hp(){($e===0||$e===3||$e===2)&&($e=4),He===null||!(si&268435455)&&!(uc&268435455)||Jn(He,et)}function Cu(n,e){var t=ue;ue|=2;var r=SE();(He!==n||et!==e)&&(vn=null,Zr(n,e));do try{kR();break}catch(i){TE(n,i)}while(!0);if(Wf(),ue=t,Au.current=r,je!==null)throw Error(B(261));return He=null,et=0,$e}function kR(){for(;je!==null;)AE(je)}function DR(){for(;je!==null&&!nA();)AE(je)}function AE(n){var e=CE(n.alternate,n,xt);n.memoizedProps=n.pendingProps,e===null?RE(n):je=e,op.current=null}function RE(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=SR(t,e),t!==null){t.flags&=32767,je=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{$e=6,je=null;return}}else if(t=TR(t,e,xt),t!==null){je=t;return}if(e=e.sibling,e!==null){je=e;return}je=e=n}while(e!==null);$e===0&&($e=5)}function $r(n,e,t){var r=pe,i=Bt.transition;try{Bt.transition=null,pe=1,bR(n,e,t,r)}finally{Bt.transition=i,pe=r}return null}function bR(n,e,t,r){do rs();while(ir!==null);if(ue&6)throw Error(B(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(B(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(dA(n,s),n===He&&(je=He=null,et=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Tl||(Tl=!0,xE(uu,function(){return rs(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=Bt.transition,Bt.transition=null;var o=pe;pe=1;var a=ue;ue|=4,op.current=null,RR(n,t),wE(t,n),XA(Ed),hu=!!wd,Ed=wd=null,n.current=t,PR(t),rA(),ue=a,pe=o,Bt.transition=s}else n.current=t;if(Tl&&(Tl=!1,ir=n,Pu=i),s=n.pendingLanes,s===0&&(dr=null),oA(t.stateNode),Pt(n,Oe()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ru)throw Ru=!1,n=Bd,Bd=null,n;return Pu&1&&n.tag!==0&&rs(),s=n.pendingLanes,s&1?n===zd?Oo++:(Oo=0,zd=n):Oo=0,xr(),null}function rs(){if(ir!==null){var n=ow(Pu),e=Bt.transition,t=pe;try{if(Bt.transition=null,pe=16>n?16:n,ir===null)var r=!1;else{if(n=ir,ir=null,Pu=0,ue&6)throw Error(B(331));var i=ue;for(ue|=4,G=n.current;G!==null;){var s=G,o=s.child;if(G.flags&16){var a=s.deletions;if(a!==null){for(var u=0;u<a.length;u++){var c=a[u];for(G=c;G!==null;){var d=G;switch(d.tag){case 0:case 11:case 15:No(8,d,s)}var p=d.child;if(p!==null)p.return=d,G=p;else for(;G!==null;){d=G;var m=d.sibling,E=d.return;if(yE(d),d===c){G=null;break}if(m!==null){m.return=E,G=m;break}G=E}}}var R=s.alternate;if(R!==null){var D=R.child;if(D!==null){R.child=null;do{var L=D.sibling;D.sibling=null,D=L}while(D!==null)}}G=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,G=o;else e:for(;G!==null;){if(s=G,s.flags&2048)switch(s.tag){case 0:case 11:case 15:No(9,s,s.return)}var C=s.sibling;if(C!==null){C.return=s.return,G=C;break e}G=s.return}}var S=n.current;for(G=S;G!==null;){o=G;var P=o.child;if(o.subtreeFlags&2064&&P!==null)P.return=o,G=P;else e:for(o=S;G!==null;){if(a=G,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:lc(9,a)}}catch(M){Ne(a,a.return,M)}if(a===o){G=null;break e}var V=a.sibling;if(V!==null){V.return=a.return,G=V;break e}G=a.return}}if(ue=i,xr(),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(ec,n)}catch{}r=!0}return r}finally{pe=t,Bt.transition=e}}return!1}function ky(n,e,t){e=fs(t,e),e=oE(n,e,1),n=hr(n,e,1),e=gt(),n!==null&&(Ra(n,1,e),Pt(n,e))}function Ne(n,e,t){if(n.tag===3)ky(n,n,t);else for(;e!==null;){if(e.tag===3){ky(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(dr===null||!dr.has(r))){n=fs(t,n),n=aE(e,n,1),e=hr(e,n,1),n=gt(),e!==null&&(Ra(e,1,n),Pt(e,n));break}}e=e.return}}function NR(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=gt(),n.pingedLanes|=n.suspendedLanes&t,He===n&&(et&t)===t&&($e===4||$e===3&&(et&130023424)===et&&500>Oe()-lp?Zr(n,0):ap|=t),Pt(n,e)}function PE(n,e){e===0&&(n.mode&1?(e=fl,fl<<=1,!(fl&130023424)&&(fl=4194304)):e=1);var t=gt();n=bn(n,e),n!==null&&(Ra(n,e,t),Pt(n,t))}function VR(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),PE(n,t)}function OR(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(B(314))}r!==null&&r.delete(e),PE(n,t)}var CE;CE=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||At.current)It=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return It=!1,IR(n,e,t);It=!!(n.flags&131072)}else It=!1,Se&&e.flags&1048576&&bw(e,_u,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;$l(n,e),n=e.pendingProps;var i=us(e,dt.current);ns(e,t),i=tp(null,e,r,n,i,t);var s=np();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Rt(r)?(s=!0,gu(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Yf(e),i.updater=ac,e.stateNode=i,i._reactInternals=e,kd(e,r,n,t),e=Nd(null,e,r,!0,s,t)):(e.tag=0,Se&&s&&$f(e),mt(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch($l(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=MR(r),n=Gt(r,n),i){case 0:e=bd(null,e,r,n,t);break e;case 1:e=wy(null,e,r,n,t);break e;case 11:e=_y(null,e,r,n,t);break e;case 14:e=vy(null,e,r,Gt(r.type,n),t);break e}throw Error(B(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Gt(r,i),bd(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Gt(r,i),wy(n,e,r,i,t);case 3:e:{if(hE(e),n===null)throw Error(B(387));r=e.pendingProps,s=e.memoizedState,i=s.element,Fw(n,e),Eu(e,r,null,t);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=fs(Error(B(423)),e),e=Ey(n,e,r,t,i);break e}else if(r!==i){i=fs(Error(B(424)),e),e=Ey(n,e,r,t,i);break e}else for(kt=cr(e.stateNode.containerInfo.firstChild),bt=e,Se=!0,Ht=null,t=Lw(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(cs(),r===i){e=Nn(n,e,t);break e}mt(n,e,r,t)}e=e.child}return e;case 5:return jw(e),n===null&&Pd(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,o=i.children,Id(r,i)?o=null:s!==null&&Id(r,s)&&(e.flags|=32),cE(n,e),mt(n,e,o,t),e.child;case 6:return n===null&&Pd(e),null;case 13:return dE(n,e,t);case 4:return Jf(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=hs(e,null,r,t):mt(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Gt(r,i),_y(n,e,r,i,t);case 7:return mt(n,e,e.pendingProps,t),e.child;case 8:return mt(n,e,e.pendingProps.children,t),e.child;case 12:return mt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,_e(vu,r._currentValue),r._currentValue=o,s!==null)if(Zt(s.value,o)){if(s.children===i.children&&!At.current){e=Nn(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=Cn(-1,t&-t),u.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}s.lanes|=t,u=s.alternate,u!==null&&(u.lanes|=t),Cd(s.return,t,e),a.lanes|=t;break}u=u.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(B(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),Cd(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}mt(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ns(e,t),i=zt(i),r=r(i),e.flags|=1,mt(n,e,r,t),e.child;case 14:return r=e.type,i=Gt(r,e.pendingProps),i=Gt(r.type,i),vy(n,e,r,i,t);case 15:return lE(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Gt(r,i),$l(n,e),e.tag=1,Rt(r)?(n=!0,gu(e)):n=!1,ns(e,t),sE(e,r,i),kd(e,r,i,t),Nd(null,e,r,!0,n,t);case 19:return fE(n,e,t);case 22:return uE(n,e,t)}throw Error(B(156,e.tag))};function xE(n,e){return nw(n,e)}function LR(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ut(n,e,t,r){return new LR(n,e,t,r)}function dp(n){return n=n.prototype,!(!n||!n.isReactComponent)}function MR(n){if(typeof n=="function")return dp(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Df)return 11;if(n===bf)return 14}return 2}function pr(n,e){var t=n.alternate;return t===null?(t=Ut(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Gl(n,e,t,r,i,s){var o=2;if(r=n,typeof n=="function")dp(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Fi:return ei(t.children,i,s,e);case kf:o=8,i|=8;break;case ed:return n=Ut(12,t,e,i|2),n.elementType=ed,n.lanes=s,n;case td:return n=Ut(13,t,e,i),n.elementType=td,n.lanes=s,n;case nd:return n=Ut(19,t,e,i),n.elementType=nd,n.lanes=s,n;case jv:return cc(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Mv:o=10;break e;case Fv:o=9;break e;case Df:o=11;break e;case bf:o=14;break e;case Hn:o=16,r=null;break e}throw Error(B(130,n==null?n:typeof n,""))}return e=Ut(o,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function ei(n,e,t,r){return n=Ut(7,n,r,e),n.lanes=t,n}function cc(n,e,t,r){return n=Ut(22,n,r,e),n.elementType=jv,n.lanes=t,n.stateNode={isHidden:!1},n}function Oh(n,e,t){return n=Ut(6,n,null,e),n.lanes=t,n}function Lh(n,e,t){return e=Ut(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function FR(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gh(0),this.expirationTimes=gh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gh(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function fp(n,e,t,r,i,s,o,a,u){return n=new FR(n,e,t,a,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ut(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yf(s),n}function jR(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mi,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function kE(n){if(!n)return Ir;n=n._reactInternals;e:{if(_i(n)!==n||n.tag!==1)throw Error(B(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Rt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(B(171))}if(n.tag===1){var t=n.type;if(Rt(t))return kw(n,t,e)}return e}function DE(n,e,t,r,i,s,o,a,u){return n=fp(t,r,!0,n,i,s,o,a,u),n.context=kE(null),t=n.current,r=gt(),i=fr(t),s=Cn(r,i),s.callback=e??null,hr(t,s,i),n.current.lanes=i,Ra(n,i,r),Pt(n,r),n}function hc(n,e,t,r){var i=e.current,s=gt(),o=fr(i);return t=kE(t),e.context===null?e.context=t:e.pendingContext=t,e=Cn(s,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=hr(i,e,o),n!==null&&(Yt(n,i,o,s),Ul(n,i,o)),o}function xu(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Dy(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function pp(n,e){Dy(n,e),(n=n.alternate)&&Dy(n,e)}function UR(){return null}var bE=typeof reportError=="function"?reportError:function(n){console.error(n)};function mp(n){this._internalRoot=n}dc.prototype.render=mp.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(B(409));hc(n,e,null,null)};dc.prototype.unmount=mp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;oi(function(){hc(null,n,null,null)}),e[Dn]=null}};function dc(n){this._internalRoot=n}dc.prototype.unstable_scheduleHydration=function(n){if(n){var e=uw();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Yn.length&&e!==0&&e<Yn[t].priority;t++);Yn.splice(t,0,n),t===0&&hw(n)}};function gp(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function fc(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function by(){}function BR(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=xu(o);s.call(c)}}var o=DE(e,r,n,0,null,!1,!1,"",by);return n._reactRootContainer=o,n[Dn]=o.current,Xo(n.nodeType===8?n.parentNode:n),oi(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=xu(u);a.call(c)}}var u=fp(n,0,!1,null,null,!1,!1,"",by);return n._reactRootContainer=u,n[Dn]=u.current,Xo(n.nodeType===8?n.parentNode:n),oi(function(){hc(e,u,t,r)}),u}function pc(n,e,t,r,i){var s=t._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var u=xu(o);a.call(u)}}hc(e,o,n,i)}else o=BR(t,e,n,i,r);return xu(o)}aw=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=vo(e.pendingLanes);t!==0&&(Of(e,t|1),Pt(e,Oe()),!(ue&6)&&(ps=Oe()+500,xr()))}break;case 13:oi(function(){var r=bn(n,1);if(r!==null){var i=gt();Yt(r,n,1,i)}}),pp(n,1)}};Lf=function(n){if(n.tag===13){var e=bn(n,134217728);if(e!==null){var t=gt();Yt(e,n,134217728,t)}pp(n,134217728)}};lw=function(n){if(n.tag===13){var e=fr(n),t=bn(n,e);if(t!==null){var r=gt();Yt(t,n,e,r)}pp(n,e)}};uw=function(){return pe};cw=function(n,e){var t=pe;try{return pe=n,e()}finally{pe=t}};dd=function(n,e,t){switch(e){case"input":if(sd(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=ic(r);if(!i)throw Error(B(90));Bv(r),sd(r,i)}}}break;case"textarea":$v(n,t);break;case"select":e=t.value,e!=null&&Xi(n,!!t.multiple,e,!1)}};Yv=up;Jv=oi;var zR={usingClientEntryPoint:!1,Events:[Ca,zi,ic,Hv,Qv,up]},lo={findFiberByHostInstance:Yr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$R={bundleType:lo.bundleType,version:lo.version,rendererPackageName:lo.rendererPackageName,rendererConfig:lo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fn.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=ew(n),n===null?null:n.stateNode},findFiberByHostInstance:lo.findFiberByHostInstance||UR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sl.isDisabled&&Sl.supportsFiber)try{ec=Sl.inject($R),an=Sl}catch{}}Lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zR;Lt.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gp(e))throw Error(B(200));return jR(n,e,null,t)};Lt.createRoot=function(n,e){if(!gp(n))throw Error(B(299));var t=!1,r="",i=bE;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=fp(n,1,!1,null,null,t,!1,r,i),n[Dn]=e.current,Xo(n.nodeType===8?n.parentNode:n),new mp(e)};Lt.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(B(188)):(n=Object.keys(n).join(","),Error(B(268,n)));return n=ew(e),n=n===null?null:n.stateNode,n};Lt.flushSync=function(n){return oi(n)};Lt.hydrate=function(n,e,t){if(!fc(e))throw Error(B(200));return pc(null,n,e,!0,t)};Lt.hydrateRoot=function(n,e,t){if(!gp(n))throw Error(B(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",o=bE;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=DE(e,null,n,1,t??null,i,!1,s,o),n[Dn]=e.current,Xo(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new dc(e)};Lt.render=function(n,e,t){if(!fc(e))throw Error(B(200));return pc(null,n,e,!1,t)};Lt.unmountComponentAtNode=function(n){if(!fc(n))throw Error(B(40));return n._reactRootContainer?(oi(function(){pc(null,null,n,!1,function(){n._reactRootContainer=null,n[Dn]=null})}),!0):!1};Lt.unstable_batchedUpdates=up;Lt.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!fc(t))throw Error(B(200));if(n==null||n._reactInternals===void 0)throw Error(B(38));return pc(n,e,t,!1,r)};Lt.version="18.3.1-next-f1338f8080-20240426";function NE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(NE)}catch(n){console.error(n)}}NE(),Nv.exports=Lt;var qR=Nv.exports,Ny=qR;Xh.createRoot=Ny.createRoot,Xh.hydrateRoot=Ny.hydrateRoot;var Vy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VE=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},KR=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],a=n[t++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},OE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,a=o?n[i+1]:0,u=i+2<n.length,c=u?n[i+2]:0,d=s>>2,p=(s&3)<<4|a>>4;let m=(a&15)<<2|c>>6,E=c&63;u||(E=64,o||(m=64)),r.push(t[d],t[p],t[m],t[E])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(VE(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):KR(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;const c=i<n.length?t[n.charAt(i)]:64;++i;const p=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||c==null||p==null)throw new GR;const m=s<<2|a>>4;if(r.push(m),c!==64){const E=a<<4&240|c>>2;if(r.push(E),p!==64){const R=c<<6&192|p;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class GR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const WR=function(n){const e=VE(n);return OE.encodeByteArray(e,!0)},LE=function(n){return WR(n).replace(/\./g,"")},ME=function(n){try{return OE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR=()=>HR().__FIREBASE_DEFAULTS__,YR=()=>{if(typeof process>"u"||typeof Vy>"u")return;const n=Vy.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},JR=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&ME(n[1]);return e&&JSON.parse(e)},mc=()=>{try{return QR()||YR()||JR()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},XR=n=>{var e,t;return(t=(e=mc())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},FE=()=>{var n;return(n=mc())===null||n===void 0?void 0:n.config},jE=n=>{var e;return(e=mc())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function eP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qe())}function tP(){var n;const e=(n=mc())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function rP(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function iP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function sP(){const n=qe();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function UE(){return!tP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function BE(){try{return typeof indexedDB=="object"}catch{return!1}}function oP(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aP="FirebaseError";class jn extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=aP,Object.setPrototypeOf(this,jn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ka.prototype.create)}}class ka{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?lP(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new jn(i,a,r)}}function lP(n,e){return n.replace(uP,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const uP=/\{\$([^}]+)}/g;function cP(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function aa(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(Oy(s)&&Oy(o)){if(!aa(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function Oy(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Da(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Eo(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Io(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function hP(n,e){const t=new dP(n,e);return t.subscribe.bind(t)}class dP{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");fP(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Mh),i.error===void 0&&(i.error=Mh),i.complete===void 0&&(i.complete=Mh);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function fP(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Mh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ue(n){return n&&n._delegate?n._delegate:n}class ai{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new ZR;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(gP(e))try{this.getOrInitializeService({instanceIdentifier:qr})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=qr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=qr){return this.instances.has(e)}getOptions(e=qr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:mP(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=qr){return this.component?this.component.multipleInstances?e:qr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function mP(n){return n===qr?void 0:n}function gP(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new pP(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(oe||(oe={}));const _P={debug:oe.DEBUG,verbose:oe.VERBOSE,info:oe.INFO,warn:oe.WARN,error:oe.ERROR,silent:oe.SILENT},vP=oe.INFO,wP={[oe.DEBUG]:"log",[oe.VERBOSE]:"log",[oe.INFO]:"info",[oe.WARN]:"warn",[oe.ERROR]:"error"},EP=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=wP[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class yp{constructor(e){this.name=e,this._logLevel=vP,this._logHandler=EP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in oe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?_P[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,oe.DEBUG,...e),this._logHandler(this,oe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,oe.VERBOSE,...e),this._logHandler(this,oe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,oe.INFO,...e),this._logHandler(this,oe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,oe.WARN,...e),this._logHandler(this,oe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,oe.ERROR,...e),this._logHandler(this,oe.ERROR,...e)}}const IP=(n,e)=>e.some(t=>n instanceof t);let Ly,My;function TP(){return Ly||(Ly=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function SP(){return My||(My=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const zE=new WeakMap,Kd=new WeakMap,$E=new WeakMap,Fh=new WeakMap,_p=new WeakMap;function AP(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(mr(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&zE.set(t,n)}).catch(()=>{}),_p.set(e,n),e}function RP(n){if(Kd.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Kd.set(n,e)}let Gd={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Kd.get(n);if(e==="objectStoreNames")return n.objectStoreNames||$E.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return mr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function PP(n){Gd=n(Gd)}function CP(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(jh(this),e,...t);return $E.set(r,e.sort?e.sort():[e]),mr(r)}:SP().includes(n)?function(...e){return n.apply(jh(this),e),mr(zE.get(this))}:function(...e){return mr(n.apply(jh(this),e))}}function xP(n){return typeof n=="function"?CP(n):(n instanceof IDBTransaction&&RP(n),IP(n,TP())?new Proxy(n,Gd):n)}function mr(n){if(n instanceof IDBRequest)return AP(n);if(Fh.has(n))return Fh.get(n);const e=xP(n);return e!==n&&(Fh.set(n,e),_p.set(e,n)),e}const jh=n=>_p.get(n);function kP(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),a=mr(o);return r&&o.addEventListener("upgradeneeded",u=>{r(mr(o.result),u.oldVersion,u.newVersion,mr(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),a.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const DP=["get","getKey","getAll","getAllKeys","count"],bP=["put","add","delete","clear"],Uh=new Map;function Fy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Uh.get(e))return Uh.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=bP.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||DP.includes(t)))return;const s=async function(o,...a){const u=this.transaction(o,i?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),i&&u.done]))[0]};return Uh.set(e,s),s}PP(n=>({...n,get:(e,t,r)=>Fy(e,t)||n.get(e,t,r),has:(e,t)=>!!Fy(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(VP(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function VP(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Wd="@firebase/app",jy="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vn=new yp("@firebase/app"),OP="@firebase/app-compat",LP="@firebase/analytics-compat",MP="@firebase/analytics",FP="@firebase/app-check-compat",jP="@firebase/app-check",UP="@firebase/auth",BP="@firebase/auth-compat",zP="@firebase/database",$P="@firebase/data-connect",qP="@firebase/database-compat",KP="@firebase/functions",GP="@firebase/functions-compat",WP="@firebase/installations",HP="@firebase/installations-compat",QP="@firebase/messaging",YP="@firebase/messaging-compat",JP="@firebase/performance",XP="@firebase/performance-compat",ZP="@firebase/remote-config",eC="@firebase/remote-config-compat",tC="@firebase/storage",nC="@firebase/storage-compat",rC="@firebase/firestore",iC="@firebase/vertexai-preview",sC="@firebase/firestore-compat",oC="firebase",aC="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hd="[DEFAULT]",lC={[Wd]:"fire-core",[OP]:"fire-core-compat",[MP]:"fire-analytics",[LP]:"fire-analytics-compat",[jP]:"fire-app-check",[FP]:"fire-app-check-compat",[UP]:"fire-auth",[BP]:"fire-auth-compat",[zP]:"fire-rtdb",[$P]:"fire-data-connect",[qP]:"fire-rtdb-compat",[KP]:"fire-fn",[GP]:"fire-fn-compat",[WP]:"fire-iid",[HP]:"fire-iid-compat",[QP]:"fire-fcm",[YP]:"fire-fcm-compat",[JP]:"fire-perf",[XP]:"fire-perf-compat",[ZP]:"fire-rc",[eC]:"fire-rc-compat",[tC]:"fire-gcs",[nC]:"fire-gcs-compat",[rC]:"fire-fst",[sC]:"fire-fst-compat",[iC]:"fire-vertex","fire-js":"fire-js",[oC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ku=new Map,uC=new Map,Qd=new Map;function Uy(n,e){try{n.container.addComponent(e)}catch(t){Vn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ms(n){const e=n.name;if(Qd.has(e))return Vn.debug(`There were multiple attempts to register component ${e}.`),!1;Qd.set(e,n);for(const t of ku.values())Uy(t,n);for(const t of uC.values())Uy(t,n);return!0}function vp(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Tn(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},gr=new ka("app","Firebase",cC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ai("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw gr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vs=aC;function qE(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Hd,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw gr.create("bad-app-name",{appName:String(i)});if(t||(t=FE()),!t)throw gr.create("no-options");const s=ku.get(i);if(s){if(aa(t,s.options)&&aa(r,s.config))return s;throw gr.create("duplicate-app",{appName:i})}const o=new yP(i);for(const u of Qd.values())o.addComponent(u);const a=new hC(t,r,o);return ku.set(i,a),a}function dC(n=Hd){const e=ku.get(n);if(!e&&n===Hd&&FE())return qE();if(!e)throw gr.create("no-app",{appName:n});return e}function yr(n,e,t){var r;let i=(r=lC[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Vn.warn(a.join(" "));return}ms(new ai(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC="firebase-heartbeat-database",pC=1,la="firebase-heartbeat-store";let Bh=null;function KE(){return Bh||(Bh=kP(fC,pC,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(la)}catch(t){console.warn(t)}}}}).catch(n=>{throw gr.create("idb-open",{originalErrorMessage:n.message})})),Bh}async function mC(n){try{const t=(await KE()).transaction(la),r=await t.objectStore(la).get(GE(n));return await t.done,r}catch(e){if(e instanceof jn)Vn.warn(e.message);else{const t=gr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Vn.warn(t.message)}}}async function By(n,e){try{const r=(await KE()).transaction(la,"readwrite");await r.objectStore(la).put(e,GE(n)),await r.done}catch(t){if(t instanceof jn)Vn.warn(t.message);else{const r=gr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Vn.warn(r.message)}}}function GE(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gC=1024,yC=30*24*60*60*1e3;class _C{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new wC(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=zy();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=yC}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Vn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=zy(),{heartbeatsToSend:r,unsentEntries:i}=vC(this._heartbeatsCache.heartbeats),s=LE(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Vn.warn(t),""}}}function zy(){return new Date().toISOString().substring(0,10)}function vC(n,e=gC){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),$y(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),$y(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class wC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return BE()?oP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await mC(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return By(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return By(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function $y(n){return LE(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EC(n){ms(new ai("platform-logger",e=>new NP(e),"PRIVATE")),ms(new ai("heartbeat",e=>new _C(e),"PRIVATE")),yr(Wd,jy,n),yr(Wd,jy,"esm2017"),yr("fire-js","")}EC("");var IC="firebase",TC="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yr(IC,TC,"app");var qy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ti,WE;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,g){function I(){}I.prototype=g.prototype,_.D=g.prototype,_.prototype=new I,_.prototype.constructor=_,_.C=function(T,x,A){for(var v=Array(arguments.length-2),J=2;J<arguments.length;J++)v[J-2]=arguments[J];return g.prototype[x].apply(T,v)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(_,g,I){I||(I=0);var T=Array(16);if(typeof g=="string")for(var x=0;16>x;++x)T[x]=g.charCodeAt(I++)|g.charCodeAt(I++)<<8|g.charCodeAt(I++)<<16|g.charCodeAt(I++)<<24;else for(x=0;16>x;++x)T[x]=g[I++]|g[I++]<<8|g[I++]<<16|g[I++]<<24;g=_.g[0],I=_.g[1],x=_.g[2];var A=_.g[3],v=g+(A^I&(x^A))+T[0]+3614090360&4294967295;g=I+(v<<7&4294967295|v>>>25),v=A+(x^g&(I^x))+T[1]+3905402710&4294967295,A=g+(v<<12&4294967295|v>>>20),v=x+(I^A&(g^I))+T[2]+606105819&4294967295,x=A+(v<<17&4294967295|v>>>15),v=I+(g^x&(A^g))+T[3]+3250441966&4294967295,I=x+(v<<22&4294967295|v>>>10),v=g+(A^I&(x^A))+T[4]+4118548399&4294967295,g=I+(v<<7&4294967295|v>>>25),v=A+(x^g&(I^x))+T[5]+1200080426&4294967295,A=g+(v<<12&4294967295|v>>>20),v=x+(I^A&(g^I))+T[6]+2821735955&4294967295,x=A+(v<<17&4294967295|v>>>15),v=I+(g^x&(A^g))+T[7]+4249261313&4294967295,I=x+(v<<22&4294967295|v>>>10),v=g+(A^I&(x^A))+T[8]+1770035416&4294967295,g=I+(v<<7&4294967295|v>>>25),v=A+(x^g&(I^x))+T[9]+2336552879&4294967295,A=g+(v<<12&4294967295|v>>>20),v=x+(I^A&(g^I))+T[10]+4294925233&4294967295,x=A+(v<<17&4294967295|v>>>15),v=I+(g^x&(A^g))+T[11]+2304563134&4294967295,I=x+(v<<22&4294967295|v>>>10),v=g+(A^I&(x^A))+T[12]+1804603682&4294967295,g=I+(v<<7&4294967295|v>>>25),v=A+(x^g&(I^x))+T[13]+4254626195&4294967295,A=g+(v<<12&4294967295|v>>>20),v=x+(I^A&(g^I))+T[14]+2792965006&4294967295,x=A+(v<<17&4294967295|v>>>15),v=I+(g^x&(A^g))+T[15]+1236535329&4294967295,I=x+(v<<22&4294967295|v>>>10),v=g+(x^A&(I^x))+T[1]+4129170786&4294967295,g=I+(v<<5&4294967295|v>>>27),v=A+(I^x&(g^I))+T[6]+3225465664&4294967295,A=g+(v<<9&4294967295|v>>>23),v=x+(g^I&(A^g))+T[11]+643717713&4294967295,x=A+(v<<14&4294967295|v>>>18),v=I+(A^g&(x^A))+T[0]+3921069994&4294967295,I=x+(v<<20&4294967295|v>>>12),v=g+(x^A&(I^x))+T[5]+3593408605&4294967295,g=I+(v<<5&4294967295|v>>>27),v=A+(I^x&(g^I))+T[10]+38016083&4294967295,A=g+(v<<9&4294967295|v>>>23),v=x+(g^I&(A^g))+T[15]+3634488961&4294967295,x=A+(v<<14&4294967295|v>>>18),v=I+(A^g&(x^A))+T[4]+3889429448&4294967295,I=x+(v<<20&4294967295|v>>>12),v=g+(x^A&(I^x))+T[9]+568446438&4294967295,g=I+(v<<5&4294967295|v>>>27),v=A+(I^x&(g^I))+T[14]+3275163606&4294967295,A=g+(v<<9&4294967295|v>>>23),v=x+(g^I&(A^g))+T[3]+4107603335&4294967295,x=A+(v<<14&4294967295|v>>>18),v=I+(A^g&(x^A))+T[8]+1163531501&4294967295,I=x+(v<<20&4294967295|v>>>12),v=g+(x^A&(I^x))+T[13]+2850285829&4294967295,g=I+(v<<5&4294967295|v>>>27),v=A+(I^x&(g^I))+T[2]+4243563512&4294967295,A=g+(v<<9&4294967295|v>>>23),v=x+(g^I&(A^g))+T[7]+1735328473&4294967295,x=A+(v<<14&4294967295|v>>>18),v=I+(A^g&(x^A))+T[12]+2368359562&4294967295,I=x+(v<<20&4294967295|v>>>12),v=g+(I^x^A)+T[5]+4294588738&4294967295,g=I+(v<<4&4294967295|v>>>28),v=A+(g^I^x)+T[8]+2272392833&4294967295,A=g+(v<<11&4294967295|v>>>21),v=x+(A^g^I)+T[11]+1839030562&4294967295,x=A+(v<<16&4294967295|v>>>16),v=I+(x^A^g)+T[14]+4259657740&4294967295,I=x+(v<<23&4294967295|v>>>9),v=g+(I^x^A)+T[1]+2763975236&4294967295,g=I+(v<<4&4294967295|v>>>28),v=A+(g^I^x)+T[4]+1272893353&4294967295,A=g+(v<<11&4294967295|v>>>21),v=x+(A^g^I)+T[7]+4139469664&4294967295,x=A+(v<<16&4294967295|v>>>16),v=I+(x^A^g)+T[10]+3200236656&4294967295,I=x+(v<<23&4294967295|v>>>9),v=g+(I^x^A)+T[13]+681279174&4294967295,g=I+(v<<4&4294967295|v>>>28),v=A+(g^I^x)+T[0]+3936430074&4294967295,A=g+(v<<11&4294967295|v>>>21),v=x+(A^g^I)+T[3]+3572445317&4294967295,x=A+(v<<16&4294967295|v>>>16),v=I+(x^A^g)+T[6]+76029189&4294967295,I=x+(v<<23&4294967295|v>>>9),v=g+(I^x^A)+T[9]+3654602809&4294967295,g=I+(v<<4&4294967295|v>>>28),v=A+(g^I^x)+T[12]+3873151461&4294967295,A=g+(v<<11&4294967295|v>>>21),v=x+(A^g^I)+T[15]+530742520&4294967295,x=A+(v<<16&4294967295|v>>>16),v=I+(x^A^g)+T[2]+3299628645&4294967295,I=x+(v<<23&4294967295|v>>>9),v=g+(x^(I|~A))+T[0]+4096336452&4294967295,g=I+(v<<6&4294967295|v>>>26),v=A+(I^(g|~x))+T[7]+1126891415&4294967295,A=g+(v<<10&4294967295|v>>>22),v=x+(g^(A|~I))+T[14]+2878612391&4294967295,x=A+(v<<15&4294967295|v>>>17),v=I+(A^(x|~g))+T[5]+4237533241&4294967295,I=x+(v<<21&4294967295|v>>>11),v=g+(x^(I|~A))+T[12]+1700485571&4294967295,g=I+(v<<6&4294967295|v>>>26),v=A+(I^(g|~x))+T[3]+2399980690&4294967295,A=g+(v<<10&4294967295|v>>>22),v=x+(g^(A|~I))+T[10]+4293915773&4294967295,x=A+(v<<15&4294967295|v>>>17),v=I+(A^(x|~g))+T[1]+2240044497&4294967295,I=x+(v<<21&4294967295|v>>>11),v=g+(x^(I|~A))+T[8]+1873313359&4294967295,g=I+(v<<6&4294967295|v>>>26),v=A+(I^(g|~x))+T[15]+4264355552&4294967295,A=g+(v<<10&4294967295|v>>>22),v=x+(g^(A|~I))+T[6]+2734768916&4294967295,x=A+(v<<15&4294967295|v>>>17),v=I+(A^(x|~g))+T[13]+1309151649&4294967295,I=x+(v<<21&4294967295|v>>>11),v=g+(x^(I|~A))+T[4]+4149444226&4294967295,g=I+(v<<6&4294967295|v>>>26),v=A+(I^(g|~x))+T[11]+3174756917&4294967295,A=g+(v<<10&4294967295|v>>>22),v=x+(g^(A|~I))+T[2]+718787259&4294967295,x=A+(v<<15&4294967295|v>>>17),v=I+(A^(x|~g))+T[9]+3951481745&4294967295,_.g[0]=_.g[0]+g&4294967295,_.g[1]=_.g[1]+(x+(v<<21&4294967295|v>>>11))&4294967295,_.g[2]=_.g[2]+x&4294967295,_.g[3]=_.g[3]+A&4294967295}r.prototype.u=function(_,g){g===void 0&&(g=_.length);for(var I=g-this.blockSize,T=this.B,x=this.h,A=0;A<g;){if(x==0)for(;A<=I;)i(this,_,A),A+=this.blockSize;if(typeof _=="string"){for(;A<g;)if(T[x++]=_.charCodeAt(A++),x==this.blockSize){i(this,T),x=0;break}}else for(;A<g;)if(T[x++]=_[A++],x==this.blockSize){i(this,T),x=0;break}}this.h=x,this.o+=g},r.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var g=1;g<_.length-8;++g)_[g]=0;var I=8*this.o;for(g=_.length-8;g<_.length;++g)_[g]=I&255,I/=256;for(this.u(_),_=Array(16),g=I=0;4>g;++g)for(var T=0;32>T;T+=8)_[I++]=this.g[g]>>>T&255;return _};function s(_,g){var I=a;return Object.prototype.hasOwnProperty.call(I,_)?I[_]:I[_]=g(_)}function o(_,g){this.h=g;for(var I=[],T=!0,x=_.length-1;0<=x;x--){var A=_[x]|0;T&&A==g||(I[x]=A,T=!1)}this.g=I}var a={};function u(_){return-128<=_&&128>_?s(_,function(g){return new o([g|0],0>g?-1:0)}):new o([_|0],0>_?-1:0)}function c(_){if(isNaN(_)||!isFinite(_))return p;if(0>_)return L(c(-_));for(var g=[],I=1,T=0;_>=I;T++)g[T]=_/I|0,I*=4294967296;return new o(g,0)}function d(_,g){if(_.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(_.charAt(0)=="-")return L(d(_.substring(1),g));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=c(Math.pow(g,8)),T=p,x=0;x<_.length;x+=8){var A=Math.min(8,_.length-x),v=parseInt(_.substring(x,x+A),g);8>A?(A=c(Math.pow(g,A)),T=T.j(A).add(c(v))):(T=T.j(I),T=T.add(c(v)))}return T}var p=u(0),m=u(1),E=u(16777216);n=o.prototype,n.m=function(){if(D(this))return-L(this).m();for(var _=0,g=1,I=0;I<this.g.length;I++){var T=this.i(I);_+=(0<=T?T:4294967296+T)*g,g*=4294967296}return _},n.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(R(this))return"0";if(D(this))return"-"+L(this).toString(_);for(var g=c(Math.pow(_,6)),I=this,T="";;){var x=V(I,g).g;I=C(I,x.j(g));var A=((0<I.g.length?I.g[0]:I.h)>>>0).toString(_);if(I=x,R(I))return A+T;for(;6>A.length;)A="0"+A;T=A+T}},n.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function R(_){if(_.h!=0)return!1;for(var g=0;g<_.g.length;g++)if(_.g[g]!=0)return!1;return!0}function D(_){return _.h==-1}n.l=function(_){return _=C(this,_),D(_)?-1:R(_)?0:1};function L(_){for(var g=_.g.length,I=[],T=0;T<g;T++)I[T]=~_.g[T];return new o(I,~_.h).add(m)}n.abs=function(){return D(this)?L(this):this},n.add=function(_){for(var g=Math.max(this.g.length,_.g.length),I=[],T=0,x=0;x<=g;x++){var A=T+(this.i(x)&65535)+(_.i(x)&65535),v=(A>>>16)+(this.i(x)>>>16)+(_.i(x)>>>16);T=v>>>16,A&=65535,v&=65535,I[x]=v<<16|A}return new o(I,I[I.length-1]&-2147483648?-1:0)};function C(_,g){return _.add(L(g))}n.j=function(_){if(R(this)||R(_))return p;if(D(this))return D(_)?L(this).j(L(_)):L(L(this).j(_));if(D(_))return L(this.j(L(_)));if(0>this.l(E)&&0>_.l(E))return c(this.m()*_.m());for(var g=this.g.length+_.g.length,I=[],T=0;T<2*g;T++)I[T]=0;for(T=0;T<this.g.length;T++)for(var x=0;x<_.g.length;x++){var A=this.i(T)>>>16,v=this.i(T)&65535,J=_.i(x)>>>16,ie=_.i(x)&65535;I[2*T+2*x]+=v*ie,S(I,2*T+2*x),I[2*T+2*x+1]+=A*ie,S(I,2*T+2*x+1),I[2*T+2*x+1]+=v*J,S(I,2*T+2*x+1),I[2*T+2*x+2]+=A*J,S(I,2*T+2*x+2)}for(T=0;T<g;T++)I[T]=I[2*T+1]<<16|I[2*T];for(T=g;T<2*g;T++)I[T]=0;return new o(I,0)};function S(_,g){for(;(_[g]&65535)!=_[g];)_[g+1]+=_[g]>>>16,_[g]&=65535,g++}function P(_,g){this.g=_,this.h=g}function V(_,g){if(R(g))throw Error("division by zero");if(R(_))return new P(p,p);if(D(_))return g=V(L(_),g),new P(L(g.g),L(g.h));if(D(g))return g=V(_,L(g)),new P(L(g.g),g.h);if(30<_.g.length){if(D(_)||D(g))throw Error("slowDivide_ only works with positive integers.");for(var I=m,T=g;0>=T.l(_);)I=M(I),T=M(T);var x=k(I,1),A=k(T,1);for(T=k(T,2),I=k(I,2);!R(T);){var v=A.add(T);0>=v.l(_)&&(x=x.add(I),A=v),T=k(T,1),I=k(I,1)}return g=C(_,x.j(g)),new P(x,g)}for(x=p;0<=_.l(g);){for(I=Math.max(1,Math.floor(_.m()/g.m())),T=Math.ceil(Math.log(I)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),A=c(I),v=A.j(g);D(v)||0<v.l(_);)I-=T,A=c(I),v=A.j(g);R(A)&&(A=m),x=x.add(A),_=C(_,v)}return new P(x,_)}n.A=function(_){return V(this,_).h},n.and=function(_){for(var g=Math.max(this.g.length,_.g.length),I=[],T=0;T<g;T++)I[T]=this.i(T)&_.i(T);return new o(I,this.h&_.h)},n.or=function(_){for(var g=Math.max(this.g.length,_.g.length),I=[],T=0;T<g;T++)I[T]=this.i(T)|_.i(T);return new o(I,this.h|_.h)},n.xor=function(_){for(var g=Math.max(this.g.length,_.g.length),I=[],T=0;T<g;T++)I[T]=this.i(T)^_.i(T);return new o(I,this.h^_.h)};function M(_){for(var g=_.g.length+1,I=[],T=0;T<g;T++)I[T]=_.i(T)<<1|_.i(T-1)>>>31;return new o(I,_.h)}function k(_,g){var I=g>>5;g%=32;for(var T=_.g.length-I,x=[],A=0;A<T;A++)x[A]=0<g?_.i(A+I)>>>g|_.i(A+I+1)<<32-g:_.i(A+I);return new o(x,_.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,WE=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,ti=o}).apply(typeof qy<"u"?qy:typeof self<"u"?self:typeof window<"u"?window:{});var Al=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var HE,To,QE,Wl,Yd,YE,JE,XE;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,f){return l==Array.prototype||l==Object.prototype||(l[h]=f.value),l};function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Al=="object"&&Al];for(var h=0;h<l.length;++h){var f=l[h];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(l,h){if(h)e:{var f=r;l=l.split(".");for(var y=0;y<l.length-1;y++){var b=l[y];if(!(b in f))break e;f=f[b]}l=l[l.length-1],y=f[l],h=h(y),h!=y&&h!=null&&e(f,l,{configurable:!0,writable:!0,value:h})}}function s(l,h){l instanceof String&&(l+="");var f=0,y=!1,b={next:function(){if(!y&&f<l.length){var O=f++;return{value:h(O,l[O]),done:!1}}return y=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b}i("Array.prototype.values",function(l){return l||function(){return s(this,function(h,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function u(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function c(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function d(l,h,f){return l.call.apply(l.bind,arguments)}function p(l,h,f){if(!l)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(b,y),l.apply(h,b)}}return function(){return l.apply(h,arguments)}}function m(l,h,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:p,m.apply(null,arguments)}function E(l,h){var f=Array.prototype.slice.call(arguments,1);return function(){var y=f.slice();return y.push.apply(y,arguments),l.apply(this,y)}}function R(l,h){function f(){}f.prototype=h.prototype,l.aa=h.prototype,l.prototype=new f,l.prototype.constructor=l,l.Qb=function(y,b,O){for(var $=Array(arguments.length-2),ye=2;ye<arguments.length;ye++)$[ye-2]=arguments[ye];return h.prototype[b].apply(y,$)}}function D(l){const h=l.length;if(0<h){const f=Array(h);for(let y=0;y<h;y++)f[y]=l[y];return f}return[]}function L(l,h){for(let f=1;f<arguments.length;f++){const y=arguments[f];if(u(y)){const b=l.length||0,O=y.length||0;l.length=b+O;for(let $=0;$<O;$++)l[b+$]=y[$]}else l.push(y)}}class C{constructor(h,f){this.i=h,this.j=f,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function S(l){return/^[\s\xa0]*$/.test(l)}function P(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function V(l){return V[" "](l),l}V[" "]=function(){};var M=P().indexOf("Gecko")!=-1&&!(P().toLowerCase().indexOf("webkit")!=-1&&P().indexOf("Edge")==-1)&&!(P().indexOf("Trident")!=-1||P().indexOf("MSIE")!=-1)&&P().indexOf("Edge")==-1;function k(l,h,f){for(const y in l)h.call(f,l[y],y,l)}function _(l,h){for(const f in l)h.call(void 0,l[f],f,l)}function g(l){const h={};for(const f in l)h[f]=l[f];return h}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(l,h){let f,y;for(let b=1;b<arguments.length;b++){y=arguments[b];for(f in y)l[f]=y[f];for(let O=0;O<I.length;O++)f=I[O],Object.prototype.hasOwnProperty.call(y,f)&&(l[f]=y[f])}}function x(l){var h=1;l=l.split(":");const f=[];for(;0<h&&l.length;)f.push(l.shift()),h--;return l.length&&f.push(l.join(":")),f}function A(l){a.setTimeout(()=>{throw l},0)}function v(){var l=Z;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class J{constructor(){this.h=this.g=null}add(h,f){const y=ie.get();y.set(h,f),this.h?this.h.next=y:this.g=y,this.h=y}}var ie=new C(()=>new te,l=>l.reset());class te{constructor(){this.next=this.g=this.h=null}set(h,f){this.h=h,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let de,U=!1,Z=new J,ne=()=>{const l=a.Promise.resolve(void 0);de=()=>{l.then(Re)}};var Re=()=>{for(var l;l=v();){try{l.h.call(l.g)}catch(f){A(f)}var h=ie;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}U=!1};function ge(){this.s=this.s,this.C=this.C}ge.prototype.s=!1,ge.prototype.ma=function(){this.s||(this.s=!0,this.N())},ge.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ve(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}Ve.prototype.h=function(){this.defaultPrevented=!0};var fn=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const f=()=>{};a.addEventListener("test",f,h),a.removeEventListener("test",f,h)}catch{}return l}();function pn(l,h){if(Ve.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var f=this.type=l.type,y=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(M){e:{try{V(h.nodeName);var b=!0;break e}catch{}b=!1}b||(h=null)}}else f=="mouseover"?h=l.fromElement:f=="mouseout"&&(h=l.toElement);this.relatedTarget=h,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:mn[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&pn.aa.h.call(this)}}R(pn,Ve);var mn={2:"touch",3:"pen",4:"mouse"};pn.prototype.h=function(){pn.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var gn="closure_listenable_"+(1e6*Math.random()|0),B0=0;function z0(l,h,f,y,b){this.listener=l,this.proxy=null,this.src=h,this.type=f,this.capture=!!y,this.ha=b,this.key=++B0,this.da=this.fa=!1}function qa(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Ka(l){this.src=l,this.g={},this.h=0}Ka.prototype.add=function(l,h,f,y,b){var O=l.toString();l=this.g[O],l||(l=this.g[O]=[],this.h++);var $=$c(l,h,y,b);return-1<$?(h=l[$],f||(h.fa=!1)):(h=new z0(h,this.src,O,!!y,b),h.fa=f,l.push(h)),h};function zc(l,h){var f=h.type;if(f in l.g){var y=l.g[f],b=Array.prototype.indexOf.call(y,h,void 0),O;(O=0<=b)&&Array.prototype.splice.call(y,b,1),O&&(qa(h),l.g[f].length==0&&(delete l.g[f],l.h--))}}function $c(l,h,f,y){for(var b=0;b<l.length;++b){var O=l[b];if(!O.da&&O.listener==h&&O.capture==!!f&&O.ha==y)return b}return-1}var qc="closure_lm_"+(1e6*Math.random()|0),Kc={};function Rm(l,h,f,y,b){if(Array.isArray(h)){for(var O=0;O<h.length;O++)Rm(l,h[O],f,y,b);return null}return f=xm(f),l&&l[gn]?l.K(h,f,c(y)?!!y.capture:!1,b):$0(l,h,f,!1,y,b)}function $0(l,h,f,y,b,O){if(!h)throw Error("Invalid event type");var $=c(b)?!!b.capture:!!b,ye=Wc(l);if(ye||(l[qc]=ye=new Ka(l)),f=ye.add(h,f,y,$,O),f.proxy)return f;if(y=q0(),f.proxy=y,y.src=l,y.listener=f,l.addEventListener)fn||(b=$),b===void 0&&(b=!1),l.addEventListener(h.toString(),y,b);else if(l.attachEvent)l.attachEvent(Cm(h.toString()),y);else if(l.addListener&&l.removeListener)l.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return f}function q0(){function l(f){return h.call(l.src,l.listener,f)}const h=K0;return l}function Pm(l,h,f,y,b){if(Array.isArray(h))for(var O=0;O<h.length;O++)Pm(l,h[O],f,y,b);else y=c(y)?!!y.capture:!!y,f=xm(f),l&&l[gn]?(l=l.i,h=String(h).toString(),h in l.g&&(O=l.g[h],f=$c(O,f,y,b),-1<f&&(qa(O[f]),Array.prototype.splice.call(O,f,1),O.length==0&&(delete l.g[h],l.h--)))):l&&(l=Wc(l))&&(h=l.g[h.toString()],l=-1,h&&(l=$c(h,f,y,b)),(f=-1<l?h[l]:null)&&Gc(f))}function Gc(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[gn])zc(h.i,l);else{var f=l.type,y=l.proxy;h.removeEventListener?h.removeEventListener(f,y,l.capture):h.detachEvent?h.detachEvent(Cm(f),y):h.addListener&&h.removeListener&&h.removeListener(y),(f=Wc(h))?(zc(f,l),f.h==0&&(f.src=null,h[qc]=null)):qa(l)}}}function Cm(l){return l in Kc?Kc[l]:Kc[l]="on"+l}function K0(l,h){if(l.da)l=!0;else{h=new pn(h,this);var f=l.listener,y=l.ha||l.src;l.fa&&Gc(l),l=f.call(y,h)}return l}function Wc(l){return l=l[qc],l instanceof Ka?l:null}var Hc="__closure_events_fn_"+(1e9*Math.random()>>>0);function xm(l){return typeof l=="function"?l:(l[Hc]||(l[Hc]=function(h){return l.handleEvent(h)}),l[Hc])}function rt(){ge.call(this),this.i=new Ka(this),this.M=this,this.F=null}R(rt,ge),rt.prototype[gn]=!0,rt.prototype.removeEventListener=function(l,h,f,y){Pm(this,l,h,f,y)};function ft(l,h){var f,y=l.F;if(y)for(f=[];y;y=y.F)f.push(y);if(l=l.M,y=h.type||h,typeof h=="string")h=new Ve(h,l);else if(h instanceof Ve)h.target=h.target||l;else{var b=h;h=new Ve(y,l),T(h,b)}if(b=!0,f)for(var O=f.length-1;0<=O;O--){var $=h.g=f[O];b=Ga($,y,!0,h)&&b}if($=h.g=l,b=Ga($,y,!0,h)&&b,b=Ga($,y,!1,h)&&b,f)for(O=0;O<f.length;O++)$=h.g=f[O],b=Ga($,y,!1,h)&&b}rt.prototype.N=function(){if(rt.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var f=l.g[h],y=0;y<f.length;y++)qa(f[y]);delete l.g[h],l.h--}}this.F=null},rt.prototype.K=function(l,h,f,y){return this.i.add(String(l),h,!1,f,y)},rt.prototype.L=function(l,h,f,y){return this.i.add(String(l),h,!0,f,y)};function Ga(l,h,f,y){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var b=!0,O=0;O<h.length;++O){var $=h[O];if($&&!$.da&&$.capture==f){var ye=$.listener,Ye=$.ha||$.src;$.fa&&zc(l.i,$),b=ye.call(Ye,y)!==!1&&b}}return b&&!y.defaultPrevented}function km(l,h,f){if(typeof l=="function")f&&(l=m(l,f));else if(l&&typeof l.handleEvent=="function")l=m(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(l,h||0)}function Dm(l){l.g=km(()=>{l.g=null,l.i&&(l.i=!1,Dm(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class G0 extends ge{constructor(h,f){super(),this.m=h,this.l=f,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Dm(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function zs(l){ge.call(this),this.h=l,this.g={}}R(zs,ge);var bm=[];function Nm(l){k(l.g,function(h,f){this.g.hasOwnProperty(f)&&Gc(h)},l),l.g={}}zs.prototype.N=function(){zs.aa.N.call(this),Nm(this)},zs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Qc=a.JSON.stringify,W0=a.JSON.parse,H0=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Yc(){}Yc.prototype.h=null;function Vm(l){return l.h||(l.h=l.i())}function Om(){}var $s={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Jc(){Ve.call(this,"d")}R(Jc,Ve);function Xc(){Ve.call(this,"c")}R(Xc,Ve);var Mr={},Lm=null;function Wa(){return Lm=Lm||new rt}Mr.La="serverreachability";function Mm(l){Ve.call(this,Mr.La,l)}R(Mm,Ve);function qs(l){const h=Wa();ft(h,new Mm(h))}Mr.STAT_EVENT="statevent";function Fm(l,h){Ve.call(this,Mr.STAT_EVENT,l),this.stat=h}R(Fm,Ve);function pt(l){const h=Wa();ft(h,new Fm(h,l))}Mr.Ma="timingevent";function jm(l,h){Ve.call(this,Mr.Ma,l),this.size=h}R(jm,Ve);function Ks(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},h)}function Gs(){this.g=!0}Gs.prototype.xa=function(){this.g=!1};function Q0(l,h,f,y,b,O){l.info(function(){if(l.g)if(O)for(var $="",ye=O.split("&"),Ye=0;Ye<ye.length;Ye++){var ce=ye[Ye].split("=");if(1<ce.length){var it=ce[0];ce=ce[1];var st=it.split("_");$=2<=st.length&&st[1]=="type"?$+(it+"="+ce+"&"):$+(it+"=redacted&")}}else $=null;else $=O;return"XMLHTTP REQ ("+y+") [attempt "+b+"]: "+h+`
`+f+`
`+$})}function Y0(l,h,f,y,b,O,$){l.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+b+"]: "+h+`
`+f+`
`+O+" "+$})}function Ti(l,h,f,y){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+X0(l,f)+(y?" "+y:"")})}function J0(l,h){l.info(function(){return"TIMEOUT: "+h})}Gs.prototype.info=function(){};function X0(l,h){if(!l.g)return h;if(!h)return null;try{var f=JSON.parse(h);if(f){for(l=0;l<f.length;l++)if(Array.isArray(f[l])){var y=f[l];if(!(2>y.length)){var b=y[1];if(Array.isArray(b)&&!(1>b.length)){var O=b[0];if(O!="noop"&&O!="stop"&&O!="close")for(var $=1;$<b.length;$++)b[$]=""}}}}return Qc(f)}catch{return h}}var Ha={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Um={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Zc;function Qa(){}R(Qa,Yc),Qa.prototype.g=function(){return new XMLHttpRequest},Qa.prototype.i=function(){return{}},Zc=new Qa;function Bn(l,h,f,y){this.j=l,this.i=h,this.l=f,this.R=y||1,this.U=new zs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Bm}function Bm(){this.i=null,this.g="",this.h=!1}var zm={},eh={};function th(l,h,f){l.L=1,l.v=Za(yn(h)),l.m=f,l.P=!0,$m(l,null)}function $m(l,h){l.F=Date.now(),Ya(l),l.A=yn(l.v);var f=l.A,y=l.R;Array.isArray(y)||(y=[String(y)]),rg(f.i,"t",y),l.C=0,f=l.j.J,l.h=new Bm,l.g=Eg(l.j,f?h:null,!l.m),0<l.O&&(l.M=new G0(m(l.Y,l,l.g),l.O)),h=l.U,f=l.g,y=l.ca;var b="readystatechange";Array.isArray(b)||(b&&(bm[0]=b.toString()),b=bm);for(var O=0;O<b.length;O++){var $=Rm(f,b[O],y||h.handleEvent,!1,h.h||h);if(!$)break;h.g[$.key]=$}h=l.H?g(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),qs(),Q0(l.i,l.u,l.A,l.l,l.R,l.m)}Bn.prototype.ca=function(l){l=l.target;const h=this.M;h&&_n(l)==3?h.j():this.Y(l)},Bn.prototype.Y=function(l){try{if(l==this.g)e:{const st=_n(this.g);var h=this.g.Ba();const Ri=this.g.Z();if(!(3>st)&&(st!=3||this.g&&(this.h.h||this.g.oa()||cg(this.g)))){this.J||st!=4||h==7||(h==8||0>=Ri?qs(3):qs(2)),nh(this);var f=this.g.Z();this.X=f;t:if(qm(this)){var y=cg(this.g);l="";var b=y.length,O=_n(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Fr(this),Ws(this);var $="";break t}this.h.i=new a.TextDecoder}for(h=0;h<b;h++)this.h.h=!0,l+=this.h.i.decode(y[h],{stream:!(O&&h==b-1)});y.length=0,this.h.g+=l,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=f==200,Y0(this.i,this.u,this.A,this.l,this.R,st,f),this.o){if(this.T&&!this.K){t:{if(this.g){var ye,Ye=this.g;if((ye=Ye.g?Ye.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(ye)){var ce=ye;break t}}ce=null}if(f=ce)Ti(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,rh(this,f);else{this.o=!1,this.s=3,pt(12),Fr(this),Ws(this);break e}}if(this.P){f=!0;let qt;for(;!this.J&&this.C<$.length;)if(qt=Z0(this,$),qt==eh){st==4&&(this.s=4,pt(14),f=!1),Ti(this.i,this.l,null,"[Incomplete Response]");break}else if(qt==zm){this.s=4,pt(15),Ti(this.i,this.l,$,"[Invalid Chunk]"),f=!1;break}else Ti(this.i,this.l,qt,null),rh(this,qt);if(qm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),st!=4||$.length!=0||this.h.h||(this.s=1,pt(16),f=!1),this.o=this.o&&f,!f)Ti(this.i,this.l,$,"[Invalid Chunked Response]"),Fr(this),Ws(this);else if(0<$.length&&!this.W){this.W=!0;var it=this.j;it.g==this&&it.ba&&!it.M&&(it.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),uh(it),it.M=!0,pt(11))}}else Ti(this.i,this.l,$,null),rh(this,$);st==4&&Fr(this),this.o&&!this.J&&(st==4?yg(this.j,this):(this.o=!1,Ya(this)))}else gS(this.g),f==400&&0<$.indexOf("Unknown SID")?(this.s=3,pt(12)):(this.s=0,pt(13)),Fr(this),Ws(this)}}}catch{}finally{}};function qm(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function Z0(l,h){var f=l.C,y=h.indexOf(`
`,f);return y==-1?eh:(f=Number(h.substring(f,y)),isNaN(f)?zm:(y+=1,y+f>h.length?eh:(h=h.slice(y,y+f),l.C=y+f,h)))}Bn.prototype.cancel=function(){this.J=!0,Fr(this)};function Ya(l){l.S=Date.now()+l.I,Km(l,l.I)}function Km(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Ks(m(l.ba,l),h)}function nh(l){l.B&&(a.clearTimeout(l.B),l.B=null)}Bn.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(J0(this.i,this.A),this.L!=2&&(qs(),pt(17)),Fr(this),this.s=2,Ws(this)):Km(this,this.S-l)};function Ws(l){l.j.G==0||l.J||yg(l.j,l)}function Fr(l){nh(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,Nm(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function rh(l,h){try{var f=l.j;if(f.G!=0&&(f.g==l||ih(f.h,l))){if(!l.K&&ih(f.h,l)&&f.G==3){try{var y=f.Da.g.parse(h)}catch{y=null}if(Array.isArray(y)&&y.length==3){var b=y;if(b[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<l.F)sl(f),rl(f);else break e;lh(f),pt(18)}}else f.za=b[1],0<f.za-f.T&&37500>b[2]&&f.F&&f.v==0&&!f.C&&(f.C=Ks(m(f.Za,f),6e3));if(1>=Hm(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Ur(f,11)}else if((l.K||f.g==l)&&sl(f),!S(h))for(b=f.Da.g.parse(h),h=0;h<b.length;h++){let ce=b[h];if(f.T=ce[0],ce=ce[1],f.G==2)if(ce[0]=="c"){f.K=ce[1],f.ia=ce[2];const it=ce[3];it!=null&&(f.la=it,f.j.info("VER="+f.la));const st=ce[4];st!=null&&(f.Aa=st,f.j.info("SVER="+f.Aa));const Ri=ce[5];Ri!=null&&typeof Ri=="number"&&0<Ri&&(y=1.5*Ri,f.L=y,f.j.info("backChannelRequestTimeoutMs_="+y)),y=f;const qt=l.g;if(qt){const al=qt.g?qt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(al){var O=y.h;O.g||al.indexOf("spdy")==-1&&al.indexOf("quic")==-1&&al.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(sh(O,O.h),O.h=null))}if(y.D){const ch=qt.g?qt.g.getResponseHeader("X-HTTP-Session-Id"):null;ch&&(y.ya=ch,we(y.I,y.D,ch))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-l.F,f.j.info("Handshake RTT: "+f.R+"ms")),y=f;var $=l;if(y.qa=wg(y,y.J?y.ia:null,y.W),$.K){Qm(y.h,$);var ye=$,Ye=y.L;Ye&&(ye.I=Ye),ye.B&&(nh(ye),Ya(ye)),y.g=$}else mg(y);0<f.i.length&&il(f)}else ce[0]!="stop"&&ce[0]!="close"||Ur(f,7);else f.G==3&&(ce[0]=="stop"||ce[0]=="close"?ce[0]=="stop"?Ur(f,7):ah(f):ce[0]!="noop"&&f.l&&f.l.ta(ce),f.v=0)}}qs(4)}catch{}}var eS=class{constructor(l,h){this.g=l,this.map=h}};function Gm(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Wm(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Hm(l){return l.h?1:l.g?l.g.size:0}function ih(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function sh(l,h){l.g?l.g.add(h):l.h=h}function Qm(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}Gm.prototype.cancel=function(){if(this.i=Ym(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Ym(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const f of l.g.values())h=h.concat(f.D);return h}return D(l.i)}function tS(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var h=[],f=l.length,y=0;y<f;y++)h.push(l[y]);return h}h=[],f=0;for(y in l)h[f++]=l[y];return h}function nS(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var h=[];l=l.length;for(var f=0;f<l;f++)h.push(f);return h}h=[],f=0;for(const y in l)h[f++]=y;return h}}}function Jm(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var f=nS(l),y=tS(l),b=y.length,O=0;O<b;O++)h.call(void 0,y[O],f&&f[O],l)}var Xm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rS(l,h){if(l){l=l.split("&");for(var f=0;f<l.length;f++){var y=l[f].indexOf("="),b=null;if(0<=y){var O=l[f].substring(0,y);b=l[f].substring(y+1)}else O=l[f];h(O,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function jr(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof jr){this.h=l.h,Ja(this,l.j),this.o=l.o,this.g=l.g,Xa(this,l.s),this.l=l.l;var h=l.i,f=new Ys;f.i=h.i,h.g&&(f.g=new Map(h.g),f.h=h.h),Zm(this,f),this.m=l.m}else l&&(h=String(l).match(Xm))?(this.h=!1,Ja(this,h[1]||"",!0),this.o=Hs(h[2]||""),this.g=Hs(h[3]||"",!0),Xa(this,h[4]),this.l=Hs(h[5]||"",!0),Zm(this,h[6]||"",!0),this.m=Hs(h[7]||"")):(this.h=!1,this.i=new Ys(null,this.h))}jr.prototype.toString=function(){var l=[],h=this.j;h&&l.push(Qs(h,eg,!0),":");var f=this.g;return(f||h=="file")&&(l.push("//"),(h=this.o)&&l.push(Qs(h,eg,!0),"@"),l.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&l.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&l.push("/"),l.push(Qs(f,f.charAt(0)=="/"?oS:sS,!0))),(f=this.i.toString())&&l.push("?",f),(f=this.m)&&l.push("#",Qs(f,lS)),l.join("")};function yn(l){return new jr(l)}function Ja(l,h,f){l.j=f?Hs(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function Xa(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function Zm(l,h,f){h instanceof Ys?(l.i=h,uS(l.i,l.h)):(f||(h=Qs(h,aS)),l.i=new Ys(h,l.h))}function we(l,h,f){l.i.set(h,f)}function Za(l){return we(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Hs(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Qs(l,h,f){return typeof l=="string"?(l=encodeURI(l).replace(h,iS),f&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function iS(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var eg=/[#\/\?@]/g,sS=/[#\?:]/g,oS=/[#\?]/g,aS=/[#\?@]/g,lS=/#/g;function Ys(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function zn(l){l.g||(l.g=new Map,l.h=0,l.i&&rS(l.i,function(h,f){l.add(decodeURIComponent(h.replace(/\+/g," ")),f)}))}n=Ys.prototype,n.add=function(l,h){zn(this),this.i=null,l=Si(this,l);var f=this.g.get(l);return f||this.g.set(l,f=[]),f.push(h),this.h+=1,this};function tg(l,h){zn(l),h=Si(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function ng(l,h){return zn(l),h=Si(l,h),l.g.has(h)}n.forEach=function(l,h){zn(this),this.g.forEach(function(f,y){f.forEach(function(b){l.call(h,b,y,this)},this)},this)},n.na=function(){zn(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),f=[];for(let y=0;y<h.length;y++){const b=l[y];for(let O=0;O<b.length;O++)f.push(h[y])}return f},n.V=function(l){zn(this);let h=[];if(typeof l=="string")ng(this,l)&&(h=h.concat(this.g.get(Si(this,l))));else{l=Array.from(this.g.values());for(let f=0;f<l.length;f++)h=h.concat(l[f])}return h},n.set=function(l,h){return zn(this),this.i=null,l=Si(this,l),ng(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},n.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function rg(l,h,f){tg(l,h),0<f.length&&(l.i=null,l.g.set(Si(l,h),D(f)),l.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var f=0;f<h.length;f++){var y=h[f];const O=encodeURIComponent(String(y)),$=this.V(y);for(y=0;y<$.length;y++){var b=O;$[y]!==""&&(b+="="+encodeURIComponent(String($[y]))),l.push(b)}}return this.i=l.join("&")};function Si(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function uS(l,h){h&&!l.j&&(zn(l),l.i=null,l.g.forEach(function(f,y){var b=y.toLowerCase();y!=b&&(tg(this,y),rg(this,b,f))},l)),l.j=h}function cS(l,h){const f=new Gs;if(a.Image){const y=new Image;y.onload=E($n,f,"TestLoadImage: loaded",!0,h,y),y.onerror=E($n,f,"TestLoadImage: error",!1,h,y),y.onabort=E($n,f,"TestLoadImage: abort",!1,h,y),y.ontimeout=E($n,f,"TestLoadImage: timeout",!1,h,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=l}else h(!1)}function hS(l,h){const f=new Gs,y=new AbortController,b=setTimeout(()=>{y.abort(),$n(f,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:y.signal}).then(O=>{clearTimeout(b),O.ok?$n(f,"TestPingServer: ok",!0,h):$n(f,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(b),$n(f,"TestPingServer: error",!1,h)})}function $n(l,h,f,y,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),y(f)}catch{}}function dS(){this.g=new H0}function fS(l,h,f){const y=f||"";try{Jm(l,function(b,O){let $=b;c(b)&&($=Qc(b)),h.push(y+O+"="+encodeURIComponent($))})}catch(b){throw h.push(y+"type="+encodeURIComponent("_badmap")),b}}function el(l){this.l=l.Ub||null,this.j=l.eb||!1}R(el,Yc),el.prototype.g=function(){return new tl(this.l,this.j)},el.prototype.i=function(l){return function(){return l}}({});function tl(l,h){rt.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(tl,rt),n=tl.prototype,n.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,Xs(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Js(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Xs(this)),this.g&&(this.readyState=3,Xs(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ig(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function ig(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Js(this):Xs(this),this.readyState==3&&ig(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,Js(this))},n.Qa=function(l){this.g&&(this.response=l,Js(this))},n.ga=function(){this.g&&Js(this)};function Js(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Xs(l)}n.setRequestHeader=function(l,h){this.u.append(l,h)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var f=h.next();!f.done;)f=f.value,l.push(f[0]+": "+f[1]),f=h.next();return l.join(`\r
`)};function Xs(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(tl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function sg(l){let h="";return k(l,function(f,y){h+=y,h+=":",h+=f,h+=`\r
`}),h}function oh(l,h,f){e:{for(y in f){var y=!1;break e}y=!0}y||(f=sg(f),typeof l=="string"?f!=null&&encodeURIComponent(String(f)):we(l,h,f))}function be(l){rt.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(be,rt);var pS=/^https?$/i,mS=["POST","PUT"];n=be.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,h,f,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Zc.g(),this.v=this.o?Vm(this.o):Vm(Zc),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(O){og(this,O);return}if(l=f||"",f=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var b in y)f.set(b,y[b]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const O of y.keys())f.set(O,y.get(O));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(f.keys()).find(O=>O.toLowerCase()=="content-type"),b=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(mS,h,void 0))||y||b||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[O,$]of f)this.g.setRequestHeader(O,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ug(this),this.u=!0,this.g.send(l),this.u=!1}catch(O){og(this,O)}};function og(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,ag(l),nl(l)}function ag(l){l.A||(l.A=!0,ft(l,"complete"),ft(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,ft(this,"complete"),ft(this,"abort"),nl(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),nl(this,!0)),be.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?lg(this):this.bb())},n.bb=function(){lg(this)};function lg(l){if(l.h&&typeof o<"u"&&(!l.v[1]||_n(l)!=4||l.Z()!=2)){if(l.u&&_n(l)==4)km(l.Ea,0,l);else if(ft(l,"readystatechange"),_n(l)==4){l.h=!1;try{const $=l.Z();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var f;if(!(f=h)){var y;if(y=$===0){var b=String(l.D).match(Xm)[1]||null;!b&&a.self&&a.self.location&&(b=a.self.location.protocol.slice(0,-1)),y=!pS.test(b?b.toLowerCase():"")}f=y}if(f)ft(l,"complete"),ft(l,"success");else{l.m=6;try{var O=2<_n(l)?l.g.statusText:""}catch{O=""}l.l=O+" ["+l.Z()+"]",ag(l)}}finally{nl(l)}}}}function nl(l,h){if(l.g){ug(l);const f=l.g,y=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||ft(l,"ready");try{f.onreadystatechange=y}catch{}}}function ug(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function _n(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<_n(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),W0(h)}};function cg(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function gS(l){const h={};l=(l.g&&2<=_n(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<l.length;y++){if(S(l[y]))continue;var f=x(l[y]);const b=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const O=h[b]||[];h[b]=O,O.push(f)}_(h,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Zs(l,h,f){return f&&f.internalChannelParams&&f.internalChannelParams[l]||h}function hg(l){this.Aa=0,this.i=[],this.j=new Gs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Zs("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Zs("baseRetryDelayMs",5e3,l),this.cb=Zs("retryDelaySeedMs",1e4,l),this.Wa=Zs("forwardChannelMaxRetries",2,l),this.wa=Zs("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Gm(l&&l.concurrentRequestLimit),this.Da=new dS,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=hg.prototype,n.la=8,n.G=1,n.connect=function(l,h,f,y){pt(0),this.W=l,this.H=h||{},f&&y!==void 0&&(this.H.OSID=f,this.H.OAID=y),this.F=this.X,this.I=wg(this,null,this.W),il(this)};function ah(l){if(dg(l),l.G==3){var h=l.U++,f=yn(l.I);if(we(f,"SID",l.K),we(f,"RID",h),we(f,"TYPE","terminate"),eo(l,f),h=new Bn(l,l.j,h),h.L=2,h.v=Za(yn(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!f&&a.Image&&(new Image().src=h.v,f=!0),f||(h.g=Eg(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Ya(h)}vg(l)}function rl(l){l.g&&(uh(l),l.g.cancel(),l.g=null)}function dg(l){rl(l),l.u&&(a.clearTimeout(l.u),l.u=null),sl(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function il(l){if(!Wm(l.h)&&!l.s){l.s=!0;var h=l.Ga;de||ne(),U||(de(),U=!0),Z.add(h,l),l.B=0}}function yS(l,h){return Hm(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Ks(m(l.Ga,l,h),_g(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const b=new Bn(this,this.j,l);let O=this.o;if(this.S&&(O?(O=g(O),T(O,this.S)):O=this.S),this.m!==null||this.O||(b.H=O,O=null),this.P)e:{for(var h=0,f=0;f<this.i.length;f++){t:{var y=this.i[f];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(h+=y,4096<h){h=f;break e}if(h===4096||f===this.i.length-1){h=f+1;break e}}h=1e3}else h=1e3;h=pg(this,b,h),f=yn(this.I),we(f,"RID",l),we(f,"CVER",22),this.D&&we(f,"X-HTTP-Session-Id",this.D),eo(this,f),O&&(this.O?h="headers="+encodeURIComponent(String(sg(O)))+"&"+h:this.m&&oh(f,this.m,O)),sh(this.h,b),this.Ua&&we(f,"TYPE","init"),this.P?(we(f,"$req",h),we(f,"SID","null"),b.T=!0,th(b,f,null)):th(b,f,h),this.G=2}}else this.G==3&&(l?fg(this,l):this.i.length==0||Wm(this.h)||fg(this))};function fg(l,h){var f;h?f=h.l:f=l.U++;const y=yn(l.I);we(y,"SID",l.K),we(y,"RID",f),we(y,"AID",l.T),eo(l,y),l.m&&l.o&&oh(y,l.m,l.o),f=new Bn(l,l.j,f,l.B+1),l.m===null&&(f.H=l.o),h&&(l.i=h.D.concat(l.i)),h=pg(l,f,1e3),f.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),sh(l.h,f),th(f,y,h)}function eo(l,h){l.H&&k(l.H,function(f,y){we(h,y,f)}),l.l&&Jm({},function(f,y){we(h,y,f)})}function pg(l,h,f){f=Math.min(l.i.length,f);var y=l.l?m(l.l.Na,l.l,l):null;e:{var b=l.i;let O=-1;for(;;){const $=["count="+f];O==-1?0<f?(O=b[0].g,$.push("ofs="+O)):O=0:$.push("ofs="+O);let ye=!0;for(let Ye=0;Ye<f;Ye++){let ce=b[Ye].g;const it=b[Ye].map;if(ce-=O,0>ce)O=Math.max(0,b[Ye].g-100),ye=!1;else try{fS(it,$,"req"+ce+"_")}catch{y&&y(it)}}if(ye){y=$.join("&");break e}}}return l=l.i.splice(0,f),h.D=l,y}function mg(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;de||ne(),U||(de(),U=!0),Z.add(h,l),l.v=0}}function lh(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Ks(m(l.Fa,l),_g(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,gg(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Ks(m(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,pt(10),rl(this),gg(this))};function uh(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function gg(l){l.g=new Bn(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=yn(l.qa);we(h,"RID","rpc"),we(h,"SID",l.K),we(h,"AID",l.T),we(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&we(h,"TO",l.ja),we(h,"TYPE","xmlhttp"),eo(l,h),l.m&&l.o&&oh(h,l.m,l.o),l.L&&(l.g.I=l.L);var f=l.g;l=l.ia,f.L=1,f.v=Za(yn(h)),f.m=null,f.P=!0,$m(f,l)}n.Za=function(){this.C!=null&&(this.C=null,rl(this),lh(this),pt(19))};function sl(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function yg(l,h){var f=null;if(l.g==h){sl(l),uh(l),l.g=null;var y=2}else if(ih(l.h,h))f=h.D,Qm(l.h,h),y=1;else return;if(l.G!=0){if(h.o)if(y==1){f=h.m?h.m.length:0,h=Date.now()-h.F;var b=l.B;y=Wa(),ft(y,new jm(y,f)),il(l)}else mg(l);else if(b=h.s,b==3||b==0&&0<h.X||!(y==1&&yS(l,h)||y==2&&lh(l)))switch(f&&0<f.length&&(h=l.h,h.i=h.i.concat(f)),b){case 1:Ur(l,5);break;case 4:Ur(l,10);break;case 3:Ur(l,6);break;default:Ur(l,2)}}}function _g(l,h){let f=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(f*=2),f*h}function Ur(l,h){if(l.j.info("Error code "+h),h==2){var f=m(l.fb,l),y=l.Xa;const b=!y;y=new jr(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Ja(y,"https"),Za(y),b?cS(y.toString(),f):hS(y.toString(),f)}else pt(2);l.G=0,l.l&&l.l.sa(h),vg(l),dg(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),pt(2)):(this.j.info("Failed to ping google.com"),pt(1))};function vg(l){if(l.G=0,l.ka=[],l.l){const h=Ym(l.h);(h.length!=0||l.i.length!=0)&&(L(l.ka,h),L(l.ka,l.i),l.h.i.length=0,D(l.i),l.i.length=0),l.l.ra()}}function wg(l,h,f){var y=f instanceof jr?yn(f):new jr(f);if(y.g!="")h&&(y.g=h+"."+y.g),Xa(y,y.s);else{var b=a.location;y=b.protocol,h=h?h+"."+b.hostname:b.hostname,b=+b.port;var O=new jr(null);y&&Ja(O,y),h&&(O.g=h),b&&Xa(O,b),f&&(O.l=f),y=O}return f=l.D,h=l.ya,f&&h&&we(y,f,h),we(y,"VER",l.la),eo(l,y),y}function Eg(l,h,f){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new be(new el({eb:f})):new be(l.pa),h.Ha(l.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ig(){}n=Ig.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ol(){}ol.prototype.g=function(l,h){return new Ct(l,h)};function Ct(l,h){rt.call(this),this.g=new hg(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!S(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!S(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new Ai(this)}R(Ct,rt),Ct.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ct.prototype.close=function(){ah(this.g)},Ct.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var f={};f.__data__=l,l=f}else this.u&&(f={},f.__data__=Qc(l),l=f);h.i.push(new eS(h.Ya++,l)),h.G==3&&il(h)},Ct.prototype.N=function(){this.g.l=null,delete this.j,ah(this.g),delete this.g,Ct.aa.N.call(this)};function Tg(l){Jc.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const f in h){l=f;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}R(Tg,Jc);function Sg(){Xc.call(this),this.status=1}R(Sg,Xc);function Ai(l){this.g=l}R(Ai,Ig),Ai.prototype.ua=function(){ft(this.g,"a")},Ai.prototype.ta=function(l){ft(this.g,new Tg(l))},Ai.prototype.sa=function(l){ft(this.g,new Sg)},Ai.prototype.ra=function(){ft(this.g,"b")},ol.prototype.createWebChannel=ol.prototype.g,Ct.prototype.send=Ct.prototype.o,Ct.prototype.open=Ct.prototype.m,Ct.prototype.close=Ct.prototype.close,XE=function(){return new ol},JE=function(){return Wa()},YE=Mr,Yd={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ha.NO_ERROR=0,Ha.TIMEOUT=8,Ha.HTTP_ERROR=6,Wl=Ha,Um.COMPLETE="complete",QE=Um,Om.EventType=$s,$s.OPEN="a",$s.CLOSE="b",$s.ERROR="c",$s.MESSAGE="d",rt.prototype.listen=rt.prototype.K,To=Om,be.prototype.listenOnce=be.prototype.L,be.prototype.getLastError=be.prototype.Ka,be.prototype.getLastErrorCode=be.prototype.Ba,be.prototype.getStatus=be.prototype.Z,be.prototype.getResponseJson=be.prototype.Oa,be.prototype.getResponseText=be.prototype.oa,be.prototype.send=be.prototype.ea,be.prototype.setWithCredentials=be.prototype.Ha,HE=be}).apply(typeof Al<"u"?Al:typeof self<"u"?self:typeof window<"u"?window:{});const Ky="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ut.UNAUTHENTICATED=new ut(null),ut.GOOGLE_CREDENTIALS=new ut("google-credentials-uid"),ut.FIRST_PARTY=new ut("first-party-uid"),ut.MOCK_USER=new ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Os="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const li=new yp("@firebase/firestore");function bi(){return li.logLevel}function j(n,...e){if(li.logLevel<=oe.DEBUG){const t=e.map(wp);li.debug(`Firestore (${Os}): ${n}`,...t)}}function Le(n,...e){if(li.logLevel<=oe.ERROR){const t=e.map(wp);li.error(`Firestore (${Os}): ${n}`,...t)}}function ua(n,...e){if(li.logLevel<=oe.WARN){const t=e.map(wp);li.warn(`Firestore (${Os}): ${n}`,...t)}}function wp(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K(n="Unexpected state"){const e=`FIRESTORE (${Os}) INTERNAL ASSERTION FAILED: `+n;throw Le(e),new Error(e)}function H(n,e){n||K()}function W(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class z extends jn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class AC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ut.UNAUTHENTICATED))}shutdown(){}}class RC{constructor(e){this.t=e,this.currentUser=ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){H(this.o===void 0);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let s=new Jt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Jt,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const u=s;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},a=u=>{j("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(j("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Jt)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(j("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(H(typeof r.accessToken=="string"),new SC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return H(e===null||typeof e=="string"),new ut(e)}}class PC{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=ut.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class CC{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new PC(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class xC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class kC{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){H(this.o===void 0);const r=s=>{s.error!=null&&j("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,j("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{j("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):j("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(H(typeof t.token=="string"),this.R=t.token,new xC(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=DC(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function ee(n,e){return n<e?-1:n>e?1:0}function gs(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function eI(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new z(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new z(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new z(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new z(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ke.fromMillis(Date.now())}static fromDate(e){return ke.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new ke(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Y(e)}static min(){return new Y(new ke(0,0))}static max(){return new Y(new ke(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,t,r){t===void 0?t=0:t>e.length&&K(),r===void 0?r=e.length-t:r>e.length-t&&K(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return ca.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ca?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class he extends ca{construct(e,t,r){return new he(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new z(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new he(t)}static emptyPath(){return new he([])}}const bC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ce extends ca{construct(e,t,r){return new Ce(e,t,r)}static isValidIdentifier(e){return bC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ce.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ce(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new z(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new z(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new z(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new z(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ce(t)}static emptyPath(){return new Ce([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.path=e}static fromPath(e){return new q(he.fromString(e))}static fromName(e){return new q(he.fromString(e).popFirst(5))}static empty(){return new q(he.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&he.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return he.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new q(new he(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Jd(n){return n.fields.find(e=>e.kind===2)}function Kr(n){return n.fields.filter(e=>e.kind!==2)}Du.UNKNOWN_ID=-1;class Hl{constructor(e,t){this.fieldPath=e,this.kind=t}}class ha{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ha(0,Ot.min())}}function tI(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Y.fromTimestamp(r===1e9?new ke(t+1,0):new ke(t,r));return new Ot(i,q.empty(),e)}function nI(n){return new Ot(n.readTime,n.key,-1)}class Ot{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Ot(Y.min(),q.empty(),-1)}static max(){return new Ot(Y.max(),q.empty(),-1)}}function Ep(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=q.comparator(n.documentKey,e.documentKey),t!==0?t:ee(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class iI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kr(n){if(n.code!==F.FAILED_PRECONDITION||n.message!==rI)throw n;j("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&K(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new N((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof N?t:N.resolve(t)}catch(t){return N.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):N.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):N.reject(t)}static resolve(e){return new N((t,r)=>{t(e)})}static reject(e){return new N((t,r)=>{r(e)})}static waitFor(e){return new N((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},u=>r(u))}),o=!0,s===i&&t()})}static or(e){let t=N.resolve(!1);for(const r of e)t=t.next(i=>i?N.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new N((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let u=0;u<s;u++){const c=u;t(e[c]).next(d=>{o[c]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new N((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Jt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Lo(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Ip(r.target.error);this.V.reject(new Lo(e,i))}}static open(e,t,r,i){try{return new gc(t,e.transaction(i,r))}catch(s){throw new Lo(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(j("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new VC(t)}}class _r{constructor(e,t,r){this.name=e,this.version=t,this.p=r,_r.S(qe())===12.2&&Le("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return j("SimpleDb","Removing database:",e),Gr(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!BE())return!1;if(_r.v())return!0;const e=qe(),t=_r.S(e),r=0<t&&t<10,i=sI(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(j("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;t(o)},i.onblocked=()=>{r(new Lo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new z(F.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new z(F.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Lo(e,o))},i.onupgradeneeded=s=>{j("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{j("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=gc.open(this.db,e,s?"readonly":"readwrite",r),u=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),N.reject(c))).toPromise();return u.catch(()=>{}),await a.m,u}catch(a){const u=a,c=u.name!=="FirebaseError"&&o<3;if(j("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function sI(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class NC{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Gr(this.B.delete())}}class Lo extends z{constructor(e,t){super(F.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Dr(n){return n.name==="IndexedDbTransactionError"}class VC{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(j("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(j("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Gr(r)}add(e){return j("SimpleDb","ADD",this.store.name,e,e),Gr(this.store.add(e))}get(e){return Gr(this.store.get(e)).next(t=>(t===void 0&&(t=null),j("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return j("SimpleDb","DELETE",this.store.name,e),Gr(this.store.delete(e))}count(){return j("SimpleDb","COUNT",this.store.name),Gr(this.store.count())}U(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new N((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(a,u)=>{o.push(u)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new N((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){j("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.W(i,t)}Y(e){const t=this.cursor({});return new N((r,i)=>{t.onerror=s=>{const o=Ip(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new N((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const u=new NC(a),c=t(a.primaryKey,a.value,u);if(c instanceof N){const d=c.catch(p=>(u.done(),N.reject(p)));r.push(d)}u.isDone?i():u.K===null?a.continue():a.continue(u.K)}}).next(()=>N.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Gr(n){return new N((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=Ip(r.target.error);t(i)}})}let Gy=!1;function Ip(n){const e=_r.S(qe());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new z("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Gy||(Gy=!0,setTimeout(()=>{throw r},0)),r}}return n}class OC{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){j("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{j("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){Dr(t)?j("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await kr(t)}await this.X(6e4)})}}class LC{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let i=t,s=!0;return N.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return j("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(j("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{const o=nI(s);Ep(o,r)>0&&(r=o)}),new Ot(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Tt.oe=-1;function ba(n){return n==null}function da(n){return n===0&&1/n==-1/0}function oI(n){return typeof n=="number"&&Number.isInteger(n)&&!da(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Wy(e)),e=MC(n.get(t),e);return Wy(e)}function MC(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function Wy(n){return n+""}function sn(n){const e=n.length;if(H(e>=2),e===2)return H(n.charAt(0)===""&&n.charAt(1)===""),he.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const o=n.indexOf("",s);switch((o<0||o>t)&&K(),n.charAt(o+1)){case"":const a=n.substring(s,o);let u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:K()}s=o+2}return new he(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ql(n,e){return[n,yt(e)]}function aI(n,e,t){return[n,yt(e),t]}const FC={},jC=["prefixPath","collectionGroup","readTime","documentId"],UC=["prefixPath","collectionGroup","documentId"],BC=["collectionGroup","readTime","prefixPath","documentId"],zC=["canonicalId","targetId"],$C=["targetId","path"],qC=["path","targetId"],KC=["collectionId","parent"],GC=["indexId","uid"],WC=["uid","sequenceNumber"],HC=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],QC=["indexId","uid","orderedDocumentKey"],YC=["userId","collectionPath","documentId"],JC=["userId","collectionPath","largestBatchId"],XC=["userId","collectionGroup","largestBatchId"],lI=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ZC=[...lI,"documentOverlays"],uI=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],cI=uI,Tp=[...cI,"indexConfiguration","indexState","indexEntries"],ex=Tp,tx=[...Tp,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd extends iI{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function Ke(n,e){const t=W(n);return _r.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qy(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function vi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function hI(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e,t){this.comparator=e,this.root=t||Xe.EMPTY}insert(e,t){return new ve(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Xe.BLACK,null,null))}remove(e){return new ve(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xe.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rl(this.root,e,this.comparator,!0)}}class Rl{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xe{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Xe.RED,this.left=i??Xe.EMPTY,this.right=s??Xe.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new Xe(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Xe.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Xe.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw K();const e=this.left.check();if(e!==this.right.check())throw K();return e+(this.isRed()?0:1)}}Xe.EMPTY=null,Xe.RED=!0,Xe.BLACK=!1;Xe.EMPTY=new class{constructor(){this.size=0}get key(){throw K()}get value(){throw K()}get color(){throw K()}get left(){throw K()}get right(){throw K()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Xe(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e){this.comparator=e,this.data=new ve(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Yy(this.data.getIterator())}getIteratorFrom(e){return new Yy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof me)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new me(this.comparator);return t.data=e,t}}class Yy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ci(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e){this.fields=e,e.sort(Ce.comparator)}static empty(){return new St([])}unionWith(e){let t=new me(Ce.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new St(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return gs(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new dI("Invalid base64 string: "+s):s}}(e);return new Me(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Me(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Me.EMPTY_BYTE_STRING=new Me("");const nx=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function On(n){if(H(!!n),typeof n=="string"){let e=0;const t=nx.exec(n);if(H(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Te(n.seconds),nanos:Te(n.nanos)}}function Te(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Tr(n){return typeof n=="string"?Me.fromBase64String(n):Me.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sp(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Ap(n){const e=n.mapValue.fields.__previous_value__;return Sp(e)?Ap(e):e}function fa(n){const e=On(n.mapValue.fields.__local_write_time__.timestampValue);return new ke(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{constructor(e,t,r,i,s,o,a,u,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}}class ui{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new ui("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ui&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Yl={nullValue:"NULL_VALUE"};function ci(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Sp(n)?4:fI(n)?9007199254740991:yc(n)?10:11:K()}function hn(n,e){if(n===e)return!0;const t=ci(n);if(t!==ci(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return fa(n).isEqual(fa(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=On(i.timestampValue),a=On(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Tr(i.bytesValue).isEqual(Tr(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Te(i.geoPointValue.latitude)===Te(s.geoPointValue.latitude)&&Te(i.geoPointValue.longitude)===Te(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Te(i.integerValue)===Te(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Te(i.doubleValue),a=Te(s.doubleValue);return o===a?da(o)===da(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return gs(n.arrayValue.values||[],e.arrayValue.values||[],hn);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Qy(o)!==Qy(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!hn(o[u],a[u])))return!1;return!0}(n,e);default:return K()}}function pa(n,e){return(n.values||[]).find(t=>hn(t,e))!==void 0}function Sr(n,e){if(n===e)return 0;const t=ci(n),r=ci(e);if(t!==r)return ee(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ee(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Te(s.integerValue||s.doubleValue),u=Te(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,e);case 3:return Jy(n.timestampValue,e.timestampValue);case 4:return Jy(fa(n),fa(e));case 5:return ee(n.stringValue,e.stringValue);case 6:return function(s,o){const a=Tr(s),u=Tr(o);return a.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){const d=ee(a[c],u[c]);if(d!==0)return d}return ee(a.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=ee(Te(s.latitude),Te(o.latitude));return a!==0?a:ee(Te(s.longitude),Te(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Xy(n.arrayValue,e.arrayValue);case 10:return function(s,o){var a,u,c,d;const p=s.fields||{},m=o.fields||{},E=(a=p.value)===null||a===void 0?void 0:a.arrayValue,R=(u=m.value)===null||u===void 0?void 0:u.arrayValue,D=ee(((c=E==null?void 0:E.values)===null||c===void 0?void 0:c.length)||0,((d=R==null?void 0:R.values)===null||d===void 0?void 0:d.length)||0);return D!==0?D:Xy(E,R)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===sr.mapValue&&o===sr.mapValue)return 0;if(s===sr.mapValue)return 1;if(o===sr.mapValue)return-1;const a=s.fields||{},u=Object.keys(a),c=o.fields||{},d=Object.keys(c);u.sort(),d.sort();for(let p=0;p<u.length&&p<d.length;++p){const m=ee(u[p],d[p]);if(m!==0)return m;const E=Sr(a[u[p]],c[d[p]]);if(E!==0)return E}return ee(u.length,d.length)}(n.mapValue,e.mapValue);default:throw K()}}function Jy(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ee(n,e);const t=On(n),r=On(e),i=ee(t.seconds,r.seconds);return i!==0?i:ee(t.nanos,r.nanos)}function Xy(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Sr(t[i],r[i]);if(s)return s}return ee(t.length,r.length)}function ys(n){return Zd(n)}function Zd(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=On(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Tr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return q.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=Zd(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Zd(t.fields[o])}`;return i+"}"}(n.mapValue):K()}function ma(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ef(n){return!!n&&"integerValue"in n}function ga(n){return!!n&&"arrayValue"in n}function Zy(n){return!!n&&"nullValue"in n}function e_(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Jl(n){return!!n&&"mapValue"in n}function yc(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Mo(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return vi(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Mo(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Mo(n.arrayValue.values[t]);return e}return Object.assign({},n)}function fI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const pI={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function ix(n){return"nullValue"in n?Yl:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ma(ui.empty(),q.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?yc(n)?pI:{mapValue:{}}:K()}function sx(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ma(ui.empty(),q.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?pI:"mapValue"in n?yc(n)?{mapValue:{}}:sr:K()}function t_(n,e){const t=Sr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function n_(n,e){const t=Sr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e){this.value=e}static empty(){return new Ze({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Jl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Mo(t)}setAll(e){let t=Ce.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Mo(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Jl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return hn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Jl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){vi(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Ze(Mo(this.value))}}function mI(n){const e=[];return vi(n.fields,(t,r)=>{const i=new Ce([t]);if(Jl(r)){const s=mI(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new St(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ae(e,0,Y.min(),Y.min(),Y.min(),Ze.empty(),0)}static newFoundDocument(e,t,r,i){return new Ae(e,1,t,Y.min(),r,i,0)}static newNoDocument(e,t){return new Ae(e,2,t,Y.min(),Y.min(),Ze.empty(),0)}static newUnknownDocument(e,t){return new Ae(e,3,t,Y.min(),Y.min(),Ze.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Y.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ze.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ze.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Y.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ae&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ae(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e,t){this.position=e,this.inclusive=t}}function r_(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=q.comparator(q.fromName(o.referenceValue),t.key):r=Sr(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function i_(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!hn(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e,t="asc"){this.field=e,this.dir=t}}function ox(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{}class ae extends gI{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new ax(e,t,r):t==="array-contains"?new cx(e,r):t==="in"?new II(e,r):t==="not-in"?new hx(e,r):t==="array-contains-any"?new dx(e,r):new ae(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new lx(e,r):new ux(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Sr(t,this.value)):t!==null&&ci(this.value)===ci(t)&&this.matchesComparison(Sr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return K()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fe extends gI{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new fe(e,t)}matches(e){return vs(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function vs(n){return n.op==="and"}function tf(n){return n.op==="or"}function Rp(n){return yI(n)&&vs(n)}function yI(n){for(const e of n.filters)if(e instanceof fe)return!1;return!0}function nf(n){if(n instanceof ae)return n.field.canonicalString()+n.op.toString()+ys(n.value);if(Rp(n))return n.filters.map(e=>nf(e)).join(",");{const e=n.filters.map(t=>nf(t)).join(",");return`${n.op}(${e})`}}function _I(n,e){return n instanceof ae?function(r,i){return i instanceof ae&&r.op===i.op&&r.field.isEqual(i.field)&&hn(r.value,i.value)}(n,e):n instanceof fe?function(r,i){return i instanceof fe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&_I(o,i.filters[a]),!0):!1}(n,e):void K()}function vI(n,e){const t=n.filters.concat(e);return fe.create(t,n.op)}function wI(n){return n instanceof ae?function(t){return`${t.field.canonicalString()} ${t.op} ${ys(t.value)}`}(n):n instanceof fe?function(t){return t.op.toString()+" {"+t.getFilters().map(wI).join(" ,")+"}"}(n):"Filter"}class ax extends ae{constructor(e,t,r){super(e,t,r),this.key=q.fromName(r.referenceValue)}matches(e){const t=q.comparator(e.key,this.key);return this.matchesComparison(t)}}class lx extends ae{constructor(e,t){super(e,"in",t),this.keys=EI("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class ux extends ae{constructor(e,t){super(e,"not-in",t),this.keys=EI("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function EI(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>q.fromName(r.referenceValue))}class cx extends ae{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ga(t)&&pa(t.arrayValue,this.value)}}class II extends ae{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&pa(this.value.arrayValue,t)}}class hx extends ae{constructor(e,t){super(e,"not-in",t)}matches(e){if(pa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!pa(this.value.arrayValue,t)}}class dx extends ae{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ga(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>pa(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fx{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function rf(n,e=null,t=[],r=[],i=null,s=null,o=null){return new fx(n,e,t,r,i,s,o)}function hi(n){const e=W(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>nf(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ba(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ys(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ys(r)).join(",")),e.ue=t}return e.ue}function Na(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!ox(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!_I(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!i_(n.startAt,e.startAt)&&i_(n.endAt,e.endAt)}function bu(n){return q.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Nu(n,e){return n.filters.filter(t=>t instanceof ae&&t.field.isEqual(e))}function s_(n,e,t){let r=Yl,i=!0;for(const s of Nu(n,e)){let o=Yl,a=!0;switch(s.op){case"<":case"<=":o=ix(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Yl}t_({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];t_({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function o_(n,e,t){let r=sr,i=!0;for(const s of Nu(n,e)){let o=sr,a=!0;switch(s.op){case">=":case">":o=sx(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=sr}n_({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];n_({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function TI(n,e,t,r,i,s,o,a){return new Ls(n,e,t,r,i,s,o,a)}function Va(n){return new Ls(n)}function a_(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function SI(n){return n.collectionGroup!==null}function Fo(n){const e=W(n);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new me(Ce.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new ya(s,r))}),t.has(Ce.keyField().canonicalString())||e.ce.push(new ya(Ce.keyField(),r))}return e.ce}function Nt(n){const e=W(n);return e.le||(e.le=px(e,Fo(n))),e.le}function px(n,e){if(n.limitType==="F")return rf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new ya(i.field,s)});const t=n.endAt?new _s(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new _s(n.startAt.position,n.startAt.inclusive):null;return rf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function sf(n,e){const t=n.filters.concat([e]);return new Ls(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function of(n,e,t){return new Ls(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function _c(n,e){return Na(Nt(n),Nt(e))&&n.limitType===e.limitType}function AI(n){return`${hi(Nt(n))}|lt:${n.limitType}`}function Ni(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>wI(i)).join(", ")}]`),ba(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>ys(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>ys(i)).join(",")),`Target(${r})`}(Nt(n))}; limitType=${n.limitType})`}function Oa(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):q.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of Fo(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,u){const c=r_(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,Fo(r),i)||r.endAt&&!function(o,a,u){const c=r_(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,Fo(r),i))}(n,e)}function RI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function PI(n){return(e,t)=>{let r=!1;for(const i of Fo(n)){const s=mx(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function mx(n,e,t){const r=n.field.isKeyField()?q.comparator(e.key,t.key):function(s,o,a){const u=o.data.field(s),c=a.data.field(s);return u!==null&&c!==null?Sr(u,c):K()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return K()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){vi(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return hI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gx=new ve(q.comparator);function Dt(){return gx}const CI=new ve(q.comparator);function So(...n){let e=CI;for(const t of n)e=e.insert(t.key,t);return e}function xI(n){let e=CI;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function on(){return jo()}function kI(){return jo()}function jo(){return new br(n=>n.toString(),(n,e)=>n.isEqual(e))}const yx=new ve(q.comparator),_x=new me(q.comparator);function re(...n){let e=_x;for(const t of n)e=e.add(t);return e}const vx=new me(ee);function Pp(){return vx}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:da(e)?"-0":e}}function DI(n){return{integerValue:""+n}}function wx(n,e){return oI(e)?DI(e):Cp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(){this._=void 0}}function Ex(n,e,t){return n instanceof ws?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Sp(s)&&(s=Ap(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Es?NI(n,e):n instanceof Is?VI(n,e):function(i,s){const o=bI(i,s),a=l_(o)+l_(i.Pe);return ef(o)&&ef(i.Pe)?DI(a):Cp(i.serializer,a)}(n,e)}function Ix(n,e,t){return n instanceof Es?NI(n,e):n instanceof Is?VI(n,e):t}function bI(n,e){return n instanceof _a?function(r){return ef(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class ws extends vc{}class Es extends vc{constructor(e){super(),this.elements=e}}function NI(n,e){const t=OI(e);for(const r of n.elements)t.some(i=>hn(i,r))||t.push(r);return{arrayValue:{values:t}}}class Is extends vc{constructor(e){super(),this.elements=e}}function VI(n,e){let t=OI(e);for(const r of n.elements)t=t.filter(i=>!hn(i,r));return{arrayValue:{values:t}}}class _a extends vc{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function l_(n){return Te(n.integerValue||n.doubleValue)}function OI(n){return ga(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{constructor(e,t){this.field=e,this.transform=t}}function Tx(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Es&&i instanceof Es||r instanceof Is&&i instanceof Is?gs(r.elements,i.elements,hn):r instanceof _a&&i instanceof _a?hn(r.Pe,i.Pe):r instanceof ws&&i instanceof ws}(n.transform,e.transform)}class Sx{constructor(e,t){this.version=e,this.transformResults=t}}class ze{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ze}static exists(e){return new ze(void 0,e)}static updateTime(e){return new ze(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Xl(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class wc{}function MI(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ec(n.key,ze.none()):new Ms(n.key,n.data,ze.none());{const t=n.data,r=Ze.empty();let i=new me(Ce.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Un(n.key,r,new St(i.toArray()),ze.none())}}function Ax(n,e,t){n instanceof Ms?function(i,s,o){const a=i.value.clone(),u=c_(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Un?function(i,s,o){if(!Xl(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=c_(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(FI(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Uo(n,e,t,r){return n instanceof Ms?function(s,o,a,u){if(!Xl(s.precondition,o))return a;const c=s.value.clone(),d=h_(s.fieldTransforms,u,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof Un?function(s,o,a,u){if(!Xl(s.precondition,o))return a;const c=h_(s.fieldTransforms,u,o),d=o.data;return d.setAll(FI(s)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(n,e,t,r):function(s,o,a){return Xl(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function Rx(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=bI(r.transform,i||null);s!=null&&(t===null&&(t=Ze.empty()),t.set(r.field,s))}return t||null}function u_(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&gs(r,i,(s,o)=>Tx(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ms extends wc{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Un extends wc{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function FI(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function c_(n,e,t){const r=new Map;H(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,Ix(o,a,t[i]))}return r}function h_(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,Ex(s,o,e))}return r}class Ec extends wc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class xp extends wc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&Ax(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Uo(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Uo(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=kI();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const u=MI(o,a);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Y.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),re())}isEqual(e){return this.batchId===e.batchId&&gs(this.mutations,e.mutations,(t,r)=>u_(t,r))&&gs(this.baseMutations,e.baseMutations,(t,r)=>u_(t,r))}}class Dp{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){H(e.mutations.length===r.length);let i=function(){return yx}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Dp(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Px{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fe,le;function jI(n){switch(n){default:return K();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function UI(n){if(n===void 0)return Le("GRPC error has no .code"),F.UNKNOWN;switch(n){case Fe.OK:return F.OK;case Fe.CANCELLED:return F.CANCELLED;case Fe.UNKNOWN:return F.UNKNOWN;case Fe.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case Fe.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case Fe.INTERNAL:return F.INTERNAL;case Fe.UNAVAILABLE:return F.UNAVAILABLE;case Fe.UNAUTHENTICATED:return F.UNAUTHENTICATED;case Fe.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case Fe.NOT_FOUND:return F.NOT_FOUND;case Fe.ALREADY_EXISTS:return F.ALREADY_EXISTS;case Fe.PERMISSION_DENIED:return F.PERMISSION_DENIED;case Fe.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case Fe.ABORTED:return F.ABORTED;case Fe.OUT_OF_RANGE:return F.OUT_OF_RANGE;case Fe.UNIMPLEMENTED:return F.UNIMPLEMENTED;case Fe.DATA_LOSS:return F.DATA_LOSS;default:return K()}}(le=Fe||(Fe={}))[le.OK=0]="OK",le[le.CANCELLED=1]="CANCELLED",le[le.UNKNOWN=2]="UNKNOWN",le[le.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",le[le.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",le[le.NOT_FOUND=5]="NOT_FOUND",le[le.ALREADY_EXISTS=6]="ALREADY_EXISTS",le[le.PERMISSION_DENIED=7]="PERMISSION_DENIED",le[le.UNAUTHENTICATED=16]="UNAUTHENTICATED",le[le.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",le[le.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",le[le.ABORTED=10]="ABORTED",le[le.OUT_OF_RANGE=11]="OUT_OF_RANGE",le[le.UNIMPLEMENTED=12]="UNIMPLEMENTED",le[le.INTERNAL=13]="INTERNAL",le[le.UNAVAILABLE=14]="UNAVAILABLE",le[le.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cx(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xx=new ti([4294967295,4294967295],0);function d_(n){const e=Cx().encode(n),t=new WE;return t.update(e),new Uint8Array(t.digest())}function f_(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ti([t,r],0),new ti([i,s],0)]}class Np{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ao(`Invalid padding: ${t}`);if(r<0)throw new Ao(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ao(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ao(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=ti.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(ti.fromNumber(r)));return i.compare(xx)===1&&(i=new ti([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=d_(e),[r,i]=f_(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Np(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=d_(e),[r,i]=f_(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Ao extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Ma.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new La(Y.min(),i,new ve(ee),Dt(),re())}}class Ma{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ma(r,t,re(),re(),re())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}}class BI{constructor(e,t){this.targetId=e,this.me=t}}class zI{constructor(e,t,r=Me.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class p_{constructor(){this.fe=0,this.ge=g_(),this.pe=Me.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=re(),t=re(),r=re();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:K()}}),new Ma(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=g_()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,H(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class kx{constructor(e){this.Le=e,this.Be=new Map,this.ke=Dt(),this.qe=m_(),this.Qe=new ve(ee)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:K()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,r=e.me.count,i=this.Je(t);if(i){const s=i.target;if(bu(s))if(r===0){const o=new q(s.path);this.Ue(t,o,Ae.newNoDocument(o,Y.min()))}else H(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),u=a?this.Xe(a,e,o):1;if(u!==0){this.je(t);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,c)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,a;try{o=Tr(r).toUint8Array()}catch(u){if(u instanceof dI)return ua("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new Np(o,i,s)}catch(u){return ua(u instanceof Ao?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&bu(a.target)){const u=new q(a.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,Ae.newNoDocument(u,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=re();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{const c=this.Je(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new La(e,t,this.Qe,this.ke,r);return this.ke=Dt(),this.qe=m_(),this.Qe=new ve(ee),i}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new p_,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new me(ee),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||j("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new p_),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function m_(){return new ve(q.comparator)}function g_(){return new ve(q.comparator)}const Dx={asc:"ASCENDING",desc:"DESCENDING"},bx={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Nx={and:"AND",or:"OR"};class Vx{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function af(n,e){return n.useProto3Json||ba(e)?e:{value:e}}function Ts(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $I(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Ox(n,e){return Ts(n,e.toTimestamp())}function Qe(n){return H(!!n),Y.fromTimestamp(function(t){const r=On(t);return new ke(r.seconds,r.nanos)}(n))}function Vp(n,e){return lf(n,e).canonicalString()}function lf(n,e){const t=function(i){return new he(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function qI(n){const e=he.fromString(n);return H(ZI(e)),e}function va(n,e){return Vp(n.databaseId,e.path)}function xn(n,e){const t=qI(e);if(t.get(1)!==n.databaseId.projectId)throw new z(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new z(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new q(WI(t))}function KI(n,e){return Vp(n.databaseId,e)}function GI(n){const e=qI(n);return e.length===4?he.emptyPath():WI(e)}function uf(n){return new he(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function WI(n){return H(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function y_(n,e,t){return{name:va(n,e),fields:t.value.mapValue.fields}}function Lx(n,e,t){const r=xn(n,e.name),i=Qe(e.updateTime),s=e.createTime?Qe(e.createTime):Y.min(),o=new Ze({mapValue:{fields:e.fields}}),a=Ae.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function Mx(n,e){return"found"in e?function(r,i){H(!!i.found),i.found.name,i.found.updateTime;const s=xn(r,i.found.name),o=Qe(i.found.updateTime),a=i.found.createTime?Qe(i.found.createTime):Y.min(),u=new Ze({mapValue:{fields:i.found.fields}});return Ae.newFoundDocument(s,o,a,u)}(n,e):"missing"in e?function(r,i){H(!!i.missing),H(!!i.readTime);const s=xn(r,i.missing),o=Qe(i.readTime);return Ae.newNoDocument(s,o)}(n,e):K()}function Fx(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:K()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(H(d===void 0||typeof d=="string"),Me.fromBase64String(d||"")):(H(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Me.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?F.UNKNOWN:UI(c.code);return new z(d,c.message||"")}(o);t=new zI(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=xn(n,r.document.name),s=Qe(r.document.updateTime),o=r.document.createTime?Qe(r.document.createTime):Y.min(),a=new Ze({mapValue:{fields:r.document.fields}}),u=Ae.newFoundDocument(i,s,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];t=new Zl(c,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=xn(n,r.document),s=r.readTime?Qe(r.readTime):Y.min(),o=Ae.newNoDocument(i,s),a=r.removedTargetIds||[];t=new Zl([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=xn(n,r.document),s=r.removedTargetIds||[];t=new Zl([],s,i,null)}else{if(!("filter"in e))return K();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new Px(i,s),a=r.targetId;t=new BI(a,o)}}return t}function wa(n,e){let t;if(e instanceof Ms)t={update:y_(n,e.key,e.value)};else if(e instanceof Ec)t={delete:va(n,e.key)};else if(e instanceof Un)t={update:y_(n,e.key,e.data),updateMask:qx(e.fieldMask)};else{if(!(e instanceof xp))return K();t={verify:va(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof ws)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Es)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Is)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof _a)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw K()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Ox(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:K()}(n,e.precondition)),t}function cf(n,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?ze.updateTime(Qe(s.updateTime)):s.exists!==void 0?ze.exists(s.exists):ze.none()}(e.currentDocument):ze.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;if("setToServerValue"in a)H(a.setToServerValue==="REQUEST_TIME"),u=new ws;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];u=new Es(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];u=new Is(d)}else"increment"in a?u=new _a(o,a.increment):K();const c=Ce.fromServerFormat(a.fieldPath);return new LI(c,u)}(n,i)):[];if(e.update){e.update.name;const i=xn(n,e.update.name),s=new Ze({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(u){const c=u.fieldPaths||[];return new St(c.map(d=>Ce.fromServerFormat(d)))}(e.updateMask);return new Un(i,s,o,t,r)}return new Ms(i,s,t,r)}if(e.delete){const i=xn(n,e.delete);return new Ec(i,t)}if(e.verify){const i=xn(n,e.verify);return new xp(i,t)}return K()}function jx(n,e){return n&&n.length>0?(H(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?Qe(i.updateTime):Qe(s);return o.isEqual(Y.min())&&(o=Qe(s)),new Sx(o,i.transformResults||[])}(t,e))):[]}function HI(n,e){return{documents:[KI(n,e.path)]}}function QI(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=KI(n,i);const s=function(c){if(c.length!==0)return XI(fe.create(c,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(d=>function(m){return{field:Vi(m.field),direction:Bx(m.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=af(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:t,parent:i}}function YI(n){let e=GI(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){H(r===1);const d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(p){const m=JI(p);return m instanceof fe&&Rp(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=function(p){return p.map(m=>function(R){return new ya(Oi(R.field),function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,ba(m)?null:m}(t.limit));let u=null;t.startAt&&(u=function(p){const m=!!p.before,E=p.values||[];return new _s(E,m)}(t.startAt));let c=null;return t.endAt&&(c=function(p){const m=!p.before,E=p.values||[];return new _s(E,m)}(t.endAt)),TI(e,i,o,s,a,"F",u,c)}function Ux(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return K()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function JI(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Oi(t.unaryFilter.field);return ae.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Oi(t.unaryFilter.field);return ae.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Oi(t.unaryFilter.field);return ae.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Oi(t.unaryFilter.field);return ae.create(o,"!=",{nullValue:"NULL_VALUE"});default:return K()}}(n):n.fieldFilter!==void 0?function(t){return ae.create(Oi(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return K()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return fe.create(t.compositeFilter.filters.map(r=>JI(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return K()}}(t.compositeFilter.op))}(n):K()}function Bx(n){return Dx[n]}function zx(n){return bx[n]}function $x(n){return Nx[n]}function Vi(n){return{fieldPath:n.canonicalString()}}function Oi(n){return Ce.fromServerFormat(n.fieldPath)}function XI(n){return n instanceof ae?function(t){if(t.op==="=="){if(e_(t.value))return{unaryFilter:{field:Vi(t.field),op:"IS_NAN"}};if(Zy(t.value))return{unaryFilter:{field:Vi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(e_(t.value))return{unaryFilter:{field:Vi(t.field),op:"IS_NOT_NAN"}};if(Zy(t.value))return{unaryFilter:{field:Vi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vi(t.field),op:zx(t.op),value:t.value}}}(n):n instanceof fe?function(t){const r=t.getFilters().map(i=>XI(i));return r.length===1?r[0]:{compositeFilter:{op:$x(t.op),filters:r}}}(n):K()}function qx(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function ZI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e,t,r,i,s=Y.min(),o=Y.min(),a=Me.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new Sn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Sn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Sn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Sn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT{constructor(e){this.ct=e}}function Kx(n,e){let t;if(e.document)t=Lx(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=q.fromSegments(e.noDocument.path),i=fi(e.noDocument.readTime);t=Ae.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return K();{const r=q.fromSegments(e.unknownDocument.path),i=fi(e.unknownDocument.version);t=Ae.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new ke(i[0],i[1]);return Y.fromTimestamp(s)}(e.readTime)),t}function __(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Vu(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:va(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ts(s,o.version.toTimestamp()),createTime:Ts(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:di(e.version)};else{if(!e.isUnknownDocument())return K();r.unknownDocument={path:t.path.toArray(),version:di(e.version)}}return r}function Vu(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function di(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function fi(n){const e=new ke(n.seconds,n.nanoseconds);return Y.fromTimestamp(e)}function Wr(n,e){const t=(e.baseMutations||[]).map(s=>cf(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>cf(n.ct,s)),i=ke.fromMillis(e.localWriteTimeMs);return new kp(e.batchId,i,t,r)}function Ro(n){const e=fi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?fi(n.lastLimboFreeSnapshotVersion):Y.min();let r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return H(s.documents.length===1),Nt(Va(GI(s.documents[0])))}(n.query):function(s){return Nt(YI(s))}(n.query),new Sn(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Me.fromBase64String(n.resumeToken))}function tT(n,e){const t=di(e.snapshotVersion),r=di(e.lastLimboFreeSnapshotVersion);let i;i=bu(e.target)?HI(n.ct,e.target):QI(n.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:hi(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function nT(n){const e=YI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?of(e,e.limit,"L"):e}function zh(n,e){return new bp(e.largestBatchId,cf(n.ct,e.overlayMutation))}function v_(n,e){const t=e.path.lastSegment();return[n,yt(e.path.popLast()),t]}function w_(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:di(r.readTime),documentKey:yt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{getBundleMetadata(e,t){return E_(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:fi(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return E_(e).put(function(i){return{bundleId:i.id,createTime:di(Qe(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return I_(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:nT(s.bundledQuery),readTime:fi(s.readTime)}}(r)})}saveNamedQuery(e,t){return I_(e).put(function(i){return{name:i.name,readTime:di(Qe(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function E_(n){return Ke(n,"bundles")}function I_(n){return Ke(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new Ic(e,r)}getOverlay(e,t){return uo(e).get(v_(this.userId,t)).next(r=>r?zh(this.serializer,r):null)}getOverlays(e,t){const r=on();return N.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,o)=>{const a=new bp(t,o);i.push(this.ht(e,a))}),N.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(o=>i.add(yt(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(uo(e).j("collectionPathOverlayIndex",a))}),N.waitFor(s)}getOverlaysForCollection(e,t,r){const i=on(),s=yt(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return uo(e).U("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const c=zh(this.serializer,u);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=on();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return uo(e).J({index:"collectionGroupOverlayIndex",range:a},(u,c,d)=>{const p=zh(this.serializer,c);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return uo(e).put(function(i,s,o){const[a,u,c]=v_(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:wa(i.ct,o.mutation)}}(this.serializer,this.userId,t))}}function uo(n){return Ke(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{Pt(e){return Ke(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?Me.fromUint8Array(r):Me.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Te(e.integerValue));else if("doubleValue"in e){const r=Te(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),da(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=On(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Tr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?fI(e)?this.dt(t,Number.MAX_SAFE_INTEGER):yc(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):K()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;const s=e.fields||{};this.dt(t,53);const o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(Te(a)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),q.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}Hr.vt=new Hr;function Hx(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function T_(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=Hx(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}class Qx{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const t=this.qt(e),r=T_(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){const t=this.qt(e),r=T_(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class Yx{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class Jx{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class co{constructor(){this.jt=new Qx,this.Ht=new Yx(this.jt),this.Jt=new Jx(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Qr(this.indexId,this.documentKey,this.arrayValue,r)}}function Kn(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=S_(n.arrayValue,e.arrayValue),t!==0?t:(t=S_(n.directionalValue,e.directionalValue),t!==0?t:q.comparator(n.documentKey,e.documentKey)))}function S_(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A_{constructor(e){this.Xt=new me((t,r)=>Ce.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(H(e.collectionGroup===this.collectionId),this.nn)return!1;const t=Jd(e);if(t!==void 0&&!this.sn(t))return!1;const r=Kr(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const u=r[s];if(!this.on(a,u)||!this._n(this.en[o++],u))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new me(Ce.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Hl(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Hl(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Hl(r.field,r.dir==="asc"?0:1)));return new Du(Du.UNKNOWN_ID,this.collectionId,t,ha.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rT(n){var e,t;if(H(n instanceof ae||n instanceof fe),n instanceof ae){if(n instanceof II){const i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>ae.create(n.field,"==",s)))||[];return fe.create(i,"or")}return n}const r=n.filters.map(i=>rT(i));return fe.create(r,n.op)}function Xx(n){if(n.getFilters().length===0)return[];const e=ff(rT(n));return H(iT(e)),hf(e)||df(e)?[e]:e.getFilters()}function hf(n){return n instanceof ae}function df(n){return n instanceof fe&&Rp(n)}function iT(n){return hf(n)||df(n)||function(t){if(t instanceof fe&&tf(t)){for(const r of t.getFilters())if(!hf(r)&&!df(r))return!1;return!0}return!1}(n)}function ff(n){if(H(n instanceof ae||n instanceof fe),n instanceof ae)return n;if(n.filters.length===1)return ff(n.filters[0]);const e=n.filters.map(r=>ff(r));let t=fe.create(e,n.op);return t=Ou(t),iT(t)?t:(H(t instanceof fe),H(vs(t)),H(t.filters.length>1),t.filters.reduce((r,i)=>Op(r,i)))}function Op(n,e){let t;return H(n instanceof ae||n instanceof fe),H(e instanceof ae||e instanceof fe),t=n instanceof ae?e instanceof ae?function(i,s){return fe.create([i,s],"and")}(n,e):R_(n,e):e instanceof ae?R_(e,n):function(i,s){if(H(i.filters.length>0&&s.filters.length>0),vs(i)&&vs(s))return vI(i,s.getFilters());const o=tf(i)?i:s,a=tf(i)?s:i,u=o.filters.map(c=>Op(c,a));return fe.create(u,"or")}(n,e),Ou(t)}function R_(n,e){if(vs(e))return vI(e,n.getFilters());{const t=e.filters.map(r=>Op(n,r));return fe.create(t,"or")}}function Ou(n){if(H(n instanceof ae||n instanceof fe),n instanceof ae)return n;const e=n.getFilters();if(e.length===1)return Ou(e[0]);if(yI(n))return n;const t=e.map(i=>Ou(i)),r=[];return t.forEach(i=>{i instanceof ae?r.push(i):i instanceof fe&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:fe.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zx{constructor(){this.un=new Lp}addToCollectionParentIndex(e,t){return this.un.add(t),N.resolve()}getCollectionParents(e,t){return N.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return N.resolve()}deleteFieldIndex(e,t){return N.resolve()}deleteAllFieldIndexes(e){return N.resolve()}createTargetIndexes(e,t){return N.resolve()}getDocumentsMatchingTarget(e,t){return N.resolve(null)}getIndexType(e,t){return N.resolve(0)}getFieldIndexes(e,t){return N.resolve([])}getNextCollectionGroupToUpdate(e){return N.resolve(null)}getMinOffset(e,t){return N.resolve(Ot.min())}getMinOffsetFromCollectionGroup(e,t){return N.resolve(Ot.min())}updateCollectionGroup(e,t,r){return N.resolve()}updateIndexEntries(e,t){return N.resolve()}}class Lp{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new me(he.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new me(he.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pl=new Uint8Array(0);class ek{constructor(e,t){this.databaseId=t,this.cn=new Lp,this.ln=new br(r=>hi(r),(r,i)=>Na(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const s={collectionId:r,parent:yt(i)};return P_(e).put(s)}return N.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[eI(t),""],!1,!0);return P_(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==t)break;r.push(sn(o.parent))}return r})}addFieldIndex(e,t){const r=ho(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete i.indexId;const s=r.add(i);if(t.indexState){const o=ki(e);return s.next(a=>{o.put(w_(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=ho(e),i=ki(e),s=xi(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=ho(e),r=xi(e),i=ki(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return N.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new A_(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=xi(e);let i=!0;const s=new Map;return N.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=re();const a=[];return N.forEach(s,(u,c)=>{j("IndexedDbIndexManager",`Using index ${function(P){return`id=${P.indexId}|cg=${P.collectionGroup}|f=${P.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(u)} to execute ${hi(t)}`);const d=function(P,V){const M=Jd(V);if(M===void 0)return null;for(const k of Nu(P,M.fieldPath))switch(k.op){case"array-contains-any":return k.value.arrayValue.values||[];case"array-contains":return[k.value]}return null}(c,u),p=function(P,V){const M=new Map;for(const k of Kr(V))for(const _ of Nu(P,k.fieldPath))switch(_.op){case"==":case"in":M.set(k.fieldPath.canonicalString(),_.value);break;case"not-in":case"!=":return M.set(k.fieldPath.canonicalString(),_.value),Array.from(M.values())}return null}(c,u),m=function(P,V){const M=[];let k=!0;for(const _ of Kr(V)){const g=_.kind===0?s_(P,_.fieldPath,P.startAt):o_(P,_.fieldPath,P.startAt);M.push(g.value),k&&(k=g.inclusive)}return new _s(M,k)}(c,u),E=function(P,V){const M=[];let k=!0;for(const _ of Kr(V)){const g=_.kind===0?o_(P,_.fieldPath,P.endAt):s_(P,_.fieldPath,P.endAt);M.push(g.value),k&&(k=g.inclusive)}return new _s(M,k)}(c,u),R=this.In(u,c,m),D=this.In(u,c,E),L=this.Tn(u,c,p),C=this.En(u.indexId,d,R,m.inclusive,D,E.inclusive,L);return N.forEach(C,S=>r.G(S,t.limit).next(P=>{P.forEach(V=>{const M=q.fromSegments(V.documentKey);o.has(M)||(o=o.add(M),a.push(M))})}))}).next(()=>a)}return N.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=Xx(fe.create(e.filters,"and")).map(r=>rf(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,s,o,a){const u=(t!=null?t.length:1)*Math.max(r.length,s.length),c=u/(t!=null?t.length:1),d=[];for(let p=0;p<u;++p){const m=t?this.dn(t[p/c]):Pl,E=this.An(e,m,r[p%c],i),R=this.Rn(e,m,s[p%c],o),D=a.map(L=>this.An(e,m,L,!0));d.push(...this.createRange(E,R,D))}return d}An(e,t,r,i){const s=new Qr(e,q.empty(),t,r);return i?s:s.Zt()}Rn(e,t,r,i){const s=new Qr(e,q.empty(),t,r);return i?s.Zt():s}Pn(e,t){const r=new A_(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const i=this.hn(t);return N.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new me(Ce.comparator),d=!1;for(const p of u.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:c=c.add(m.field));for(const p of u.orderBy)p.field.isKeyField()||(c=c.add(p.field));return c.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){const r=new co;for(const i of Kr(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const o=r.Yt(i.kind);Hr.vt.It(s,o)}return r.zt()}dn(e){const t=new co;return Hr.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new co;return Hr.vt.It(ma(this.databaseId,t),r.Yt(function(s){const o=Kr(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new co);let s=0;for(const o of Kr(e)){const a=r[s++];for(const u of i)if(this.fn(t,o.fieldPath)&&ga(a))i=this.gn(i,o,a);else{const c=u.Yt(o.kind);Hr.vt.It(a,c)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const u=new co;u.seed(a.zt()),Hr.vt.It(o,u.Yt(t.kind)),s.push(u)}return s}fn(e,t){return!!e.filters.find(r=>r instanceof ae&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=ho(e),i=ki(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{const o=[];return N.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(d,p){const m=p?new ha(p.sequenceNumber,new Ot(fi(p.readTime),new q(sn(p.documentKey)),p.largestBatchId)):ha.empty(),E=d.fields.map(([R,D])=>new Hl(Ce.fromServerFormat(R),D));return new Du(d.indexId,d.collectionGroup,E,m)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ee(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=ho(e),s=ki(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>N.forEach(a,u=>s.put(w_(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return N.forEach(t,(i,s)=>{const o=r.get(i.collectionGroup);return(o?N.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),N.forEach(a,u=>this.wn(e,i,u).next(c=>{const d=this.Sn(s,u);return c.isEqual(d)?N.resolve():this.bn(e,s,u,c,d)}))))})}Dn(e,t,r,i){return xi(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return xi(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const i=xi(e);let s=new me(Kn);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{s=s.add(new Qr(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,t){let r=new me(Kn);const i=this.Vn(t,e);if(i==null)return r;const s=Jd(t);if(s!=null){const o=e.data.field(s.fieldPath);if(ga(o))for(const a of o.arrayValue.values||[])r=r.add(new Qr(t.indexId,e.key,this.dn(a),i))}else r=r.add(new Qr(t.indexId,e.key,Pl,i));return r}bn(e,t,r,i,s){j("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(u,c,d,p,m){const E=u.getIterator(),R=c.getIterator();let D=Ci(E),L=Ci(R);for(;D||L;){let C=!1,S=!1;if(D&&L){const P=d(D,L);P<0?S=!0:P>0&&(C=!0)}else D!=null?S=!0:C=!0;C?(p(L),L=Ci(R)):S?(m(D),D=Ci(E)):(D=Ci(E),L=Ci(R))}}(i,s,Kn,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),N.waitFor(o)}yn(e){let t=1;return ki(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>Kn(o,a)).filter((o,a,u)=>!a||Kn(o,u[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Kn(o,e),u=Kn(o,t);if(a===0)i[0]=e.Zt();else if(a>0&&u<0)i.push(o),i.push(o.Zt());else if(u>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Pl,[]],u=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Pl,[]];s.push(IDBKeyRange.bound(a,u))}return s}Cn(e,t){return Kn(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(C_)}getMinOffset(e,t){return N.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||K())).next(C_)}}function P_(n){return Ke(n,"collectionParents")}function xi(n){return Ke(n,"indexEntries")}function ho(n){return Ke(n,"indexConfiguration")}function ki(n){return Ke(n,"indexState")}function C_(n){H(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Ep(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Ot(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class wt{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new wt(e,wt.DEFAULT_COLLECTION_PERCENTILE,wt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sT(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const u=r.J({range:o},(d,p,m)=>(a++,m.delete()));s.push(u.next(()=>{H(a===1)}));const c=[];for(const d of t.mutations){const p=aI(e,d.key.path,t.batchId);s.push(i.delete(p)),c.push(d.key)}return N.waitFor(s).next(()=>c)}function Lu(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw K();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wt.DEFAULT_COLLECTION_PERCENTILE=10,wt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wt.DEFAULT=new wt(41943040,wt.DEFAULT_COLLECTION_PERCENTILE,wt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wt.DISABLED=new wt(-1,0,0);class Tc{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){H(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Tc(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Gn(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=Li(e),o=Gn(e);return o.add({}).next(a=>{H(typeof a=="number");const u=new kp(a,t,r,i),c=function(E,R,D){const L=D.baseMutations.map(S=>wa(E.ct,S)),C=D.mutations.map(S=>wa(E.ct,S));return{userId:R,batchId:D.batchId,localWriteTimeMs:D.localWriteTime.toMillis(),baseMutations:L,mutations:C}}(this.serializer,this.userId,u),d=[];let p=new me((m,E)=>ee(m.canonicalString(),E.canonicalString()));for(const m of i){const E=aI(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),d.push(o.put(c)),d.push(s.put(E,FC))}return p.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[a]=u.keys()}),N.waitFor(d).next(()=>u)})}lookupMutationBatch(e,t){return Gn(e).get(t).next(r=>r?(H(r.userId===this.userId),Wr(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?N.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Gn(e).J({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(H(a.batchId>=r),s=Wr(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Gn(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Gn(e).U("userMutationsIndex",t).next(r=>r.map(i=>Wr(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Ql(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Li(e).J({range:i},(o,a,u)=>{const[c,d,p]=o,m=sn(d);if(c===this.userId&&t.path.isEqual(m))return Gn(e).get(p).next(E=>{if(!E)throw K();H(E.userId===this.userId),s.push(Wr(this.serializer,E))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new me(ee);const i=[];return t.forEach(s=>{const o=Ql(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=Li(e).J({range:a},(c,d,p)=>{const[m,E,R]=c,D=sn(E);m===this.userId&&s.path.isEqual(D)?r=r.add(R):p.done()});i.push(u)}),N.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Ql(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new me(ee);return Li(e).J({range:o},(u,c,d)=>{const[p,m,E]=u,R=sn(m);p===this.userId&&r.isPrefixOf(R)?R.length===i&&(a=a.add(E)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(Gn(e).get(s).next(o=>{if(o===null)throw K();H(o.userId===this.userId),r.push(Wr(this.serializer,o))}))}),N.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return sT(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),N.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return N.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Li(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){const u=sn(s[1]);i.push(u)}else a.done()}).next(()=>{H(i.length===0)})})}containsKey(e,t){return oT(e,this.userId,t)}Nn(e){return aT(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function oT(n,e,t){const r=Ql(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Li(n).J({range:s,H:!0},(a,u,c)=>{const[d,p,m]=a;d===e&&p===i&&(o=!0),c.done()}).next(()=>o)}function Gn(n){return Ke(n,"mutations")}function Li(n){return Ke(n,"documentMutations")}function aT(n){return Ke(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new pi(0)}static kn(){return new pi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new pi(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>Y.fromTimestamp(new ke(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Di(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(H(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return Di(e).J((o,a)=>{const u=Ro(a);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>N.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Di(e).J((r,i)=>{const s=Ro(i);t(s)})}qn(e){return k_(e).get("targetGlobalKey").next(t=>(H(t!==null),t))}Qn(e,t){return k_(e).put("targetGlobalKey",t)}Kn(e,t){return Di(e).put(tT(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=hi(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Di(e).J({range:i,index:"queryTargetsIndex"},(o,a,u)=>{const c=Ro(a);Na(t,c.target)&&(s=c,u.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=Xn(e);return t.forEach(o=>{const a=yt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),N.waitFor(i)}removeMatchingKeys(e,t,r){const i=Xn(e);return N.forEach(t,s=>{const o=yt(s.path);return N.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=Xn(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Xn(e);let s=re();return i.J({range:r,H:!0},(o,a,u)=>{const c=sn(o[1]),d=new q(c);s=s.add(d)}).next(()=>s)}containsKey(e,t){const r=yt(t.path),i=IDBKeyRange.bound([r],[eI(r)],!1,!0);let s=0;return Xn(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],u,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}ot(e,t){return Di(e).get(t).next(r=>r?Ro(r):null)}}function Di(n){return Ke(n,"targets")}function k_(n){return Ke(n,"targetGlobal")}function Xn(n){return Ke(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D_([n,e],[t,r]){const i=ee(n,t);return i===0?ee(e,r):i}class nk{constructor(e){this.Un=e,this.buffer=new me(D_),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();D_(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class rk{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){j("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Dr(t)?j("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await kr(t)}await this.Hn(3e5)})}}class ik{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return N.resolve(Tt.oe);const r=new nk(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(j("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(x_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(j("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),x_):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,s,o,a,u,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(j("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,t))).next(p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(c=Date.now(),bi()<=oe.DEBUG&&j("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${p} documents in `+(c-u)+`ms
Total Duration: ${c-d}ms`),N.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}function sk(n,e){return new ik(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e,t){this.db=e,this.garbageCollector=sk(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return Cl(e,r)}removeReference(e,t,r){return Cl(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Cl(e,t)}nr(e,t){return function(i,s){let o=!1;return aT(i).Y(a=>oT(i,a,s).next(u=>(u&&(o=!0),N.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(o,a)=>{if(a<=t){const u=this.nr(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Y.min()),Xn(e).delete(function(p){return[0,yt(p.path)]}(o))))});i.push(u)}}).next(()=>N.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Cl(e,t)}tr(e,t){const r=Xn(e);let i,s=Tt.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{o===0?(s!==Tt.oe&&t(new q(sn(i)),s),s=c,i=u):s=Tt.oe}).next(()=>{s!==Tt.oe&&t(new q(sn(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Cl(n,e){return Xn(n).put(function(r,i){return{targetId:0,path:yt(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{constructor(){this.changes=new br(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ae.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?N.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Br(e).put(r)}removeEntry(e,t,r){return Br(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Vu(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=Ae.newInvalidDocument(t);return Br(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(fo(t))},(i,s)=>{r=this.ir(t,s)}).next(()=>r)}sr(e,t){let r={size:0,document:Ae.newInvalidDocument(t)};return Br(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(fo(t))},(i,s)=>{r={document:this.ir(t,s),size:Lu(s)}}).next(()=>r)}getEntries(e,t){let r=Dt();return this._r(e,t,(i,s)=>{const o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,t){let r=Dt(),i=new ve(q.comparator);return this._r(e,t,(s,o)=>{const a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,Lu(o))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return N.resolve();let i=new me(V_);t.forEach(u=>i=i.add(u));const s=IDBKeyRange.bound(fo(i.first()),fo(i.last())),o=i.getIterator();let a=o.getNext();return Br(e).J({index:"documentKeyIndex",range:s},(u,c,d)=>{const p=q.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&V_(a,p)<0;)r(a,null),a=o.getNext();a&&a.isEqual(p)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?d.$(fo(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Vu(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Br(e).U(IDBKeyRange.bound(a,u,!0)).next(c=>{s==null||s.incrementDocumentReadCount(c.length);let d=Dt();for(const p of c){const m=this.ir(q.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Oa(t,m)||i.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=Dt();const o=N_(t,r),a=N_(t,Ot.max());return Br(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,d)=>{const p=this.ir(q.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(p.key,p),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new lk(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return b_(e).get("remoteDocumentGlobalKey").next(t=>(H(!!t),t))}rr(e,t){return b_(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=Kx(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Y.min())))return r}return Ae.newInvalidDocument(e)}}function uT(n){return new ak(n)}class lk extends lT{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new br(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new me((s,o)=>ee(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const u=__(this.cr.serializer,o);i=i.add(s.path.popLast());const c=Lu(u);r+=c-a.size,t.push(this.cr.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){const u=__(this.cr.serializer,o.convertToNoDocument(Y.min()));t.push(this.cr.addEntry(e,s,u))}}),i.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,r)),N.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function b_(n){return Ke(n,"remoteDocumentGlobal")}function Br(n){return Ke(n,"remoteDocumentsV14")}function fo(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function N_(n,e){const t=e.documentKey.path.toArray();return[n,Vu(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function V_(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ee(t[s],r[s]),i)return i;return i=ee(t.length,r.length),i||(i=ee(t[t.length-2],r[r.length-2]),i||ee(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Uo(r.mutation,i,St.empty(),ke.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,re()).next(()=>r))}getLocalViewOfDocuments(e,t,r=re()){const i=on();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=So();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=on();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,re()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Dt();const o=jo(),a=function(){return jo()}();return t.forEach((u,c)=>{const d=r.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof Un)?s=s.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),Uo(d.mutation,c,d.mutation.getFieldMask(),ke.now())):o.set(c.key,St.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,d)=>o.set(c,d)),t.forEach((c,d)=>{var p;return a.set(c,new uk(d,(p=o.get(c))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){const r=jo();let i=new ve((o,a)=>o-a),s=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(u=>{const c=t.get(u);if(c===null)return;let d=r.get(u)||St.empty();d=a.applyToLocalView(c,d),r.set(u,d);const p=(i.get(a.batchId)||re()).add(u);i=i.insert(a.batchId,p)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),c=u.key,d=u.value,p=kI();d.forEach(m=>{if(!s.has(m)){const E=MI(t.get(m),r.get(m));E!==null&&p.set(m,E),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,p))}return N.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return q.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):SI(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):N.resolve(on());let a=-1,u=s;return o.next(c=>N.forEach(c,(d,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(d)?N.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{u=u.insert(d,m)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,re())).next(d=>({batchId:a,changes:xI(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new q(t)).next(r=>{let i=So();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=So();return this.indexManager.getCollectionParents(e,s).next(a=>N.forEach(a,u=>{const c=function(p,m){return new Ls(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(d=>{d.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((u,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,Ae.newInvalidDocument(d)))});let a=So();return o.forEach((u,c)=>{const d=s.get(u);d!==void 0&&Uo(d.mutation,c,St.empty(),ke.now()),Oa(t,c)&&(a=a.insert(u,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return N.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Qe(i.createTime)}}(t)),N.resolve()}getNamedQuery(e,t){return N.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:nT(i.bundledQuery),readTime:Qe(i.readTime)}}(t)),N.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(){this.overlays=new ve(q.comparator),this.Ir=new Map}getOverlay(e,t){return N.resolve(this.overlays.get(t))}getOverlays(e,t){const r=on();return N.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),N.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),N.resolve()}getOverlaysForCollection(e,t,r){const i=on(),s=t.length+1,o=new q(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,c=u.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return N.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new ve((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let d=s.get(c.largestBatchId);d===null&&(d=on(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=on(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=i)););return N.resolve(a)}ht(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new bp(t,r));let s=this.Ir.get(t);s===void 0&&(s=re(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(){this.sessionToken=Me.EMPTY_BYTE_STRING}getSessionToken(e){return N.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,N.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(){this.Tr=new me(Ge.Er),this.dr=new me(Ge.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new Ge(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new Ge(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new q(new he([])),r=new Ge(t,e),i=new Ge(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new q(new he([])),r=new Ge(t,e),i=new Ge(t,e+1);let s=re();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new Ge(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Ge{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return q.comparator(e.key,t.key)||ee(e.wr,t.wr)}static Ar(e,t){return ee(e.wr,t.wr)||q.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new me(Ge.Er)}checkEmpty(e){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new kp(s,t,r,i);this.mutationQueue.push(o);for(const a of i)this.br=this.br.add(new Ge(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return N.resolve(o)}lookupMutationBatch(e,t){return N.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.vr(r),s=i<0?0:i;return N.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ge(t,0),i=new Ge(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const a=this.Dr(o.wr);s.push(a)}),N.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new me(ee);return t.forEach(i=>{const s=new Ge(i,0),o=new Ge(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),N.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;q.isDocumentKey(s)||(s=s.child(""));const o=new Ge(new q(s),0);let a=new me(ee);return this.br.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(u.wr)),!0)},o),N.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){H(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return N.forEach(t.mutations,i=>{const s=new Ge(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new Ge(t,0),i=this.br.firstAfterOrEqual(r);return N.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,N.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk{constructor(e){this.Mr=e,this.docs=function(){return new ve(q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return N.resolve(r?r.document.mutableCopy():Ae.newInvalidDocument(t))}getEntries(e,t){let r=Dt();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ae.newInvalidDocument(i))}),N.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Dt();const o=t.path,a=new q(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:c,value:{document:d}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Ep(nI(d),r)<=0||(i.has(d.key)||Oa(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return N.resolve(s)}getAllFromCollectionGroup(e,t,r,i){K()}Or(e,t){return N.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new mk(this)}getSize(e){return N.resolve(this.size)}}class mk extends lT{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),N.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(e){this.persistence=e,this.Nr=new br(t=>hi(t),Na),this.lastRemoteSnapshotVersion=Y.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Mp,this.targetCount=0,this.kr=pi.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),N.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new pi(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,N.resolve()}updateTargetData(e,t){return this.Kn(t),N.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),N.waitFor(s).next(()=>i)}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return N.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),N.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),N.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),N.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return N.resolve(r)}containsKey(e,t){return N.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Tt(0),this.Kr=!1,this.Kr=!0,this.$r=new dk,this.referenceDelegate=e(this),this.Ur=new gk(this),this.indexManager=new Zx,this.remoteDocumentCache=function(i){return new pk(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new eT(t),this.Gr=new ck(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new hk,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new fk(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){j("MemoryPersistence","Starting transaction:",e);const i=new yk(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return N.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class yk extends iI{constructor(e){super(),this.currentSequenceNumber=e}}class Sc{constructor(e){this.persistence=e,this.Jr=new Mp,this.Yr=null}static Zr(e){return new Sc(e)}get Xr(){if(this.Yr)return this.Yr;throw K()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),N.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),N.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),N.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.Xr,r=>{const i=q.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,Y.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return N.or([()=>N.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _k{constructor(e){this.serializer=e}O(e,t,r,i){const s=new gc("createOrUpgrade",t);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Hy,{unique:!0}),u.createObjectStore("documentMutations")}(e),O_(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=N.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),O_(e)),o=o.next(()=>function(u){const c=u.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Y.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store("mutations").U().next(d=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Hy,{unique:!0});const p=c.store("mutations"),m=d.map(E=>p.put(E));return N.waitFor(m)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(u){const c=u.createObjectStore("documentOverlays",{keyPath:YC});c.createIndex("collectionPathOverlayIndex",JC,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",XC,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){const c=u.createObjectStore("remoteDocumentsV14",{keyPath:jC});c.createIndex("documentKeyIndex",UC),c.createIndex("collectionGroupIndex",BC)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:GC}).createIndex("sequenceNumberIndex",WC,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:HC}).createIndex("documentKeyIndex",QC,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(u){u.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=Lu(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>N.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>N.forEach(a,u=>{H(u.userId===s.userId);const c=Wr(this.serializer,u);return sT(e,s.userId,c).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,a)=>{const u=new he(o),c=function(p){return[0,yt(p)]}(u);s.push(t.get(c).next(d=>d?N.resolve():(p=>t.put({targetId:0,path:yt(p),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>N.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:KC});const r=t.store("collectionParents"),i=new Lp,s=o=>{if(i.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:yt(u)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const u=new he(o);return s(u.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,u],c)=>{const d=sn(a);return s(d.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,i)=>{const s=Ro(i),o=tT(this.serializer,s);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{const a=t.store("remoteDocumentsV14"),u=function(p){return p.document?new q(he.fromString(p.document.name).popFirst(5)):p.noDocument?q.fromSegments(p.noDocument.path):p.unknownDocument?q.fromSegments(p.unknownDocument.path):K()}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>N.waitFor(i))}ai(e,t){const r=t.store("mutations"),i=uT(this.serializer),s=new hT(Sc.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(u=>{var c;let d=(c=a.get(u.userId))!==null&&c!==void 0?c:re();Wr(this.serializer,u).keys().forEach(p=>d=d.add(p)),a.set(u.userId,d)}),N.forEach(a,(u,c)=>{const d=new ut(c),p=Ic.lt(this.serializer,d),m=s.getIndexManager(d),E=Tc.lt(d,this.serializer,m,s.referenceDelegate);return new cT(i,E,p,m).recalculateAndSaveOverlaysForDocumentKeys(new Xd(t,Tt.oe),u).next()})})}}function O_(n){n.createObjectStore("targetDocuments",{keyPath:$C}).createIndex("documentTargetsIndex",qC,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",zC,{unique:!0}),n.createObjectStore("targetGlobal")}const $h="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Fp{constructor(e,t,r,i,s,o,a,u,c,d,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=c,this.li=d,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!Fp.D())throw new z(F.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ok(this,i),this.Ai=t+"main",this.serializer=new eT(u),this.Ri=new _r(this.Ai,this.hi,new _k(this.serializer)),this.$r=new Wx,this.Ur=new tk(this.referenceDelegate,this.serializer),this.remoteDocumentCache=uT(this.serializer),this.Gr=new Gx,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&Le("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new z(F.FAILED_PRECONDITION,$h);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Tt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>xl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Dr(e))return j("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return j("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return po(e).get("owner").next(t=>N.resolve(this.vi(t)))}Ci(e){return xl(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=Ke(t,"clientMetadata");return r.U().next(i=>{const s=this.xi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return N.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?N.resolve(!0):po(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new z(F.FAILED_PRECONDITION,$h);return!1}}return!(!this.networkEnabled||!this.inForeground)||xl(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&j("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new Xd(e,Tt.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>xl(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Tc.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new ek(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Ic.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){j("IndexedDbPersistence","Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(u){return u===17?tx:u===16?ex:u===15?Tp:u===14?cI:u===13?uI:u===12?ZC:u===11?lI:void K()}(this.hi);let o;return this.Ri.runTransaction(e,i,s,a=>(o=new Xd(a,this.Qr?this.Qr.next():Tt.oe),t==="readwrite-primary"?this.wi(o).next(u=>!!u||this.Si(o)).next(u=>{if(!u)throw Le(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new z(F.FAILED_PRECONDITION,rI);return r(o)}).next(u=>this.Di(o).next(()=>u)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return po(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new z(F.FAILED_PRECONDITION,$h)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return po(e).put("owner",t)}static D(){return _r.D()}bi(e){const t=po(e);return t.get("owner").next(r=>this.vi(r)?(j("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):N.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Le(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;UE()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return j("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Le("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Le("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function po(n){return Ke(n,"owner")}function xl(n){return Ke(n,"clientMetadata")}function dT(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=re(),i=re();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new jp(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return UE()?8:sI(qe())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new vk;return this.Xi(e,t,o).next(a=>{if(s.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(bi()<=oe.DEBUG&&j("QueryEngine","SDK will not create cache indexes for query:",Ni(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),N.resolve()):(bi()<=oe.DEBUG&&j("QueryEngine","Query:",Ni(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(bi()<=oe.DEBUG&&j("QueryEngine","The SDK decides to create cache indexes for query:",Ni(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Nt(t))):N.resolve())}Yi(e,t){if(a_(t))return N.resolve(null);let r=Nt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=of(t,null,"F"),r=Nt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=re(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.ts(t,a);return this.ns(t,c,o,u.readTime)?this.Yi(e,of(t,null,"F")):this.rs(e,c,t,u)}))})))}Zi(e,t,r,i){return a_(t)||i.isEqual(Y.min())?N.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(t,s);return this.ns(t,o,r,i)?N.resolve(null):(bi()<=oe.DEBUG&&j("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ni(t)),this.rs(e,o,t,tI(i,-1)).next(a=>a))})}ts(e,t){let r=new me(PI(e));return t.forEach((i,s)=>{Oa(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return bi()<=oe.DEBUG&&j("QueryEngine","Using full collection scan to execute query:",Ni(t)),this.Ji.getDocumentsMatchingQuery(e,t,Ot.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new ve(ee),this._s=new br(s=>hi(s),Na),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cT(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function pT(n,e,t,r){return new wk(n,e,t,r)}async function mT(n,e){const t=W(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let u=re();for(const c of i){o.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}for(const c of s){a.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(r,u).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function Ek(n,e){const t=W(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,u,c,d){const p=c.batch,m=p.keys();let E=N.resolve();return m.forEach(R=>{E=E.next(()=>d.getEntry(u,R)).next(D=>{const L=c.docVersions.get(R);H(L!==null),D.version.compareTo(L)<0&&(p.applyToRemoteDocument(D,c),D.isValidDocument()&&(D.setReadTime(c.commitVersion),d.addEntry(D)))})}),E.next(()=>a.mutationQueue.removeMutationBatch(u,p))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=re();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function gT(n){const e=W(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function Ik(n,e){const t=W(n),r=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const a=[];e.targetChanges.forEach((d,p)=>{const m=i.get(p);if(!m)return;a.push(t.Ur.removeMatchingKeys(s,d.removedDocuments,p).next(()=>t.Ur.addMatchingKeys(s,d.addedDocuments,p)));let E=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?E=E.withResumeToken(Me.EMPTY_BYTE_STRING,Y.min()).withLastLimboFreeSnapshotVersion(Y.min()):d.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(d.resumeToken,r)),i=i.insert(p,E),function(D,L,C){return D.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=3e8?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(m,E,d)&&a.push(t.Ur.updateTargetData(s,E))});let u=Dt(),c=re();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(Tk(s,o,e.documentUpdates).next(d=>{u=d.Ps,c=d.Is})),!r.isEqual(Y.min())){const d=t.Ur.getLastRemoteSnapshotVersion(s).next(p=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return N.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(t.os=i,s))}function Tk(n,e,t){let r=re(),i=re();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Dt();return t.forEach((a,u)=>{const c=s.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(Y.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):j("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{Ps:o,Is:i}})}function Sk(n,e){const t=W(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Mu(n,e){const t=W(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,N.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new Sn(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function Ss(n,e,t){const r=W(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Dr(o))throw o;j("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function pf(n,e,t){const r=W(n);let i=Y.min(),s=re();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,d){const p=W(u),m=p._s.get(d);return m!==void 0?N.resolve(p.os.get(m)):p.Ur.getTargetData(c,d)}(r,o,Nt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:Y.min(),t?s:re())).next(a=>(vT(r,RI(e),a),{documents:a,Ts:s})))}function yT(n,e){const t=W(n),r=W(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function _T(n,e){const t=W(n),r=t.us.get(e)||Y.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,tI(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(vT(t,e,i),i))}function vT(n,e,t){let r=n.us.get(e)||Y.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}function L_(n,e){return`firestore_clients_${n}_${e}`}function M_(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function qh(n,e){return`firestore_targets_${n}_${e}`}class Fu{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Rs(e,t,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new z(i.error.code,i.error.message))),o?new Fu(e,t,i.state,s):(Le("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Bo{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){const r=JSON.parse(t);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new z(r.error.code,r.error.message))),s?new Bo(e,r.state,i):(Le("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ju{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Pp();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=oI(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new ju(e,s):(Le("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Up{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Up(t.clientId,t.onlineState):(Le("SharedClientState",`Failed to parse online state: ${e}`),null)}}class mf{constructor(){this.activeTargetIds=Pp()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Kh{constructor(e,t,r,i,s){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new ve(ee),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=L_(this.persistenceKey,this.ps),this.vs=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new mf),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Os=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const i=this.getItem(L_(this.persistenceKey,r));if(i){const s=ju.Rs(r,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const r=this.Ls(t);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(qh(this.persistenceKey,e));if(i){const s=Bo.Rs(e,i);s&&(r=s.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(qh(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return j("SharedClientState","READ",e,t),t}setItem(e,t){j("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){j("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(j("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void Le("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const r=this.Gs(t.key);return this.zs(r,null)}{const r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){const r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){const r=function(s){let o=Tt.oe;if(s!=null)try{const a=JSON.parse(s);H(typeof a=="number"),o=a}catch(a){Le("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==Tt.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){const r=this.Xs(t.newValue);await Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){const i=new Fu(this.currentUser,e,t,r),s=M_(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){const t=M_(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){const i=qh(this.persistenceKey,e),s=new Bo(e,t,r);this.setItem(i,s.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const r=this.Gs(e);return ju.Rs(r,t)}Hs(e,t){const r=this.Fs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Fu.Rs(new ut(s),i,t)}Ys(e,t){const r=this.Ms.exec(e),i=Number(r[1]);return Bo.Rs(i,t)}Ls(e){return Up.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);j("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const r=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Pp();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class wT{constructor(){this.so=new mf,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new mf,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){j("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){j("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kl=null;function Gh(){return kl===null?kl=function(){return 268435456+Math.round(2147483648*Math.random())}():kl++,"0x"+kl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lt="WebChannelConnection";class Ck extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){const a=Gh(),u=this.xo(t,r.toUriEncodedString());j("RestConnection",`Sending RPC '${t}' ${a}:`,u,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,o),this.No(t,u,c,i).then(d=>(j("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw ua("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",u,"request:",i),d})}Lo(t,r,i,s,o,a){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Os}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){const i=Rk[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){const s=Gh();return new Promise((o,a)=>{const u=new HE;u.setWithCredentials(!0),u.listenOnce(QE.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Wl.NO_ERROR:const d=u.getResponseJson();j(lt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Wl.TIMEOUT:j(lt,`RPC '${e}' ${s} timed out`),a(new z(F.DEADLINE_EXCEEDED,"Request time out"));break;case Wl.HTTP_ERROR:const p=u.getStatus();if(j(lt,`RPC '${e}' ${s} failed with status:`,p,"response text:",u.getResponseText()),p>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const E=m==null?void 0:m.error;if(E&&E.status&&E.message){const R=function(L){const C=L.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(C)>=0?C:F.UNKNOWN}(E.status);a(new z(R,E.message))}else a(new z(F.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new z(F.UNAVAILABLE,"Connection failed."));break;default:K()}}finally{j(lt,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);j(lt,`RPC '${e}' ${s} sending request:`,i),u.send(t,"POST",c,r,15)})}Bo(e,t,r){const i=Gh(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=XE(),a=JE(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const d=s.join("");j(lt,`Creating RPC '${e}' stream ${i}: ${d}`,u);const p=o.createWebChannel(d,u);let m=!1,E=!1;const R=new Pk({Io:L=>{E?j(lt,`Not sending because RPC '${e}' stream ${i} is closed:`,L):(m||(j(lt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),j(lt,`RPC '${e}' stream ${i} sending:`,L),p.send(L))},To:()=>p.close()}),D=(L,C,S)=>{L.listen(C,P=>{try{S(P)}catch(V){setTimeout(()=>{throw V},0)}})};return D(p,To.EventType.OPEN,()=>{E||(j(lt,`RPC '${e}' stream ${i} transport opened.`),R.yo())}),D(p,To.EventType.CLOSE,()=>{E||(E=!0,j(lt,`RPC '${e}' stream ${i} transport closed`),R.So())}),D(p,To.EventType.ERROR,L=>{E||(E=!0,ua(lt,`RPC '${e}' stream ${i} transport errored:`,L),R.So(new z(F.UNAVAILABLE,"The operation could not be completed")))}),D(p,To.EventType.MESSAGE,L=>{var C;if(!E){const S=L.data[0];H(!!S);const P=S,V=P.error||((C=P[0])===null||C===void 0?void 0:C.error);if(V){j(lt,`RPC '${e}' stream ${i} received error:`,V);const M=V.status;let k=function(I){const T=Fe[I];if(T!==void 0)return UI(T)}(M),_=V.message;k===void 0&&(k=F.INTERNAL,_="Unknown error status: "+M+" with message "+V.message),E=!0,R.So(new z(k,_)),p.close()}else j(lt,`RPC '${e}' stream ${i} received:`,S),R.bo(S)}}),D(a,YE.STAT_EVENT,L=>{L.stat===Yd.PROXY?j(lt,`RPC '${e}' stream ${i} detected buffering proxy`):L.stat===Yd.NOPROXY&&j(lt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{R.wo()},0),R}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ET(){return typeof window<"u"?window:null}function eu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ac(n){return new Vx(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&j("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{constructor(e,t,r,i,s,o,a,u){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Bp(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===F.RESOURCE_EXHAUSTED?(Le(t.toString()),Le("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{const i=new z(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return j("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(j("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class xk extends IT{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=Fx(this.serializer,e),r=function(s){if(!("targetChange"in s))return Y.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Y.min():o.readTime?Qe(o.readTime):Y.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=uf(this.serializer),t.addTarget=function(s,o){let a;const u=o.target;if(a=bu(u)?{documents:HI(s,u)}:{query:QI(s,u)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=$I(s,o.resumeToken);const c=af(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(Y.min())>0){a.readTime=Ts(s,o.snapshotVersion.toTimestamp());const c=af(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=Ux(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=uf(this.serializer),t.removeTarget=e,this.a_(t)}}class kk extends IT{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return H(!!e.streamToken),this.lastStreamToken=e.streamToken,H(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){H(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=jx(e.writeResults,e.commitTime),r=Qe(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=uf(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>wa(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new z(F.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,lf(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new z(F.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,lf(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new z(F.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class bk{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Le(t),this.D_=!1):j("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{wi(this)&&(j("RemoteStore","Restarting streams for network reachability change."),await async function(u){const c=W(u);c.L_.add(4),await Fa(c),c.q_.set("Unknown"),c.L_.delete(4),await Rc(c)}(this))})}),this.q_=new bk(r,i)}}async function Rc(n){if(wi(n))for(const e of n.B_)await e(!0)}async function Fa(n){for(const e of n.B_)await e(!1)}function Pc(n,e){const t=W(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),qp(t)?$p(t):js(t).r_()&&zp(t,e))}function As(n,e){const t=W(n),r=js(t);t.N_.delete(e),r.r_()&&TT(t,e),t.N_.size===0&&(r.r_()?r.o_():wi(t)&&t.q_.set("Unknown"))}function zp(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Y.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}js(n).A_(e)}function TT(n,e){n.Q_.xe(e),js(n).R_(e)}function $p(n){n.Q_=new kx({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),js(n).start(),n.q_.v_()}function qp(n){return wi(n)&&!js(n).n_()&&n.N_.size>0}function wi(n){return W(n).L_.size===0}function ST(n){n.Q_=void 0}async function Vk(n){n.q_.set("Online")}async function Ok(n){n.N_.forEach((e,t)=>{zp(n,e)})}async function Lk(n,e){ST(n),qp(n)?(n.q_.M_(e),$p(n)):n.q_.set("Unknown")}async function Mk(n,e,t){if(n.q_.set("Online"),e instanceof zI&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.N_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))}(n,e)}catch(r){j("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Uu(n,r)}else if(e instanceof Zl?n.Q_.Ke(e):e instanceof BI?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Y.min()))try{const r=await gT(n.localStore);t.compareTo(r)>=0&&await function(s,o){const a=s.Q_.rt(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const d=s.N_.get(c);d&&s.N_.set(c,d.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{const d=s.N_.get(u);if(!d)return;s.N_.set(u,d.withResumeToken(Me.EMPTY_BYTE_STRING,d.snapshotVersion)),TT(s,u);const p=new Sn(d.target,u,c,d.sequenceNumber);zp(s,p)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){j("RemoteStore","Failed to raise snapshot:",r),await Uu(n,r)}}async function Uu(n,e,t){if(!Dr(e))throw e;n.L_.add(1),await Fa(n),n.q_.set("Offline"),t||(t=()=>gT(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{j("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await Rc(n)})}function AT(n,e){return e().catch(t=>Uu(n,t,e))}async function Fs(n){const e=W(n),t=Ar(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;Fk(e);)try{const i=await Sk(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,jk(e,i)}catch(i){await Uu(e,i)}RT(e)&&PT(e)}function Fk(n){return wi(n)&&n.O_.length<10}function jk(n,e){n.O_.push(e);const t=Ar(n);t.r_()&&t.V_&&t.m_(e.mutations)}function RT(n){return wi(n)&&!Ar(n).n_()&&n.O_.length>0}function PT(n){Ar(n).start()}async function Uk(n){Ar(n).p_()}async function Bk(n){const e=Ar(n);for(const t of n.O_)e.m_(t.mutations)}async function zk(n,e,t){const r=n.O_.shift(),i=Dp.from(r,e,t);await AT(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Fs(n)}async function $k(n,e){e&&Ar(n).V_&&await async function(r,i){if(function(o){return jI(o)&&o!==F.ABORTED}(i.code)){const s=r.O_.shift();Ar(r).s_(),await AT(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Fs(r)}}(n,e),RT(n)&&PT(n)}async function j_(n,e){const t=W(n);t.asyncQueue.verifyOperationInProgress(),j("RemoteStore","RemoteStore received new credentials");const r=wi(t);t.L_.add(3),await Fa(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await Rc(t)}async function gf(n,e){const t=W(n);e?(t.L_.delete(2),await Rc(t)):e||(t.L_.add(2),await Fa(t),t.q_.set("Unknown"))}function js(n){return n.K_||(n.K_=function(t,r,i){const s=W(t);return s.w_(),new xk(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:Vk.bind(null,n),Ro:Ok.bind(null,n),mo:Lk.bind(null,n),d_:Mk.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),qp(n)?$p(n):n.q_.set("Unknown")):(await n.K_.stop(),ST(n))})),n.K_}function Ar(n){return n.U_||(n.U_=function(t,r,i){const s=W(t);return s.w_(),new kk(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Uk.bind(null,n),mo:$k.bind(null,n),f_:Bk.bind(null,n),g_:zk.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await Fs(n)):(await n.U_.stop(),n.O_.length>0&&(j("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Jt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,a=new Kp(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new z(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Gp(n,e){if(Le("AsyncQueue",`${e}: ${n}`),Dr(n))return new z(F.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e){this.comparator=e?(t,r)=>e(t,r)||q.comparator(t.key,r.key):(t,r)=>q.comparator(t.key,r.key),this.keyedMap=So(),this.sortedSet=new ve(this.comparator)}static emptySet(e){return new is(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof is)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new is;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(){this.W_=new ve(q.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):K():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Rs{constructor(e,t,r,i,s,o,a,u,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Rs(e,t,is.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_c(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class Kk{constructor(){this.queries=B_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const i=W(t),s=i.queries;i.queries=B_(),s.forEach((o,a)=>{for(const u of a.j_)u.onError(r)})})(this,new z(F.ABORTED,"Firestore shutting down"))}}function B_(){return new br(n=>AI(n),_c)}async function Wp(n,e){const t=W(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new qk,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await t.onListen(i,!0);break;case 1:s.z_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const a=Gp(o,`Initialization of query '${Ni(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&Qp(t)}async function Hp(n,e){const t=W(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Gk(n,e){const t=W(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&Qp(t)}function Wk(n,e,t){const r=W(n),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(t);r.queries.delete(e)}function Qp(n){n.Y_.forEach(e=>{e.next()})}var yf,z_;(z_=yf||(yf={})).ea="default",z_.Cache="cache";class Yp{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Rs(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Rs.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==yf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT{constructor(e){this.key=e}}class xT{constructor(e){this.key=e}}class Hk{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=re(),this.mutatedKeys=re(),this.Aa=PI(e),this.Ra=new is(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new U_,i=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,p)=>{const m=i.get(d),E=Oa(this.query,p)?p:null,R=!!m&&this.mutatedKeys.has(m.key),D=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let L=!1;m&&E?m.data.isEqual(E.data)?R!==D&&(r.track({type:3,doc:E}),L=!0):this.ga(m,E)||(r.track({type:2,doc:E}),L=!0,(u&&this.Aa(E,u)>0||c&&this.Aa(E,c)<0)&&(a=!0)):!m&&E?(r.track({type:0,doc:E}),L=!0):m&&!E&&(r.track({type:1,doc:m}),L=!0,(u||c)&&(a=!0)),L&&(E?(o=o.add(E),s=D?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,p)=>function(E,R){const D=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return K()}};return D(E)-D(R)}(d.type,p.type)||this.Aa(d.doc,p.doc)),this.pa(r),i=i!=null&&i;const a=t&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,c=u!==this.Ea;return this.Ea=u,o.length!==0||c?{snapshot:new Rs(this.query,e.Ra,s,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new U_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=re(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new xT(r))}),this.da.forEach(r=>{e.has(r)||t.push(new CT(r))}),t}ba(e){this.Ta=e.Ts,this.da=re();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Rs.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class Qk{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Yk{constructor(e){this.key=e,this.va=!1}}class Jk{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new br(a=>AI(a),_c),this.Ma=new Map,this.xa=new Set,this.Oa=new ve(q.comparator),this.Na=new Map,this.La=new Mp,this.Ba={},this.ka=new Map,this.qa=pi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Xk(n,e,t=!0){const r=Cc(n);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await kT(r,e,t,!0),i}async function Zk(n,e){const t=Cc(n);await kT(t,e,!0,!1)}async function kT(n,e,t,r){const i=await Mu(n.localStore,Nt(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return r&&(a=await Jp(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Pc(n.remoteStore,i),a}async function Jp(n,e,t,r,i){n.Ka=(p,m,E)=>async function(D,L,C,S){let P=L.view.ma(C);P.ns&&(P=await pf(D.localStore,L.query,!1).then(({documents:_})=>L.view.ma(_,P)));const V=S&&S.targetChanges.get(L.targetId),M=S&&S.targetMismatches.get(L.targetId)!=null,k=L.view.applyChanges(P,D.isPrimaryClient,V,M);return _f(D,L.targetId,k.wa),k.snapshot}(n,p,m,E);const s=await pf(n.localStore,e,!0),o=new Hk(e,s.Ts),a=o.ma(s.documents),u=Ma.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),c=o.applyChanges(a,n.isPrimaryClient,u);_f(n,t,c.wa);const d=new Qk(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),c.snapshot}async function e1(n,e,t){const r=W(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!_c(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ss(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&As(r.remoteStore,i.targetId),Ps(r,i.targetId)}).catch(kr)):(Ps(r,i.targetId),await Ss(r.localStore,i.targetId,!0))}async function t1(n,e){const t=W(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),As(t.remoteStore,r.targetId))}async function n1(n,e,t){const r=tm(n);try{const i=await function(o,a){const u=W(o),c=ke.now(),d=a.reduce((E,R)=>E.add(R.key),re());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",E=>{let R=Dt(),D=re();return u.cs.getEntries(E,d).next(L=>{R=L,R.forEach((C,S)=>{S.isValidDocument()||(D=D.add(C))})}).next(()=>u.localDocuments.getOverlayedDocuments(E,R)).next(L=>{p=L;const C=[];for(const S of a){const P=Rx(S,p.get(S.key).overlayedDocument);P!=null&&C.push(new Un(S.key,P,mI(P.value.mapValue),ze.exists(!0)))}return u.mutationQueue.addMutationBatch(E,c,C,a)}).next(L=>{m=L;const C=L.applyToLocalDocumentSet(p,D);return u.documentOverlayCache.saveOverlays(E,L.batchId,C)})}).then(()=>({batchId:m.batchId,changes:xI(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let c=o.Ba[o.currentUser.toKey()];c||(c=new ve(ee)),c=c.insert(a,u),o.Ba[o.currentUser.toKey()]=c}(r,i.batchId,t),await Nr(r,i.changes),await Fs(r.remoteStore)}catch(i){const s=Gp(i,"Failed to persist write");t.reject(s)}}async function DT(n,e){const t=W(n);try{const r=await Ik(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Na.get(s);o&&(H(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?H(o.va):i.removedDocuments.size>0&&(H(o.va),o.va=!1))}),await Nr(t,r,e)}catch(r){await kr(r)}}function $_(n,e,t){const r=W(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Fa.forEach((s,o)=>{const a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const u=W(o);u.onlineState=a;let c=!1;u.queries.forEach((d,p)=>{for(const m of p.j_)m.Z_(a)&&(c=!0)}),c&&Qp(u)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function r1(n,e,t){const r=W(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new ve(q.comparator);o=o.insert(s,Ae.newNoDocument(s,Y.min()));const a=re().add(s),u=new La(Y.min(),new Map,new ve(ee),o,a);await DT(r,u),r.Oa=r.Oa.remove(s),r.Na.delete(e),em(r)}else await Ss(r.localStore,e,!1).then(()=>Ps(r,e,t)).catch(kr)}async function i1(n,e){const t=W(n),r=e.batch.batchId;try{const i=await Ek(t.localStore,e);Zp(t,r,null),Xp(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Nr(t,i)}catch(i){await kr(i)}}async function s1(n,e,t){const r=W(n);try{const i=await function(o,a){const u=W(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return u.mutationQueue.lookupMutationBatch(c,a).next(p=>(H(p!==null),d=p.keys(),u.mutationQueue.removeMutationBatch(c,p))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>u.localDocuments.getDocuments(c,d))})}(r.localStore,e);Zp(r,e,t),Xp(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Nr(r,i)}catch(i){await kr(i)}}function Xp(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Zp(n,e,t){const r=W(n);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Ps(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||bT(n,r)})}function bT(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(As(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),em(n))}function _f(n,e,t){for(const r of t)r instanceof CT?(n.La.addReference(r.key,e),o1(n,r)):r instanceof xT?(j("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||bT(n,r.key)):K()}function o1(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(j("SyncEngine","New document in limbo: "+t),n.xa.add(r),em(n))}function em(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new q(he.fromString(e)),r=n.qa.next();n.Na.set(r,new Yk(t)),n.Oa=n.Oa.insert(t,r),Pc(n.remoteStore,new Sn(Nt(Va(t.path)),r,"TargetPurposeLimboResolution",Tt.oe))}}async function Nr(n,e,t){const r=W(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,u)=>{o.push(r.Ka(u,e,t).then(c=>{var d;if((c||t)&&r.isPrimaryClient){const p=c?!c.fromCache:(d=t==null?void 0:t.targetChanges.get(u.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(c){i.push(c);const p=jp.Wi(u.targetId,c);s.push(p)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(u,c){const d=W(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>N.forEach(c,m=>N.forEach(m.$i,E=>d.persistence.referenceDelegate.addReference(p,m.targetId,E)).next(()=>N.forEach(m.Ui,E=>d.persistence.referenceDelegate.removeReference(p,m.targetId,E)))))}catch(p){if(!Dr(p))throw p;j("LocalStore","Failed to update sequence numbers: "+p)}for(const p of c){const m=p.targetId;if(!p.fromCache){const E=d.os.get(m),R=E.snapshotVersion,D=E.withLastLimboFreeSnapshotVersion(R);d.os=d.os.insert(m,D)}}}(r.localStore,s))}async function a1(n,e){const t=W(n);if(!t.currentUser.isEqual(e)){j("SyncEngine","User change. New user:",e.toKey());const r=await mT(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(u=>{u.reject(new z(F.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Nr(t,r.hs)}}function l1(n,e){const t=W(n),r=t.Na.get(e);if(r&&r.va)return re().add(r.key);{let i=re();const s=t.Ma.get(e);if(!s)return i;for(const o of s){const a=t.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}async function u1(n,e){const t=W(n),r=await pf(t.localStore,e.query,!0),i=e.view.ba(r);return t.isPrimaryClient&&_f(t,e.targetId,i.wa),i}async function c1(n,e){const t=W(n);return _T(t.localStore,e).then(r=>Nr(t,r))}async function h1(n,e,t,r){const i=W(n),s=await function(a,u){const c=W(a),d=W(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",p=>d.Mn(p,u).next(m=>m?c.localDocuments.getDocuments(p,m):N.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?await Fs(i.remoteStore):t==="acknowledged"||t==="rejected"?(Zp(i,e,r||null),Xp(i,e),function(a,u){W(W(a).mutationQueue).On(u)}(i.localStore,e)):K(),await Nr(i,s)):j("SyncEngine","Cannot apply mutation batch with id: "+e)}async function d1(n,e){const t=W(n);if(Cc(t),tm(t),e===!0&&t.Qa!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await q_(t,r.toArray());t.Qa=!0,await gf(t.remoteStore,!0);for(const s of i)Pc(t.remoteStore,s)}else if(e===!1&&t.Qa!==!1){const r=[];let i=Promise.resolve();t.Ma.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Ps(t,o),Ss(t.localStore,o,!0))),As(t.remoteStore,o)}),await i,await q_(t,r),function(o){const a=W(o);a.Na.forEach((u,c)=>{As(a.remoteStore,c)}),a.La.pr(),a.Na=new Map,a.Oa=new ve(q.comparator)}(t),t.Qa=!1,await gf(t.remoteStore,!1)}}async function q_(n,e,t){const r=W(n),i=[],s=[];for(const o of e){let a;const u=r.Ma.get(o);if(u&&u.length!==0){a=await Mu(r.localStore,Nt(u[0]));for(const c of u){const d=r.Fa.get(c),p=await u1(r,d);p.snapshot&&s.push(p.snapshot)}}else{const c=await yT(r.localStore,o);a=await Mu(r.localStore,c),await Jp(r,NT(c),o,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(s),i}function NT(n){return TI(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function f1(n){return function(t){return W(W(t).persistence).Qi()}(W(n).localStore)}async function p1(n,e,t,r){const i=W(n);if(i.Qa)return void j("SyncEngine","Ignoring unexpected query state notification.");const s=i.Ma.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=await _T(i.localStore,RI(s[0])),a=La.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Me.EMPTY_BYTE_STRING);await Nr(i,o,a);break}case"rejected":await Ss(i.localStore,e,!0),Ps(i,e,r);break;default:K()}}async function m1(n,e,t){const r=Cc(n);if(r.Qa){for(const i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){j("SyncEngine","Adding an already active target "+i);continue}const s=await yT(r.localStore,i),o=await Mu(r.localStore,s);await Jp(r,NT(s),o.targetId,!1,o.resumeToken),Pc(r.remoteStore,o)}for(const i of t)r.Ma.has(i)&&await Ss(r.localStore,i,!1).then(()=>{As(r.remoteStore,i),Ps(r,i)}).catch(kr)}}function Cc(n){const e=W(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=DT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=l1.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=r1.bind(null,e),e.Ca.d_=Gk.bind(null,e.eventManager),e.Ca.$a=Wk.bind(null,e.eventManager),e}function tm(n){const e=W(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=i1.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=s1.bind(null,e),e}class Ea{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ac(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return pT(this.persistence,new fT,e.initialUser,this.serializer)}Ga(e){return new hT(Sc.Zr,this.serializer)}Wa(e){return new wT}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ea.provider={build:()=>new Ea};class VT extends Ea{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await tm(this.Ja.syncEngine),await Fs(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return pT(this.persistence,new fT,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new rk(r,e.asyncQueue,t)}Ha(e,t){const r=new LC(t,this.persistence);return new OC(e.asyncQueue,r)}Ga(e){const t=dT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?wt.withCacheSize(this.cacheSizeBytes):wt.DEFAULT;return new Fp(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,ET(),eu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new wT}}class g1 extends VT{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof Kh&&(this.sharedClientState.syncEngine={no:h1.bind(null,t),ro:p1.bind(null,t),io:m1.bind(null,t),Qi:f1.bind(null,t),eo:c1.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await d1(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const t=ET();if(!Kh.D(t))throw new z(F.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=dT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Kh(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Ia{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>$_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=a1.bind(null,this.syncEngine),await gf(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Kk}()}createDatastore(e){const t=Ac(e.databaseInfo.databaseId),r=function(s){return new Ck(s)}(e.databaseInfo);return function(s,o,a,u){return new Dk(s,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new Nk(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>$_(this.syncEngine,t,0),function(){return F_.D()?new F_:new Ak}())}createSyncEngine(e,t){return function(i,s,o,a,u,c,d){const p=new Jk(i,s,o,a,u,c);return d&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=W(i);j("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Fa(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Ia.provider={build:()=>new Ia};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Le("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new z(F.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(i,s){const o=W(i),a={documents:s.map(p=>va(o.serializer,p))},u=await o.Lo("BatchGetDocuments",o.serializer.databaseId,he.emptyPath(),a,s.length),c=new Map;u.forEach(p=>{const m=Mx(o.serializer,p);c.set(m.key.toString(),m)});const d=[];return s.forEach(p=>{const m=c.get(p.toString());H(!!m),d.push(m)}),d}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ec(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const i=q.fromPath(r);this.mutations.push(new xp(i,this.precondition(i)))}),await async function(r,i){const s=W(r),o={writes:i.map(a=>wa(s.serializer,a))};await s.Mo("Commit",s.serializer.databaseId,he.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw K();t=Y.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new z(F.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Y.min())?ze.exists(!1):ze.updateTime(t):ze.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Y.min()))throw new z(F.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ze.updateTime(t)}return ze.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this._u=r.maxAttempts,this.t_=new Bp(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new y1(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const t=this.updateFunction(e);return!ba(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!jI(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ut.UNAUTHENTICATED,this.clientId=ZE.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{j("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(j("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Jt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Gp(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Wh(n,e){n.asyncQueue.verifyOperationInProgress(),j("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await mT(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function K_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await w1(n);j("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>j_(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>j_(e.remoteStore,i)),n._onlineComponents=e}async function w1(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){j("FirestoreClient","Using user provided OfflineComponentProvider");try{await Wh(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===F.FAILED_PRECONDITION||i.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;ua("Error using user provided cache. Falling back to memory cache: "+t),await Wh(n,new Ea)}}else j("FirestoreClient","Using default OfflineComponentProvider"),await Wh(n,new Ea);return n._offlineComponents}async function rm(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(j("FirestoreClient","Using user provided OnlineComponentProvider"),await K_(n,n._uninitializedComponentsProvider._online)):(j("FirestoreClient","Using default OnlineComponentProvider"),await K_(n,new Ia))),n._onlineComponents}function E1(n){return rm(n).then(e=>e.syncEngine)}function I1(n){return rm(n).then(e=>e.datastore)}async function Bu(n){const e=await rm(n),t=e.eventManager;return t.onListen=Xk.bind(null,e.syncEngine),t.onUnlisten=e1.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Zk.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=t1.bind(null,e.syncEngine),t}function T1(n,e,t={}){const r=new Jt;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,u,c){const d=new nm({next:m=>{d.Za(),o.enqueueAndForget(()=>Hp(s,p));const E=m.docs.has(a);!E&&m.fromCache?c.reject(new z(F.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&m.fromCache&&u&&u.source==="server"?c.reject(new z(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),p=new Yp(Va(a.path),d,{includeMetadataChanges:!0,_a:!0});return Wp(s,p)}(await Bu(n),n.asyncQueue,e,t,r)),r.promise}function S1(n,e,t={}){const r=new Jt;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,u,c){const d=new nm({next:m=>{d.Za(),o.enqueueAndForget(()=>Hp(s,p)),m.fromCache&&u.source==="server"?c.reject(new z(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),p=new Yp(a,d,{includeMetadataChanges:!0,_a:!0});return Wp(s,p)}(await Bu(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OT(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LT(n,e,t){if(!t)throw new z(F.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function A1(n,e,t,r){if(e===!0&&r===!0)throw new z(F.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function W_(n){if(!q.isDocumentKey(n))throw new z(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function H_(n){if(q.isDocumentKey(n))throw new z(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function xc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":K()}function Xt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new z(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=xc(n);throw new z(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new z(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new z(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}A1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=OT((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new z(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new z(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new z(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class im{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Q_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new z(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new z(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Q_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new AC;switch(r.type){case"firstParty":return new CC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new z(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=G_.get(t);r&&(j("ComponentProvider","Removing Datastore"),G_.delete(t),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Vr(this.firestore,e,this._query)}}class ht{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ht(this.firestore,e,this._key)}}class vr extends Vr{constructor(e,t,r){super(e,t,Va(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ht(this.firestore,null,new q(e))}withConverter(e){return new vr(this.firestore,e,this._path)}}function dn(n,e,...t){if(n=Ue(n),LT("collection","path",e),n instanceof im){const r=he.fromString(e,...t);return H_(r),new vr(n,null,r)}{if(!(n instanceof ht||n instanceof vr))throw new z(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(he.fromString(e,...t));return H_(r),new vr(n.firestore,null,r)}}function Ei(n,e,...t){if(n=Ue(n),arguments.length===1&&(e=ZE.newId()),LT("doc","path",e),n instanceof im){const r=he.fromString(e,...t);return W_(r),new ht(n,null,new q(r))}{if(!(n instanceof ht||n instanceof vr))throw new z(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(he.fromString(e,...t));return W_(r),new ht(n.firestore,n instanceof vr?n.converter:null,new q(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Bp(this,"async_queue_retry"),this.Vu=()=>{const r=eu();r&&j("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=eu();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=eu();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new Jt;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Dr(e))throw e;j("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Le("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=Kp.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&K()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function J_(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class Rr extends im{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Y_,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Y_(e),this._firestoreClient=void 0,await e}}}function R1(n,e,t){t||(t="(default)");const r=vp(n,"firestore");if(r.isInitialized(t)){const i=r.getImmediate({identifier:t}),s=r.getOptions(t);if(aa(s,e))return i;throw new z(F.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new z(F.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new z(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:t})}function ja(n){if(n._terminated)throw new z(F.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||P1(n),n._firestoreClient}function P1(n){var e,t,r;const i=n._freezeSettings(),s=function(a,u,c,d){return new rx(a,u,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,OT(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new v1(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(a){const u=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(u),_online:u}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new mi(Me.fromBase64String(e))}catch(t){throw new z(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new mi(Me.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new z(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ce(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sm{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new z(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new z(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C1=/^__.*__$/;class x1{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Un(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ms(e,this.data,t,this.fieldTransforms)}}class MT{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Un(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function FT(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw K()}}class am{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new am(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return zu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(FT(this.Cu)&&C1.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class k1{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ac(e)}Qu(e,t,r,i=!1){return new am({Cu:e,methodName:t,qu:r,path:Ce.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function bc(n){const e=n._freezeSettings(),t=Ac(n._databaseId);return new k1(n._databaseId,!!e.ignoreUndefinedProperties,t)}function lm(n,e,t,r,i,s={}){const o=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);cm("Data must be an object, but it was:",o,r);const a=jT(r,o);let u,c;if(s.merge)u=new St(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const p of s.mergeFields){const m=vf(e,p,t);if(!o.contains(m))throw new z(F.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);BT(d,m)||d.push(m)}u=new St(d),c=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,c=o.fieldTransforms;return new x1(new Ze(a),u,c)}class Nc extends Dc{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Nc}}class um extends Dc{_toFieldTransform(e){return new LI(e.path,new ws)}isEqual(e){return e instanceof um}}function D1(n,e,t,r){const i=n.Qu(1,e,t);cm("Data must be an object, but it was:",i,r);const s=[],o=Ze.empty();vi(r,(u,c)=>{const d=hm(e,u,t);c=Ue(c);const p=i.Nu(d);if(c instanceof Nc)s.push(d);else{const m=Ua(c,p);m!=null&&(s.push(d),o.set(d,m))}});const a=new St(s);return new MT(o,a,i.fieldTransforms)}function b1(n,e,t,r,i,s){const o=n.Qu(1,e,t),a=[vf(e,r,t)],u=[i];if(s.length%2!=0)throw new z(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(vf(e,s[m])),u.push(s[m+1]);const c=[],d=Ze.empty();for(let m=a.length-1;m>=0;--m)if(!BT(c,a[m])){const E=a[m];let R=u[m];R=Ue(R);const D=o.Nu(E);if(R instanceof Nc)c.push(E);else{const L=Ua(R,D);L!=null&&(c.push(E),d.set(E,L))}}const p=new St(c);return new MT(d,p,o.fieldTransforms)}function N1(n,e,t,r=!1){return Ua(t,n.Qu(r?4:3,e))}function Ua(n,e){if(UT(n=Ue(n)))return cm("Unsupported field value:",e,n),jT(n,e);if(n instanceof Dc)return function(r,i){if(!FT(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let u=Ua(a,i.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Ue(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return wx(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=ke.fromDate(r);return{timestampValue:Ts(i.serializer,s)}}if(r instanceof ke){const s=new ke(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ts(i.serializer,s)}}if(r instanceof sm)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof mi)return{bytesValue:$I(i.serializer,r._byteString)};if(r instanceof ht){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Vp(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof om)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Bu("VectorValues must only contain numeric values.");return Cp(a.serializer,u)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${xc(r)}`)}(n,e)}function jT(n,e){const t={};return hI(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):vi(n,(r,i)=>{const s=Ua(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function UT(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ke||n instanceof sm||n instanceof mi||n instanceof ht||n instanceof Dc||n instanceof om)}function cm(n,e,t){if(!UT(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=xc(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function vf(n,e,t){if((e=Ue(e))instanceof kc)return e._internalPath;if(typeof e=="string")return hm(n,e);throw zu("Field path arguments must be of type string or ",n,!1,void 0,t)}const V1=new RegExp("[~\\*/\\[\\]]");function hm(n,e,t){if(e.search(V1)>=0)throw zu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new kc(...e.split("."))._internalPath}catch{throw zu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function zu(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new z(F.INVALID_ARGUMENT,a+n+u)}function BT(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ht(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new O1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Vc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class O1 extends $u{data(){return super.data()}}function Vc(n,e){return typeof e=="string"?hm(n,e):e instanceof kc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zT(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new z(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dm{}class $T extends dm{}function Cs(n,e,...t){let r=[];e instanceof dm&&r.push(e),r=r.concat(t),function(s){const o=s.filter(u=>u instanceof fm).length,a=s.filter(u=>u instanceof Oc).length;if(o>1||o>0&&a>0)throw new z(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class Oc extends $T{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Oc(e,t,r)}_apply(e){const t=this._parse(e);return qT(e._query,t),new Vr(e.firestore,e.converter,sf(e._query,t))}_parse(e){const t=bc(e.firestore);return function(s,o,a,u,c,d,p){let m;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new z(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){Z_(p,d);const E=[];for(const R of p)E.push(X_(u,s,R));m={arrayValue:{values:E}}}else m=X_(u,s,p)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||Z_(p,d),m=N1(a,o,p,d==="in"||d==="not-in");return ae.create(c,d,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function xs(n,e,t){const r=e,i=Vc("where",n);return Oc._create(i,r,t)}class fm extends dm{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new fm(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:fe.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const u of a)qT(o,u),o=sf(o,u)}(e._query,t),new Vr(e.firestore,e.converter,sf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class pm extends $T{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new pm(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new z(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new z(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ya(s,o)}(e._query,this._field,this._direction);return new Vr(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Ls(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function qu(n,e="asc"){const t=e,r=Vc("orderBy",n);return pm._create(r,t)}function X_(n,e,t){if(typeof(t=Ue(t))=="string"){if(t==="")throw new z(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!SI(e)&&t.indexOf("/")!==-1)throw new z(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(he.fromString(t));if(!q.isDocumentKey(r))throw new z(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ma(n,new q(r))}if(t instanceof ht)return ma(n,t._key);throw new z(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${xc(t)}.`)}function Z_(n,e){if(!Array.isArray(n)||n.length===0)throw new z(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function qT(n,e){const t=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new z(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new z(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class KT{convertValue(e,t="none"){switch(ci(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Te(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Tr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw K()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return vi(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;const s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Te(o.doubleValue));return new om(s)}convertGeoPoint(e){return new sm(Te(e.latitude),Te(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Ap(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(fa(e));default:return null}}convertTimestamp(e){const t=On(e);return new ke(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=he.fromString(e);H(ZI(r));const i=new ui(r.get(1),r.get(3)),s=new q(r.popFirst(5));return i.isEqual(t)||Le(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mm(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class L1 extends KT{constructor(e){super(),this.firestore=e}convertBytes(e){return new mi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ht(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class gm extends $u{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new tu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Vc("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class tu extends gm{data(e={}){return super.data(e)}}class GT{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Qi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new tu(this._firestore,this._userDataWriter,r.key,r,new Qi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new z(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const u=new tu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Qi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const u=new tu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Qi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:M1(a.type),doc:u,oldIndex:c,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function M1(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return K()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(n){n=Xt(n,ht);const e=Xt(n.firestore,Rr);return T1(ja(e),n._key).then(t=>YT(e,n,t))}class Lc extends KT{constructor(e){super(),this.firestore=e}convertBytes(e){return new mi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ht(this.firestore,null,t)}}function Ku(n){n=Xt(n,Vr);const e=Xt(n.firestore,Rr),t=ja(e),r=new Lc(e);return zT(n._query),S1(t,n._query).then(i=>new GT(e,r,n,i))}function HT(n,e,t){n=Xt(n,ht);const r=Xt(n.firestore,Rr),i=mm(n.converter,e,t);return QT(r,[lm(bc(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,ze.none())])}function Mc(n,e){const t=Xt(n.firestore,Rr),r=Ei(n),i=mm(n.converter,e);return QT(t,[lm(bc(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,ze.exists(!1))]).then(()=>r)}function zo(n,...e){var t,r,i;n=Ue(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||J_(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(J_(e[o])){const p=e[o];e[o]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let u,c,d;if(n instanceof ht)c=Xt(n.firestore,Rr),d=Va(n._key.path),u={next:p=>{e[o]&&e[o](YT(c,n,p))},error:e[o+1],complete:e[o+2]};else{const p=Xt(n,Vr);c=Xt(p.firestore,Rr),d=p._query;const m=new Lc(c);u={next:E=>{e[o]&&e[o](new GT(c,m,p,E))},error:e[o+1],complete:e[o+2]},zT(n._query)}return function(m,E,R,D){const L=new nm(D),C=new Yp(E,L,R);return m.asyncQueue.enqueueAndForget(async()=>Wp(await Bu(m),C)),()=>{L.Za(),m.asyncQueue.enqueueAndForget(async()=>Hp(await Bu(m),C))}}(ja(c),d,a,u)}function QT(n,e){return function(r,i){const s=new Jt;return r.asyncQueue.enqueueAndForget(async()=>n1(await E1(r),i,s)),s.promise}(ja(n),e)}function YT(n,e,t){const r=t.docs.get(e._key),i=new Lc(n);return new gm(n,i,e._key,r,new Qi(t.hasPendingWrites,t.fromCache),e.converter)}class F1{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=z1(),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function j1(n){return new F1(n)}class U1{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ia.provider,this._offlineComponentProvider={build:t=>new VT(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class B1{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ia.provider,this._offlineComponentProvider={build:t=>new g1(t,e==null?void 0:e.cacheSizeBytes)}}}function z1(n){return new U1(void 0)}function $1(){return new B1}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q1={maxAttempts:5};function mo(n,e){if((n=Ue(n)).firestore!==e)throw new z(F.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1 extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=bc(t)}get(t){const r=mo(t,this._firestore),i=new L1(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return K();const o=s[0];if(o.isFoundDocument())return new $u(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new $u(this._firestore,i,r._key,null,r.converter);throw K()})}set(t,r,i){const s=mo(t,this._firestore),o=mm(s.converter,r,i),a=lm(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){const o=mo(t,this._firestore);let a;return a=typeof(r=Ue(r))=="string"||r instanceof kc?b1(this._dataReader,"Transaction.update",o._key,r,i,s):D1(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){const r=mo(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=mo(e,this._firestore),r=new Lc(this._firestore);return super.get(e).then(i=>new gm(this._firestore,r,t._key,i._document,new Qi(!1,!1),t.converter))}}function G1(n,e,t){n=Xt(n,Rr);const r=Object.assign(Object.assign({},q1),t);return function(s){if(s.maxAttempts<1)throw new z(F.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const u=new Jt;return s.asyncQueue.enqueueAndForget(async()=>{const c=await I1(s);new _1(s.asyncQueue,c,a,o,u).au()}),u.promise}(ja(n),i=>e(new K1(n,i)),r)}function Ln(){return new um("serverTimestamp")}(function(e,t=!0){(function(i){Os=i})(Vs),ms(new ai("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Rr(new RC(r.getProvider("auth-internal")),new kC(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new z(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ui(c.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),yr(Ky,"4.7.3",e),yr(Ky,"4.7.3","esm2017")})();function ym(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function JT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const W1=JT,XT=new ka("auth","Firebase",JT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gu=new yp("@firebase/auth");function H1(n,...e){Gu.logLevel<=oe.WARN&&Gu.warn(`Auth (${Vs}): ${n}`,...e)}function nu(n,...e){Gu.logLevel<=oe.ERROR&&Gu.error(`Auth (${Vs}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(n,...e){throw _m(n,...e)}function un(n,...e){return _m(n,...e)}function ZT(n,e,t){const r=Object.assign(Object.assign({},W1()),{[e]:t});return new ka("auth","Firebase",r).create(e,{appName:n.name})}function wr(n){return ZT(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function _m(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return XT.create(n,...e)}function X(n,e,...t){if(!n)throw _m(e,...t)}function An(n){const e="INTERNAL ASSERTION FAILED: "+n;throw nu(e),new Error(e)}function Mn(n,e){n||An(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Q1(){return ev()==="http:"||ev()==="https:"}function ev(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y1(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Q1()||rP()||"connection"in navigator)?navigator.onLine:!0}function J1(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(e,t){this.shortDelay=e,this.longDelay=t,Mn(t>e,"Short delay should be less than long delay!"),this.isMobile=eP()||iP()}get(){return Y1()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vm(n,e){Mn(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;An("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;An("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;An("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X1={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z1=new Ba(3e4,6e4);function Ii(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Or(n,e,t,r,i={}){return t0(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Da(Object.assign({key:n.config.apiKey},o)).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const c=Object.assign({method:e,headers:u},s);return nP()||(c.referrerPolicy="no-referrer"),e0.fetch()(n0(n,n.config.apiHost,t,a),c)})}async function t0(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},X1),e);try{const i=new tD(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Dl(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[u,c]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Dl(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Dl(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Dl(n,"user-disabled",o);const d=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw ZT(n,d,c);en(n,d)}}catch(i){if(i instanceof jn)throw i;en(n,"network-request-failed",{message:String(i)})}}async function Fc(n,e,t,r,i={}){const s=await Or(n,e,t,r,i);return"mfaPendingCredential"in s&&en(n,"multi-factor-auth-required",{_serverResponse:s}),s}function n0(n,e,t,r){const i=`${e}${t}?${r}`;return n.config.emulator?vm(n.config,i):`${n.config.apiScheme}://${i}`}function eD(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class tD{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(un(this.auth,"network-request-failed")),Z1.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Dl(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=un(n,e,r);return i.customData._tokenResponse=t,i}function tv(n){return n!==void 0&&n.enterprise!==void 0}class nD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return eD(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function rD(n,e){return Or(n,"GET","/v2/recaptchaConfig",Ii(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iD(n,e){return Or(n,"POST","/v1/accounts:delete",e)}async function r0(n,e){return Or(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $o(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function sD(n,e=!1){const t=Ue(n),r=await t.getIdToken(e),i=wm(r);X(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:$o(Hh(i.auth_time)),issuedAtTime:$o(Hh(i.iat)),expirationTime:$o(Hh(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Hh(n){return Number(n)*1e3}function wm(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return nu("JWT malformed, contained fewer than 3 sections"),null;try{const i=ME(t);return i?JSON.parse(i):(nu("Failed to decode base64 JWT payload"),null)}catch(i){return nu("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function nv(n){const e=wm(n);return X(e,"internal-error"),X(typeof e.exp<"u","internal-error"),X(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ta(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof jn&&oD(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function oD({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=$o(this.lastLoginAt),this.creationTime=$o(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wu(n){var e;const t=n.auth,r=await n.getIdToken(),i=await Ta(n,r0(t,{idToken:r}));X(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?i0(s.providerUserInfo):[],a=uD(n.providerData,o),u=n.isAnonymous,c=!(n.email&&s.passwordHash)&&!(a!=null&&a.length),d=u?c:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Ef(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,p)}async function lD(n){const e=Ue(n);await Wu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function uD(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function i0(n){return n.map(e=>{var{providerId:t}=e,r=ym(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cD(n,e){const t=await t0(n,{},async()=>{const r=Da({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=n0(n,i,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",e0.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function hD(n,e){return Or(n,"POST","/v2/accounts:revokeToken",Ii(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){X(e.idToken,"internal-error"),X(typeof e.idToken<"u","internal-error"),X(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):nv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){X(e.length!==0,"internal-error");const t=nv(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(X(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await cD(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new ss;return r&&(X(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(X(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(X(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ss,this.toJSON())}_performRefresh(){return An("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wn(n,e){X(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Rn{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=ym(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new aD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ef(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Ta(this,this.stsTokenManager.getToken(this.auth,e));return X(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return sD(this,e)}reload(){return lD(this)}_assign(e){this!==e&&(X(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Rn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){X(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Wu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Tn(this.auth.app))return Promise.reject(wr(this.auth));const e=await this.getIdToken();return await Ta(this,iD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,u,c,d;const p=(r=t.displayName)!==null&&r!==void 0?r:void 0,m=(i=t.email)!==null&&i!==void 0?i:void 0,E=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,R=(o=t.photoURL)!==null&&o!==void 0?o:void 0,D=(a=t.tenantId)!==null&&a!==void 0?a:void 0,L=(u=t._redirectEventId)!==null&&u!==void 0?u:void 0,C=(c=t.createdAt)!==null&&c!==void 0?c:void 0,S=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:P,emailVerified:V,isAnonymous:M,providerData:k,stsTokenManager:_}=t;X(P&&_,e,"internal-error");const g=ss.fromJSON(this.name,_);X(typeof P=="string",e,"internal-error"),Wn(p,e.name),Wn(m,e.name),X(typeof V=="boolean",e,"internal-error"),X(typeof M=="boolean",e,"internal-error"),Wn(E,e.name),Wn(R,e.name),Wn(D,e.name),Wn(L,e.name),Wn(C,e.name),Wn(S,e.name);const I=new Rn({uid:P,auth:e,email:m,emailVerified:V,displayName:p,isAnonymous:M,photoURL:R,phoneNumber:E,tenantId:D,stsTokenManager:g,createdAt:C,lastLoginAt:S});return k&&Array.isArray(k)&&(I.providerData=k.map(T=>Object.assign({},T))),L&&(I._redirectEventId=L),I}static async _fromIdTokenResponse(e,t,r=!1){const i=new ss;i.updateFromServerResponse(t);const s=new Rn({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Wu(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];X(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?i0(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new ss;a.updateFromIdToken(r);const u=new Rn({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ef(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(u,c),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rv=new Map;function Pn(n){Mn(n instanceof Function,"Expected a class definition");let e=rv.get(n);return e?(Mn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,rv.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}s0.type="NONE";const iv=s0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ru(n,e,t){return`firebase:${n}:${e}:${t}`}class os{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=ru(this.userKey,i.apiKey,s),this.fullPersistenceKey=ru("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Rn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new os(Pn(iv),e,r);const i=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Pn(iv);const o=ru(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const d=await c._get(o);if(d){const p=Rn._fromJSON(e,d);c!==s&&(a=p),s=c;break}}catch{}const u=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new os(s,e,r):(s=u[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new os(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sv(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(u0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(o0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(h0(e))return"Blackberry";if(d0(e))return"Webos";if(a0(e))return"Safari";if((e.includes("chrome/")||l0(e))&&!e.includes("edge/"))return"Chrome";if(c0(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function o0(n=qe()){return/firefox\//i.test(n)}function a0(n=qe()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function l0(n=qe()){return/crios\//i.test(n)}function u0(n=qe()){return/iemobile/i.test(n)}function c0(n=qe()){return/android/i.test(n)}function h0(n=qe()){return/blackberry/i.test(n)}function d0(n=qe()){return/webos/i.test(n)}function Em(n=qe()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function dD(n=qe()){var e;return Em(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function fD(){return sP()&&document.documentMode===10}function f0(n=qe()){return Em(n)||c0(n)||d0(n)||h0(n)||/windows phone/i.test(n)||u0(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0(n,e=[]){let t;switch(n){case"Browser":t=sv(qe());break;case"Worker":t=`${sv(qe())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Vs}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((o,a)=>{try{const u=e(s);o(u)}catch(u){a(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mD(n,e={}){return Or(n,"GET","/v2/passwordPolicy",Ii(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gD=6;class yD{constructor(e){var t,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:gD,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(t=u.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(s=u.containsUppercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(a=u.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),u}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ov(this),this.idTokenSubscription=new ov(this),this.beforeStateQueue=new pD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=XT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Pn(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await os.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await r0(this,{idToken:e}),r=await Rn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Tn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i==null?void 0:i._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===a)&&(u!=null&&u.user)&&(i=u.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return X(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Wu(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=J1()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Tn(this.app))return Promise.reject(wr(this));const t=e?Ue(e):null;return t&&X(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&X(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Tn(this.app)?Promise.reject(wr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Tn(this.app)?Promise.reject(wr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Pn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await mD(this),t=new yD(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ka("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await hD(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Pn(e)||this._popupRedirectResolver;X(t,this,"argument-error"),this.redirectPersistenceManager=await os.create(this,[Pn(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(X(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return X(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=p0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&H1(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Us(n){return Ue(n)}class ov{constructor(e){this.auth=e,this.observer=null,this.addObserver=hP(t=>this.observer=t)}get next(){return X(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function vD(n){jc=n}function m0(n){return jc.loadJS(n)}function wD(){return jc.recaptchaEnterpriseScript}function ED(){return jc.gapiScript}function ID(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const TD="recaptcha-enterprise",SD="NO_RECAPTCHA";class AD{constructor(e){this.type=TD,this.auth=Us(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{rD(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new nD(u);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,o(c.siteKey)}}).catch(u=>{a(u)})})}function i(s,o,a){const u=window.grecaptcha;tv(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:e}).then(c=>{o(c)}).catch(()=>{o(SD)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&tv(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=wD();u.length!==0&&(u+=a),m0(u).then(()=>{i(a,s,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function av(n,e,t,r=!1){const i=new AD(n);let s;try{s=await i.verify(t)}catch{s=await i.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function lv(n,e,t,r){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await av(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await av(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RD(n,e){const t=vp(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(aa(s,e??{}))return i;en(i,"already-initialized")}return t.initialize({options:e})}function PD(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Pn);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function CD(n,e,t){const r=Us(n);X(r._canInitEmulator,r,"emulator-config-failed"),X(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=g0(e),{host:o,port:a}=xD(e),u=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),kD()}function g0(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function xD(n){const e=g0(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:uv(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:uv(o)}}}function uv(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function kD(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Im{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return An("not implemented")}_getIdTokenResponse(e){return An("not implemented")}_linkToIdToken(e,t){return An("not implemented")}_getReauthenticationResolver(e){return An("not implemented")}}async function DD(n,e){return Or(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bD(n,e){return Fc(n,"POST","/v1/accounts:signInWithPassword",Ii(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ND(n,e){return Fc(n,"POST","/v1/accounts:signInWithEmailLink",Ii(n,e))}async function VD(n,e){return Fc(n,"POST","/v1/accounts:signInWithEmailLink",Ii(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa extends Im{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Sa(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Sa(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return lv(e,t,"signInWithPassword",bD);case"emailLink":return ND(e,{email:this._email,oobCode:this._password});default:en(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return lv(e,r,"signUpPassword",DD);case"emailLink":return VD(e,{idToken:t,email:this._email,oobCode:this._password});default:en(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function as(n,e){return Fc(n,"POST","/v1/accounts:signInWithIdp",Ii(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OD="http://localhost";class gi extends Im{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new gi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):en("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=ym(t,["providerId","signInMethod"]);if(!r||!i)return null;const o=new gi(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return as(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,as(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,as(e,t)}buildRequest(){const e={requestUri:OD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Da(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LD(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function MD(n){const e=Eo(Io(n)).link,t=e?Eo(Io(e)).deep_link_id:null,r=Eo(Io(n)).deep_link_id;return(r?Eo(Io(r)).link:null)||r||t||e||n}class Tm{constructor(e){var t,r,i,s,o,a;const u=Eo(Io(e)),c=(t=u.apiKey)!==null&&t!==void 0?t:null,d=(r=u.oobCode)!==null&&r!==void 0?r:null,p=LD((i=u.mode)!==null&&i!==void 0?i:null);X(c&&d&&p,"argument-error"),this.apiKey=c,this.operation=p,this.code=d,this.continueUrl=(s=u.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=u.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=u.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=MD(e);try{return new Tm(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(){this.providerId=Bs.PROVIDER_ID}static credential(e,t){return Sa._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Tm.parseLink(t);return X(r,"argument-error"),Sa._fromEmailAndCode(e,r.code,r.tenantId)}}Bs.PROVIDER_ID="password";Bs.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Bs.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za extends y0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn extends za{constructor(){super("facebook.com")}static credential(e){return gi._fromParams({providerId:Zn.PROVIDER_ID,signInMethod:Zn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zn.credentialFromTaggedObject(e)}static credentialFromError(e){return Zn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zn.credential(e.oauthAccessToken)}catch{return null}}}Zn.FACEBOOK_SIGN_IN_METHOD="facebook.com";Zn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er extends za{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return gi._fromParams({providerId:er.PROVIDER_ID,signInMethod:er.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return er.credentialFromTaggedObject(e)}static credentialFromError(e){return er.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return er.credential(t,r)}catch{return null}}}er.GOOGLE_SIGN_IN_METHOD="google.com";er.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr extends za{constructor(){super("github.com")}static credential(e){return gi._fromParams({providerId:tr.PROVIDER_ID,signInMethod:tr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return tr.credentialFromTaggedObject(e)}static credentialFromError(e){return tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return tr.credential(e.oauthAccessToken)}catch{return null}}}tr.GITHUB_SIGN_IN_METHOD="github.com";tr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr extends za{constructor(){super("twitter.com")}static credential(e,t){return gi._fromParams({providerId:nr.PROVIDER_ID,signInMethod:nr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return nr.credentialFromTaggedObject(e)}static credentialFromError(e){return nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return nr.credential(t,r)}catch{return null}}}nr.TWITTER_SIGN_IN_METHOD="twitter.com";nr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await Rn._fromIdTokenResponse(e,r,i),o=cv(r);return new ks({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=cv(r);return new ks({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function cv(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu extends jn{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Hu.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new Hu(e,t,r,i)}}function _0(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Hu._fromErrorAndOperation(n,s,e,r):s})}async function FD(n,e,t=!1){const r=await Ta(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return ks._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jD(n,e,t=!1){const{auth:r}=n;if(Tn(r.app))return Promise.reject(wr(r));const i="reauthenticate";try{const s=await Ta(n,_0(r,i,e,n),t);X(s.idToken,r,"internal-error");const o=wm(s.idToken);X(o,r,"internal-error");const{sub:a}=o;return X(n.uid===a,r,"user-mismatch"),ks._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&en(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v0(n,e,t=!1){if(Tn(n.app))return Promise.reject(wr(n));const r="signIn",i=await _0(n,r,e),s=await ks._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function UD(n,e){return v0(Us(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BD(n){const e=Us(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function zD(n,e,t){return Tn(n.app)?Promise.reject(wr(n)):UD(Ue(n),Bs.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&BD(n),r})}function $D(n,e,t,r){return Ue(n).onIdTokenChanged(e,t,r)}function qD(n,e,t){return Ue(n).beforeAuthStateChanged(e,t)}function KD(n,e,t,r){return Ue(n).onAuthStateChanged(e,t,r)}function GD(n){return Ue(n).signOut()}const Qu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Qu,"1"),this.storage.removeItem(Qu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD=1e3,HD=10;class E0 extends w0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=f0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,u)=>{this.notifyListeners(o,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);fD()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,HD):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},WD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}E0.type="LOCAL";const QD=E0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0 extends w0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}I0.type="SESSION";const T0=I0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YD(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Uc(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async c=>c(t.origin,s)),u=await YD(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Uc.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sm(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,u)=>{const c=Sm("",20);i.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(d),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(){return window}function XD(n){cn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0(){return typeof cn().WorkerGlobalScope<"u"&&typeof cn().importScripts=="function"}async function ZD(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function eb(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function tb(){return S0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A0="firebaseLocalStorageDb",nb=1,Yu="firebaseLocalStorage",R0="fbase_key";class $a{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Bc(n,e){return n.transaction([Yu],e?"readwrite":"readonly").objectStore(Yu)}function rb(){const n=indexedDB.deleteDatabase(A0);return new $a(n).toPromise()}function If(){const n=indexedDB.open(A0,nb);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Yu,{keyPath:R0})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Yu)?e(r):(r.close(),await rb(),e(await If()))})})}async function hv(n,e,t){const r=Bc(n,!0).put({[R0]:e,value:t});return new $a(r).toPromise()}async function ib(n,e){const t=Bc(n,!1).get(e),r=await new $a(t).toPromise();return r===void 0?null:r.value}function dv(n,e){const t=Bc(n,!0).delete(e);return new $a(t).toPromise()}const sb=800,ob=3;class P0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await If(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>ob)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return S0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Uc._getInstance(tb()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await ZD(),!this.activeServiceWorker)return;this.sender=new JD(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||eb()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await If();return await hv(e,Qu,"1"),await dv(e,Qu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>hv(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>ib(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>dv(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Bc(i,!1).getAll();return new $a(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),sb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}P0.type="LOCAL";const ab=P0;new Ba(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lb(n,e){return e?Pn(e):(X(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am extends Im{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return as(e,this._buildIdpRequest())}_linkToIdToken(e,t){return as(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return as(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ub(n){return v0(n.auth,new Am(n),n.bypassAuthState)}function cb(n){const{auth:e,user:t}=n;return X(t,e,"internal-error"),jD(t,new Am(n),n.bypassAuthState)}async function hb(n){const{auth:e,user:t}=n;return X(t,e,"internal-error"),FD(t,new Am(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ub;case"linkViaPopup":case"linkViaRedirect":return hb;case"reauthViaPopup":case"reauthViaRedirect":return cb;default:en(this.auth,"internal-error")}}resolve(e){Mn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Mn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const db=new Ba(2e3,1e4);class Yi extends C0{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Yi.currentPopupAction&&Yi.currentPopupAction.cancel(),Yi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return X(e,this.auth,"internal-error"),e}async onExecution(){Mn(this.filter.length===1,"Popup operations only handle one event");const e=Sm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(un(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(un(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Yi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(un(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,db.get())};e()}}Yi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fb="pendingRedirect",iu=new Map;class pb extends C0{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=iu.get(this.auth._key());if(!e){try{const r=await mb(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}iu.set(this.auth._key(),e)}return this.bypassAuthState||iu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function mb(n,e){const t=_b(e),r=yb(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function gb(n,e){iu.set(n._key(),e)}function yb(n){return Pn(n._redirectPersistence)}function _b(n){return ru(fb,n.config.apiKey,n.name)}async function vb(n,e,t=!1){if(Tn(n.app))return Promise.reject(wr(n));const r=Us(n),i=lb(r,e),o=await new pb(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wb=10*60*1e3;class Eb{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Ib(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!x0(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(un(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=wb&&this.cachedEventUids.clear(),this.cachedEventUids.has(fv(e))}saveEventToCache(e){this.cachedEventUids.add(fv(e)),this.lastProcessedEventTime=Date.now()}}function fv(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function x0({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Ib(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return x0(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tb(n,e={}){return Or(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sb=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ab=/^https?/;async function Rb(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Tb(n);for(const t of e)try{if(Pb(t))return}catch{}en(n,"unauthorized-domain")}function Pb(n){const e=wf(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!Ab.test(t))return!1;if(Sb.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb=new Ba(3e4,6e4);function pv(){const n=cn().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function xb(n){return new Promise((e,t)=>{var r,i,s;function o(){pv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pv(),t(un(n,"network-request-failed"))},timeout:Cb.get()})}if(!((i=(r=cn().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=cn().gapi)===null||s===void 0)&&s.load)o();else{const a=ID("iframefcb");return cn()[a]=()=>{gapi.load?o():t(un(n,"network-request-failed"))},m0(`${ED()}?onload=${a}`).catch(u=>t(u))}}).catch(e=>{throw su=null,e})}let su=null;function kb(n){return su=su||xb(n),su}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Db=new Ba(5e3,15e3),bb="__/auth/iframe",Nb="emulator/auth/iframe",Vb={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ob=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Lb(n){const e=n.config;X(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?vm(e,Nb):`https://${n.config.authDomain}/${bb}`,r={apiKey:e.apiKey,appName:n.name,v:Vs},i=Ob.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Da(r).slice(1)}`}async function Mb(n){const e=await kb(n),t=cn().gapi;return X(t,n,"internal-error"),e.open({where:document.body,url:Lb(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Vb,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=un(n,"network-request-failed"),a=cn().setTimeout(()=>{s(o)},Db.get());function u(){cn().clearTimeout(a),i(r)}r.ping(u).then(u,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fb={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},jb=500,Ub=600,Bb="_blank",zb="http://localhost";class mv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function $b(n,e,t,r=jb,i=Ub){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const u=Object.assign(Object.assign({},Fb),{width:r.toString(),height:i.toString(),top:s,left:o}),c=qe().toLowerCase();t&&(a=l0(c)?Bb:t),o0(c)&&(e=e||zb,u.scrollbars="yes");const d=Object.entries(u).reduce((m,[E,R])=>`${m}${E}=${R},`,"");if(dD(c)&&a!=="_self")return qb(e||"",a),new mv(null);const p=window.open(e||"",a,d);X(p,n,"popup-blocked");try{p.focus()}catch{}return new mv(p)}function qb(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kb="__/auth/handler",Gb="emulator/auth/handler",Wb=encodeURIComponent("fac");async function gv(n,e,t,r,i,s){X(n.config.authDomain,n,"auth-domain-config-required"),X(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Vs,eventId:i};if(e instanceof y0){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",cP(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,p]of Object.entries({}))o[d]=p}if(e instanceof za){const d=e.getScopes().filter(p=>p!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const u=await n._getAppCheckToken(),c=u?`#${Wb}=${encodeURIComponent(u)}`:"";return`${Hb(n)}?${Da(a).slice(1)}${c}`}function Hb({config:n}){return n.emulator?vm(n,Gb):`https://${n.authDomain}/${Kb}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qh="webStorageSupport";class Qb{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=T0,this._completeRedirectFn=vb,this._overrideRedirectResult=gb}async _openPopup(e,t,r,i){var s;Mn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await gv(e,t,r,wf(),i);return $b(e,o,Sm())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await gv(e,t,r,wf(),i);return XD(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Mn(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await Mb(e),r=new Eb(e);return t.register("authEvent",i=>(X(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Qh,{type:Qh},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Qh];o!==void 0&&t(!!o),en(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Rb(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return f0()||a0()||Em()}}const Yb=Qb;var yv="@firebase/auth",_v="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){X(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xb(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Zb(n){ms(new ai("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;X(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:p0(n)},c=new _D(r,i,s,u);return PD(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ms(new ai("auth-internal",e=>{const t=Us(e.getProvider("auth").getImmediate());return(r=>new Jb(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),yr(yv,_v,Xb(n)),yr(yv,_v,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eN=5*60,tN=jE("authIdTokenMaxAge")||eN;let vv=null;const nN=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>tN)return;const i=t==null?void 0:t.token;vv!==i&&(vv=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function rN(n=dC()){const e=vp(n,"auth");if(e.isInitialized())return e.getImmediate();const t=RD(n,{popupRedirectResolver:Yb,persistence:[ab,QD,T0]}),r=jE("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=nN(s.toString());qD(t,o,()=>o(t.currentUser)),$D(t,a=>o(a))}}const i=XR("auth");return i&&CD(t,`http://${i}`),t}function iN(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}vD({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=un("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",iN().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Zb("Browser");const sN={apiKey:"AIzaSyCNjoUvZdproZfv1HqAVeyHA94Nn7NYwBA",authDomain:"inventario-sanmartin.firebaseapp.com",projectId:"inventario-sanmartin",storageBucket:"inventario-sanmartin.firebasestorage.app",messagingSenderId:"135175270983",appId:"1:135175270983:web:66add2c6cd34ba07333762",measurementId:"G-DSTY4KY0T8"},k0=qE(sN),tt=R1(k0,{localCache:j1({tabManager:$1()}),experimentalAutoDetectLongPolling:!0}),Ji=rN(k0),D0=Q.createContext(null);function oN({children:n}){const[e,t]=Q.useState(null),[r,i]=Q.useState(!0);Q.useEffect(()=>{if(!Ji){console.error("Firebase auth no está inicializado."),i(!1);return}const a=KD(Ji,u=>{t(u||null),i(!1)});return()=>a()},[]);const s=(a,u)=>zD(Ji,a,u),o=()=>GD(Ji);return w.jsx(D0.Provider,{value:{user:e,login:s,logout:o,loading:r},children:n})}function b0(){return Q.useContext(D0)}function aN(){const[n,e]=Q.useState(null),[t,r]=Q.useState(!0);return Q.useEffect(()=>{let i=!0,s=!1;const o=c=>{i&&(s=!0,e(c??null),r(!1))},a=async()=>{try{const d=await new Promise(E=>{const R=Ji.currentUser;if(R)return E(R);const D=Ji.onAuthStateChanged(L=>{D(),E(L)})});if(!d)return o(null);const p=Ei(tt,"users",d.uid),m=await WT(p);o(m.exists()?m.data().branchId:null)}catch(c){console.error("[useBranch] error:",c),o(null)}},u=setTimeout(()=>{s||o(null)},7e3);return a(),()=>{i=!1,clearTimeout(u)}},[]),{branchId:n,loading:t}}const Lr=n=>{if(!n)throw new Error("Sin sucursal (branchId) especificada.")},N0=(n,e=4)=>String(n).padStart(e,"0");async function V0(n,e){Lr(n);const t=Ei(tt,"branches",n,"counters","root");return await G1(tt,async i=>{const s=await i.get(t),o=s.exists()?s.data():{entrada:0,salida:0},u=Number(o[e]||0)+1,c={...o,[e]:u,updatedAt:Ln()};return s.exists()?i.update(t,c):i.set(t,c),u})}async function O0(n){Lr(n);const e=Ei(tt,"branches",n,"catalogs","root"),t=await WT(e),{skus:r=[]}=t.exists()?t.data()||{}:{skus:[]},i=dn(tt,"branches",n,"proveedores"),o=(await Ku(i)).docs.map(d=>({id:d.id,...d.data()})),a=dn(tt,"branches",n,"destinos"),c=(await Ku(a)).docs.map(d=>({id:d.id,...d.data()}));return{skus:r,proveedores:o,destinos:c}}async function lN(n,e){Lr(n);const t=Ei(tt,"branches",n,"catalogs","root");await HT(t,{...e||{},updatedAt:Ln()},{merge:!0})}async function uN(n,e){Lr(n);const t=String(e||"").trim();if(!t)throw new Error("Nombre de proveedor vacío.");const r=dn(tt,"branches",n,"proveedores"),i=Cs(r,xs("nombreLower","==",t.toLowerCase())),s=await Ku(i);return s.empty?(await Mc(r,{nombre:t,nombreLower:t.toLowerCase(),createdAt:Ln()})).id:s.docs[0].id}async function cN(n,e){Lr(n);const t=String(e||"").trim();if(!t)throw new Error("Nombre de destino vacío.");const r=dn(tt,"branches",n,"destinos"),i=Cs(r,xs("nombreLower","==",t.toLowerCase())),s=await Ku(i);return s.empty?(await Mc(r,{nombre:t,nombreLower:t.toLowerCase(),createdAt:Ln()})).id:s.docs[0].id}async function hN(n,e){Lr(n);let t=e==null?void 0:e.num;if(!t){const s=await V0(n,"entrada");t=`E-${N0(s)}`}const r=dn(tt,"branches",n,"entradas");return{id:(await Mc(r,{...e,num:t,tipo:"entrada",createdAt:Ln(),updatedAt:Ln()})).id,num:t}}async function dN(n,e){Lr(n);let t=e==null?void 0:e.num;if(!t){const s=await V0(n,"salida");t=`S-${N0(s)}`}const r=dn(tt,"branches",n,"salidas");return{id:(await Mc(r,{...e,num:t,tipo:"salida",createdAt:Ln(),updatedAt:Ln()})).id,num:t}}function fN(n,e={},t,r){try{const i=dn(tt,"branches",n,"entradas");let s=Cs(i,qu("createdAt","desc"));return e.fromISO&&e.toISO&&e.usarRango&&(s=Cs(i,xs("fecha",">=",e.fromISO),xs("fecha","<=",e.toISO),qu("fecha","desc"))),zo(s,o=>{const a=o.docs.map(u=>({id:u.id,...u.data()}));t&&t(a)},o=>r&&r(o))}catch(i){console.error("listenEntradas error:",i),r&&r(i)}}function pN(n,e={},t,r){try{const i=dn(tt,"branches",n,"salidas");let s=Cs(i,qu("createdAt","desc"));return e.fromISO&&e.toISO&&e.usarRango&&(s=Cs(i,xs("fecha",">=",e.fromISO),xs("fecha","<=",e.toISO),qu("fecha","desc"))),zo(s,o=>{const a=o.docs.map(u=>({id:u.id,...u.data()}));t&&t(a)},o=>r&&r(o))}catch(i){console.error("listenSalidas error:",i),r&&r(i)}}async function mN(n,e){if(!n)throw new Error("Falta UID.");Lr(e);const t=Ei(tt,"users",n);return await HT(t,{branchId:e,updatedAt:Ln()},{merge:!0}),e}function gN(n,e,t){if(!n)throw new Error("Sin branchId");const r={skus:null,proveedores:null,destinos:null},i=()=>{const o={};if(r.skus!==null&&(o.skus=r.skus),r.proveedores!==null&&(o.proveedores=r.proveedores),r.destinos!==null&&(o.destinos=r.destinos),Object.keys(o).length>0)try{e(o)}catch(a){t==null||t(a)}},s=[];return s.push(zo(Ei(tt,"branches",n,"catalogs","root"),o=>{const a=o.exists()?o.data()||{}:{};r.skus=Array.isArray(a.skus)?a.skus:[],i()},o=>t==null?void 0:t(o))),s.push(zo(dn(tt,"branches",n,"proveedores"),o=>{r.proveedores=o.docs.map(a=>({id:a.id,...a.data()})),i()},o=>t==null?void 0:t(o))),s.push(zo(dn(tt,"branches",n,"destinos"),o=>{r.destinos=o.docs.map(a=>({id:a.id,...a.data()})),i()},o=>t==null?void 0:t(o))),()=>{s.forEach(o=>{try{o()}catch{}})}}function yN(n){const e=[];let t=[],r="",i=!1;for(let o=0;o<n.length;o++){const a=n[o],u=n[o+1];if(i){if(a==='"'&&u==='"'){r+='"',o++;continue}if(a==='"'){i=!1;continue}r+=a}else{if(a==='"'){i=!0;continue}if(a===","){t.push(r),r="";continue}if(a===`
`||a==="\r"){a==="\r"&&u===`
`&&o++,t.push(r),r="",t.length&&e.push(t),t=[];continue}r+=a}}if((r.length||t.length)&&(t.push(r),e.push(t)),!e.length)return[];const s=e[0].map(o=>String(o||"").trim());return e.slice(1).filter(o=>o.length&&o.some(a=>String(a||"").trim()!=="")).map(o=>Object.fromEntries(s.map((a,u)=>[a,(o[u]??"").toString().trim()])))}function _N(n,e,t="text/plain;charset=utf-8"){const r=new Blob([e],{type:t}),i=URL.createObjectURL(r),s=document.createElement("a");s.href=i,s.download=n,document.body.appendChild(s),s.click(),s.remove(),URL.revokeObjectURL(i)}function bl({children:n}){return w.jsx("span",{style:{display:"inline-block",padding:"2px 8px",fontSize:12,borderRadius:999,background:"#eef2ff",color:"#3730a3",border:"1px solid #c7d2fe"},children:n})}function vN({branchId:n}){const[e,t]=Q.useState(!0),[r,i]=Q.useState(null),[s,o]=Q.useState([]),[a,u]=Q.useState([]),[c,d]=Q.useState([]),[p,m]=Q.useState(""),[E,R]=Q.useState(""),[D,L]=Q.useState([]);Q.useEffect(()=>n?(t(!0),i(null),gN(n,_=>{Array.isArray(_.skus)&&o(_.skus),Array.isArray(_.proveedores)&&u(_.proveedores),Array.isArray(_.destinos)&&d(_.destinos),t(!1)},_=>{console.error("[Catalogos] subscribe error:",_),i(_),t(!1)})):void 0,[n]);const C=Q.useMemo(()=>(s||[]).filter(k=>String(k.activo??"1")!=="0").length,[s]),S=async()=>{const k=(p||"").trim();if(!k)return alert("Escribe el nombre del proveedor.");try{await uN(n,k),m("")}catch(_){console.error("addProveedor",_),alert(`No se pudo guardar el proveedor:
`+((_==null?void 0:_.message)||_))}},P=async()=>{const k=(E||"").trim();if(!k)return alert("Escribe el nombre del destino.");try{await cN(n,k),R("")}catch(_){console.error("addDestino",_),alert(`No se pudo guardar el destino:
`+((_==null?void 0:_.message)||_))}},V=async k=>{if(!k)return;const _=await k.text(),I=yN(_).map(T=>({sku:T.sku||T.SKU||T.Sku||"",nombre:T.nombre||T.name||T.Nombre||"",unidad:T.unidad||T.Unidad||T.unit||"",activo:(T.activo??T.Activo??"1").toString().trim()})).filter(T=>T.sku);if(!I.length){alert("No se encontraron filas válidas con columna 'sku'.");return}if(L(I.slice(0,50)),!!confirm(`Leí ${I.length} SKUs del CSV. ¿Subirlos ahora?`))try{await lN(n,{skus:I}),alert(`SKUs actualizados (${I.length}).`),L([])}catch(T){console.error("upsertCatalogs",T),alert(`No se pudo guardar el catálogo de SKUs:
`+((T==null?void 0:T.message)||T))}},M=()=>{const g=[["sku","nombre","unidad","activo"],...[["POSTA-GALLINA","Posta de Gallina","LB","1"],["HUESO-RES","Hueso de Res","LB","1"],["POLLO-PECHUGA","Pechuga de Pollo","LB","1"]]].map(I=>I.map(T=>/[",\n]/.test(String(T))?`"${String(T).replace(/"/g,'""')}"`:String(T)).join(",")).join(`\r
`);_N("plantilla_skus.csv",g,"text/csv;charset=utf-8")};return e?w.jsx("div",{style:{padding:16},children:w.jsx("div",{style:{fontSize:16,color:"#334155"},children:"Cargando catálogos…"})}):w.jsxs("div",{style:{display:"grid",gap:16},children:[r&&w.jsxs("div",{style:{padding:12,border:"1px solid #fecaca",background:"#fef2f2",borderRadius:10,color:"#991b1b"},children:["No se pudieron cargar algunos datos. Intenta de nuevo. ",w.jsx("br",{}),w.jsx("small",{children:String((r==null?void 0:r.message)||r)})]}),w.jsxs("section",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[w.jsxs(bl,{children:["SKUs: ",(s==null?void 0:s.length)||0]}),w.jsxs(bl,{children:["Activos: ",C]}),w.jsxs(bl,{children:["Proveedores: ",(a==null?void 0:a.length)||0]}),w.jsxs(bl,{children:["Destinos: ",(c==null?void 0:c.length)||0]})]}),w.jsxs("section",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12},children:[w.jsx("h3",{style:{margin:0,marginBottom:8},children:"Proveedores"}),w.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[w.jsx("input",{placeholder:"Nuevo proveedor",value:p,onChange:k=>m(k.target.value),style:{flex:1,minWidth:220,padding:"8px 10px",borderRadius:10,border:"1px solid #cbd5e1"}}),w.jsx("button",{type:"button",onClick:S,children:"Agregar"})]}),w.jsx("div",{style:{maxHeight:240,overflow:"auto",borderTop:"1px solid #f1f5f9",paddingTop:8},children:(a||[]).length===0?w.jsx("div",{style:{color:"#64748b"},children:"— Sin proveedores —"}):w.jsx("ul",{style:{margin:0,padding:0,listStyle:"none",display:"grid",gap:6},children:a.map(k=>w.jsxs("li",{style:{display:"flex",alignItems:"center",gap:8},children:[w.jsx("span",{style:{width:8,height:8,borderRadius:4,background:"#10b981"}}),w.jsx("span",{children:k.nombre})]},k.id))})})]}),w.jsxs("section",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12},children:[w.jsx("h3",{style:{margin:0,marginBottom:8},children:"Destinos"}),w.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[w.jsx("input",{placeholder:"Nuevo destino",value:E,onChange:k=>R(k.target.value),style:{flex:1,minWidth:220,padding:"8px 10px",borderRadius:10,border:"1px solid #cbd5e1"}}),w.jsx("button",{type:"button",onClick:P,children:"Agregar"})]}),w.jsx("div",{style:{maxHeight:240,overflow:"auto",borderTop:"1px solid #f1f5f9",paddingTop:8},children:(c||[]).length===0?w.jsx("div",{style:{color:"#64748b"},children:"— Sin destinos —"}):w.jsx("ul",{style:{margin:0,padding:0,listStyle:"none",display:"grid",gap:6},children:c.map(k=>w.jsxs("li",{style:{display:"flex",alignItems:"center",gap:8},children:[w.jsx("span",{style:{width:8,height:8,borderRadius:4,background:"#0ea5e9"}}),w.jsx("span",{children:k.nombre})]},k.id))})})]}),w.jsxs("section",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12},children:[w.jsx("h3",{style:{margin:0,marginBottom:8},children:"SKUs"}),w.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center",marginBottom:10},children:[w.jsx("button",{type:"button",onClick:M,children:"Descargar plantilla CSV"}),w.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:8,cursor:"pointer"},children:[w.jsx("input",{type:"file",accept:".csv,text/csv",style:{display:"none"},onChange:k=>{var _;return V((_=k.target.files)==null?void 0:_[0])}}),w.jsx("span",{style:{padding:"6px 10px",border:"1px solid #cbd5e1",borderRadius:8,background:"#fff"},children:"Cargar CSV…"})]}),w.jsxs("span",{style:{color:"#64748b"},children:["Columnas: ",w.jsx("code",{children:"sku,nombre,unidad,activo"})]})]}),D.length>0&&w.jsxs("div",{style:{marginBottom:10,padding:8,background:"#f8fafc",borderRadius:10,border:"1px solid #e2e8f0"},children:[w.jsxs("div",{style:{marginBottom:6,color:"#334155"},children:["Previsualización (primeras ",D.length," filas cargadas)"]}),w.jsx("div",{style:{maxHeight:220,overflow:"auto"},children:w.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[w.jsx("thead",{children:w.jsxs("tr",{children:[w.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:6},children:"sku"}),w.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:6},children:"nombre"}),w.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:6},children:"unidad"}),w.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",padding:6},children:"activo"})]})}),w.jsx("tbody",{children:D.map((k,_)=>w.jsxs("tr",{children:[w.jsx("td",{style:{padding:6},children:k.sku}),w.jsx("td",{style:{padding:6},children:k.nombre}),w.jsx("td",{style:{padding:6},children:k.unidad}),w.jsx("td",{style:{padding:6},children:String(k.activo??"1")})]},_))})]})})]}),w.jsx("div",{style:{maxHeight:280,overflow:"auto",borderTop:"1px solid #f1f5f9",paddingTop:8},children:(s||[]).length===0?w.jsx("div",{style:{color:"#64748b"},children:"— Sin SKUs —"}):w.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[w.jsx("thead",{children:w.jsxs("tr",{children:[w.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",paddingBottom:6},children:"SKU"}),w.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",paddingBottom:6},children:"Nombre"}),w.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",paddingBottom:6},children:"Unidad"}),w.jsx("th",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb",paddingBottom:6},children:"Activo"})]})}),w.jsx("tbody",{children:s.map((k,_)=>w.jsxs("tr",{children:[w.jsx("td",{style:{padding:"6px 0"},children:k.sku}),w.jsx("td",{style:{padding:"6px 0"},children:k.nombre}),w.jsx("td",{style:{padding:"6px 0"},children:k.unidad||"—"}),w.jsx("td",{style:{padding:"6px 0"},children:String(k.activo??"1")==="0"?"No":"Sí"})]},k.sku||_))})]})})]})]})}function Ju(){const n=new Date,e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),r=String(n.getDate()).padStart(2,"0"),i=String(n.getHours()).padStart(2,"0"),s=String(n.getMinutes()).padStart(2,"0");return`${e}-${t}-${r}T${i}:${s}`}function L0(n,e=4){return String(n).padStart(e,"0")}function Xu(n){return typeof n=="string"&&/^[0-9]+$/.test(n)}function M0(n){const e=(n||"").trim();if(!Xu(e))return{ok:!1,error:"Código inválido (solo dígitos)."};let t;if(e.length===54)t=31;else if(e.length===52)t=29;else return{ok:!1,error:`Longitud inválida (${e.length}). Se espera 54 o 52.`};const r=e.slice(t,t+3);if(!Xu(r))return{ok:!1,error:"Segmento de peso no encontrado."};const i=+`${r.slice(0,2)}.${r.slice(2)}`;return!isFinite(i)||i<=0?{ok:!1,error:"Peso no válido."}:{ok:!0,weight:i}}function F0(n){const e=(n||"").trim();if(!Xu(e))return{ok:!1,error:"Código inválido (solo dígitos)."};if(e.length!==13)return{ok:!1,error:`Longitud inválida (${e.length}). Se espera 13.`};const t=e.slice(7,11);if(!Xu(t))return{ok:!1,error:"Segmento de peso no encontrado."};const r=+`${t.slice(0,2)}.${t.slice(2)}`;return!isFinite(r)||r<=0?{ok:!1,error:"Peso no válido."}:{ok:!0,weight:r}}function j0({skus:n,onSelect:e}){const[t,r]=Q.useState(""),[i,s]=Q.useState(!1),o=Q.useRef(null),a=Q.useMemo(()=>{const d=t.trim().toLowerCase();return d?(n||[]).filter(p=>p.activo??!0).filter(p=>String(p.sku).toLowerCase().includes(d)||String(p.nombre||"").toLowerCase().includes(d)).slice(0,20):[]},[t,n]),u=d=>{d.key==="Enter"&&a[0]&&(d.preventDefault(),e(a[0]),r(""),s(!1))},c=()=>setTimeout(()=>s(!1),120);return w.jsxs("div",{style:{position:"relative"},children:[w.jsx("input",{ref:o,placeholder:'Buscar por SKU o nombre (ej: "Post")',value:t,onChange:d=>{r(d.target.value),s(!0)},onKeyDown:u,onFocus:()=>s(!0),onBlur:c}),i&&a.length>0&&w.jsx("div",{style:{position:"absolute",left:0,right:0,top:"calc(100% + 4px)",background:"#fff",border:"1px solid #e5e7eb",borderRadius:12,maxHeight:260,overflow:"auto",zIndex:10},children:a.map((d,p)=>w.jsx("div",{style:{padding:"8px 10px",cursor:"pointer"},onMouseDown:m=>{m.preventDefault(),e(d),r(""),s(!1)},children:w.jsxs("div",{children:[w.jsx("b",{children:d.sku})," — ",d.nombre||"(sin nombre)"," ",w.jsx("span",{className:"badge",children:d.unidad||"unidad"})]})},p))})]})}function U0({values:n,onChange:e,max:t=150,idPrefix:r=""}){const[i,s]=Q.useState(null),o=Q.useMemo(()=>(n||[]).reduce((m,E)=>m+(Number(E)||0),0),[n]),a=()=>e([...n||[],0].slice(0,t)),u=(m,E)=>{const R=[...n||[]];R[m]=E,e(R)},c=m=>{const E=(n||[]).slice();E.splice(m,1),e(E)},d=()=>{((n==null?void 0:n.length)||0)!==0&&e((n||[]).slice(0,-1))},p=(m,E)=>{E.key==="Enter"&&(E.preventDefault(),((n==null?void 0:n.length)||0)<t&&(a(),setTimeout(()=>{const R=document.getElementById(`${r}peso-${m+1}`);R==null||R.focus(),R==null||R.select()},20))),(E.key==="Backspace"||E.key==="Delete")&&String((n==null?void 0:n[m])??"").trim()===""&&(E.preventDefault(),c(m),setTimeout(()=>{const R=document.getElementById(`${r}peso-${Math.max(0,m-1)}`);R==null||R.focus(),R==null||R.select()},10)),E.key==="Escape"&&(u(m,""),E.preventDefault())};return w.jsxs("div",{children:[w.jsx("div",{className:"peso-grid",children:(n||[]).map((m,E)=>w.jsxs("div",{className:"peso-box",style:{position:"relative"},children:[w.jsx("input",{id:`${r}peso-${E}`,type:"number",step:"any",value:m,onChange:R=>u(E,R.target.value),onKeyDown:R=>p(E,R)}),w.jsx("button",{type:"button",title:"Eliminar cajita",onClick:()=>c(E),style:{position:"absolute",top:-8,right:-8,width:22,height:22,borderRadius:11,border:"1px solid #e5e7eb",background:"#fff",lineHeight:"20px",fontSize:12},children:"×"})]},E))}),w.jsxs("div",{className:"actions",style:{marginTop:8,display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[w.jsx("button",{type:"button",onClick:a,children:"+ Caja"}),w.jsx("button",{type:"button",onClick:d,children:"Quitar última"}),w.jsx("button",{type:"button",onClick:()=>e([]),children:"Limpiar todas"}),(n||[]).length>0&&w.jsxs("span",{className:"badge",children:["Cajas: ",(n||[]).length]}),w.jsxs("span",{className:"badge",children:["Total: ",o.toLocaleString(void 0,{maximumFractionDigits:2})]})]}),i&&w.jsx("div",{className:"helper",style:{color:i.type==="err"?"#b91c1c":"#0369a1",marginTop:6},children:i.text})]})}function wN({onAdd:n}){const[e,t]=or.useState(""),[r,i]=or.useState(""),[s,o]=or.useState(null),a=d=>{const p=Number(d);if(!isFinite(p)||p<=0){o({t:"err",m:"Peso inválido."});return}n(p),o({t:"ok",m:`Caja agregada: ${p.toFixed(2)}`})},u=()=>{const d=M0(e);if(!d.ok)return o({t:"err",m:d.error});a(d.weight),t("")},c=()=>{const d=F0(r);if(!d.ok)return o({t:"err",m:d.error});a(d.weight),i("")};return w.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:6},children:[w.jsx("input",{placeholder:"Código San Martín (54/52 dígitos)",value:e,onChange:d=>t(d.target.value),onKeyDown:d=>{d.key==="Enter"&&(d.preventDefault(),u())},style:{minWidth:260,padding:"10px 12px",border:"1px solid #cbd5e1",borderRadius:10}}),w.jsx("button",{type:"button",onClick:u,children:"Agregar SM"}),w.jsx("input",{placeholder:"Código básculas (13 dígitos)",value:r,onChange:d=>i(d.target.value),onKeyDown:d=>{d.key==="Enter"&&(d.preventDefault(),c())},style:{minWidth:220,padding:"10px 12px",border:"1px solid #cbd5e1",borderRadius:10}}),w.jsx("button",{type:"button",onClick:c,children:"Agregar báscula"}),s&&w.jsx("span",{style:{color:s.t==="err"?"#b91c1c":"#0369a1"},children:s.m})]})}function EN({branchId:n}){const[e,t]=Q.useState(Ju()),[r,i]=Q.useState(""),[s,o]=Q.useState(""),[a,u]=Q.useState(""),[c,d]=Q.useState([]),[p,m]=Q.useState([]),[E,R]=Q.useState([{sku:"",pesos:[0]}]),[D,L]=Q.useState([]),[C,S]=Q.useState(!1);Q.useEffect(()=>{(async()=>{const A=await O0(n);d(A.skus||[]);const v=(A.proveedores||[]).map(J=>J.nombre);m(v),i(J=>J||v[0]||"")})()},[n]);const P=A=>{const v=[...E];v.splice(A+1,0,{sku:"",pesos:[0]}),R(v)},V=(A,v)=>{const J=[...E];J[A].sku=v,R(J)},M=(A,v)=>{const J=[...E];J[A].pesos=v,R(J)},k=A=>{const v=E.slice();v.splice(A,1),R(v.length?v:[{sku:"",pesos:[0]}])},_=async()=>{var te,de;const A=T({proveedor:r,items:E});if(A)return alert(A);const v=E.filter(U=>U.sku&&I(U)>0).map(U=>({sku:U.sku,cantidad:I(U),pesos:(U.pesos||[]).map(g)})),ie={num:`E-${L0((((te=D[0])==null?void 0:te.seq)||0)+1)}`,fecha:e,proveedor:r,recibidoPor:a,obs:s,items:v};console.log("[Entradas] Registrando…",{branchId:n,entrada:ie});try{S(!0),await x(hN(n,ie),1e4,"No hay respuesta del servidor (timeout)."),console.log("[Entradas] OK"),L([{seq:(((de=D[0])==null?void 0:de.seq)||0)+1,...ie},...D]),t(Ju()),i(p[0]||""),u(""),o(""),R([{sku:"",pesos:[0]}]),alert("Entrada registrada ✅")}catch(U){console.error("[Entradas] registrarEntrada ERROR:",U),alert(`No se pudo registrar la entrada:
${(U==null?void 0:U.message)||U}`)}finally{S(!1)}},g=A=>Number(A??0)||0,I=A=>(A.pesos||[]).reduce((v,J)=>v+g(J),0);function T({proveedor:A,items:v}){if(!A)return"Seleccione proveedor.";if(!(v!=null&&v.length))return"Agregue al menos una línea.";for(let ie=0;ie<v.length;ie++){const te=v[ie],de=I(te);if(de>0&&!te.sku)return`Falta SKU en la línea ${ie+1}.`;if(te.sku&&de<=0)return`Falta peso (> 0) en la línea ${ie+1}.`}return v.filter(ie=>ie.sku&&I(ie)>0).length?null:"Agregue al menos 1 línea válida con SKU y peso."}const x=(A,v=1e4,J="Se excedió el tiempo de espera.")=>Promise.race([A,new Promise((ie,te)=>setTimeout(()=>te(new Error(J)),v))]);return w.jsxs("div",{children:[w.jsx("h2",{children:"Nueva Entrada"}),w.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(220px, 1fr))",gap:12},children:[w.jsxs("div",{children:[w.jsx("div",{children:"Fecha"}),w.jsx("input",{type:"datetime-local",value:e,onChange:A=>t(A.target.value)})]}),w.jsxs("div",{children:[w.jsx("div",{children:"Proveedor"}),w.jsxs("select",{value:r,onChange:A=>i(A.target.value),children:[w.jsx("option",{value:"",children:"— seleccionar —"}),p.map((A,v)=>w.jsx("option",{value:A,children:A},v))]})]}),w.jsxs("div",{children:[w.jsx("div",{children:"Recibido por"}),w.jsx("input",{value:a,onChange:A=>u(A.target.value)})]}),w.jsxs("div",{children:[w.jsx("div",{children:"Notas"}),w.jsx("input",{value:s,onChange:A=>o(A.target.value)})]})]}),w.jsxs("div",{style:{marginTop:16},children:[w.jsxs("table",{className:"table",children:[w.jsx("thead",{children:w.jsxs("tr",{children:[w.jsx("th",{children:"SKU / Nombre"}),w.jsx("th",{children:"Unidad"}),w.jsx("th",{children:"Peso (cajitas)"}),w.jsx("th",{children:"Total"}),w.jsx("th",{})]})}),w.jsx("tbody",{children:E.map((A,v)=>{const J=(c||[]).find(te=>te.sku===A.sku)||{},ie=(A.pesos||[]).reduce((te,de)=>te+(Number(de)||0),0);return w.jsxs("tr",{children:[w.jsx("td",{children:w.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[w.jsx(j0,{skus:c,onSelect:te=>V(v,te.sku)}),A.sku&&w.jsx("span",{className:"badge",children:A.sku}),(J==null?void 0:J.nombre)&&w.jsx("span",{children:J.nombre})]})}),w.jsx("td",{children:J.unidad||"—"}),w.jsxs("td",{children:[w.jsx(U0,{idPrefix:`ent-${v}-`,values:A.pesos,onChange:te=>M(v,te)}),w.jsx(wN,{onAdd:te=>{const de=Array.isArray(A.pesos)?A.pesos.slice():[];de.push(Number(te)),M(v,de)}})]}),w.jsx("td",{children:ie.toLocaleString(void 0,{maximumFractionDigits:2})}),w.jsxs("td",{children:[w.jsx("button",{type:"button",onClick:()=>P(v),children:"+ debajo"})," ",w.jsx("button",{type:"button",onClick:()=>k(v),children:"Quitar"})]})]},v)})})]}),w.jsx("div",{style:{marginTop:12},children:w.jsx("button",{type:"button",onClick:_,disabled:C,children:C?"Guardando…":"Registrar Entrada"})})]})]})}function IN({onAdd:n}){const[e,t]=or.useState(""),[r,i]=or.useState(""),[s,o]=or.useState(null),a=d=>{const p=Number(d);if(!isFinite(p)||p<=0){o({t:"err",m:"Peso inválido."});return}n(p),o({t:"ok",m:`Caja agregada: ${p.toFixed(2)}`})},u=()=>{const d=M0(e);if(!d.ok)return o({t:"err",m:d.error});a(d.weight),t("")},c=()=>{const d=F0(r);if(!d.ok)return o({t:"err",m:d.error});a(d.weight),i("")};return w.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:6},children:[w.jsx("input",{placeholder:"Código San Martín (54/52 dígitos)",value:e,onChange:d=>t(d.target.value),onKeyDown:d=>{d.key==="Enter"&&(d.preventDefault(),u())},style:{minWidth:260,padding:"10px 12px",border:"1px solid #cbd5e1",borderRadius:10}}),w.jsx("button",{type:"button",onClick:u,children:"Agregar SM"}),w.jsx("input",{placeholder:"Código básculas (13 dígitos)",value:r,onChange:d=>i(d.target.value),onKeyDown:d=>{d.key==="Enter"&&(d.preventDefault(),c())},style:{minWidth:220,padding:"10px 12px",border:"1px solid #cbd5e1",borderRadius:10}}),w.jsx("button",{type:"button",onClick:c,children:"Agregar báscula"}),s&&w.jsx("span",{style:{color:s.t==="err"?"#b91c1c":"#0369a1"},children:s.m})]})}function TN({branchId:n}){const[e,t]=Q.useState(Ju()),[r,i]=Q.useState(""),[s,o]=Q.useState(""),[a,u]=Q.useState(""),[c,d]=Q.useState([]),[p,m]=Q.useState([]),[E,R]=Q.useState([{sku:"",pesos:[0]}]),[D,L]=Q.useState([]),[C,S]=Q.useState(!1);Q.useEffect(()=>{(async()=>{const A=await O0(n);d(A.skus||[]);const v=(A.destinos||[]).map(J=>J.nombre);m(v),i(J=>J||v[0]||"")})()},[n]);const P=A=>Number(A??0)||0,V=A=>(A.pesos||[]).reduce((v,J)=>v+P(J),0),M=A=>{const v=[...E];v.splice(A+1,0,{sku:"",pesos:[0]}),R(v)},k=(A,v)=>{const J=[...E];J[A].sku=v,R(J)},_=(A,v)=>{const J=[...E];J[A].pesos=v,R(J)},g=A=>{const v=E.slice();v.splice(A,1),R(v.length?v:[{sku:"",pesos:[0]}])};function I({destino:A,items:v}){if(!A)return"Seleccione destino.";if(!(v!=null&&v.length))return"Agregue al menos una línea.";for(let ie=0;ie<v.length;ie++){const te=v[ie],de=V(te);if(de>0&&!te.sku)return`Falta SKU en la línea ${ie+1}.`;if(te.sku&&de<=0)return`Falta peso (> 0) en la línea ${ie+1}.`}return v.filter(ie=>ie.sku&&V(ie)>0).length?null:"Agregue al menos 1 línea válida con SKU y peso."}const T=(A,v=1e4,J="Se excedió el tiempo de espera.")=>Promise.race([A,new Promise((ie,te)=>setTimeout(()=>te(new Error(J)),v))]),x=async()=>{var te,de;const A=I({destino:r,items:E});if(A)return alert(A);const v=E.filter(U=>U.sku&&V(U)>0).map(U=>({sku:U.sku,cantidad:V(U),pesos:(U.pesos||[]).map(P)})),ie={num:`S-${L0((((te=D[0])==null?void 0:te.seq)||0)+1)}`,fecha:e,destino:r,entregadoPor:a,obs:s,items:v};try{S(!0),await T(dN(n,ie),1e4,"No hay respuesta del servidor (timeout)."),L([{seq:(((de=D[0])==null?void 0:de.seq)||0)+1,...ie},...D]),t(Ju()),i(p[0]||""),u(""),o(""),R([{sku:"",pesos:[0]}]),alert("Salida registrada ✅")}catch(U){console.error("[Salidas] registrarSalida ERROR:",U),alert(`No se pudo registrar la salida:
${(U==null?void 0:U.message)||U}`)}finally{S(!1)}};return w.jsxs("div",{children:[w.jsx("h2",{children:"Nueva Salida"}),w.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(220px, 1fr))",gap:12},children:[w.jsxs("div",{children:[w.jsx("div",{children:"Fecha"}),w.jsx("input",{type:"datetime-local",value:e,onChange:A=>t(A.target.value)})]}),w.jsxs("div",{children:[w.jsx("div",{children:"Destino"}),w.jsxs("select",{value:r,onChange:A=>i(A.target.value),children:[w.jsx("option",{value:"",children:"— seleccionar —"}),p.map((A,v)=>w.jsx("option",{value:A,children:A},v))]})]}),w.jsxs("div",{children:[w.jsx("div",{children:"Entregado por"}),w.jsx("input",{value:a,onChange:A=>u(A.target.value)})]}),w.jsxs("div",{children:[w.jsx("div",{children:"Notas"}),w.jsx("input",{value:s,onChange:A=>o(A.target.value)})]})]}),w.jsxs("div",{style:{marginTop:16},children:[w.jsxs("table",{className:"table",children:[w.jsx("thead",{children:w.jsxs("tr",{children:[w.jsx("th",{children:"SKU / Nombre"}),w.jsx("th",{children:"Unidad"}),w.jsx("th",{children:"Peso (cajitas)"}),w.jsx("th",{children:"Total"}),w.jsx("th",{})]})}),w.jsx("tbody",{children:E.map((A,v)=>{const J=(c||[]).find(te=>te.sku===A.sku)||{},ie=(A.pesos||[]).reduce((te,de)=>te+(Number(de)||0),0);return w.jsxs("tr",{children:[w.jsx("td",{children:w.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[w.jsx(j0,{skus:c,onSelect:te=>k(v,te.sku)}),A.sku&&w.jsx("span",{className:"badge",children:A.sku}),(J==null?void 0:J.nombre)&&w.jsx("span",{children:J.nombre})]})}),w.jsx("td",{children:J.unidad||"—"}),w.jsxs("td",{style:{overflow:"visible"},children:[w.jsx(U0,{idPrefix:`sal-${v}-`,values:A.pesos,onChange:te=>_(v,te)}),w.jsx(IN,{onAdd:te=>{const de=Array.isArray(A.pesos)?A.pesos.slice():[];de.push(Number(te)),_(v,de)}})]}),w.jsx("td",{children:ie.toLocaleString(void 0,{maximumFractionDigits:2})}),w.jsxs("td",{children:[w.jsx("button",{type:"button",onClick:()=>M(v),children:"+ debajo"})," ",w.jsx("button",{type:"button",onClick:()=>g(v),children:"Quitar"})]})]},v)})})]}),w.jsx("div",{style:{marginTop:12},children:w.jsx("button",{type:"button",onClick:x,disabled:C,children:C?"Guardando…":"Registrar Salida"})})]})]})}function SN(n){if(!n)return 0;if(typeof n=="object"&&typeof n.seconds=="number")return n.seconds*1e3;const e=new Date(n);return isNaN(e)?0:e.getTime()}function go(n){const e=SN(n);if(!e)return"";const t=new Date(e),r=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${r}-${i}-${s}`}function wv(){const n=new Date,e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),r=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${r}`}function Nl(n){return(Number(n)||0).toLocaleString(void 0,{maximumFractionDigits:2})}function Ev(n,e){const t=window.open("","_blank","width=900,height=700");if(!t)return alert("Bloqueado por el navegador. Permite ventanas emergentes.");t.document.open(),t.document.write(`<!doctype html>
<html><head>
<meta charset="utf-8" />
<title>${n}</title>
<style>
  body { font-family: system-ui, Arial; padding: 16px; color: #111827; }
  h1 { font-size: 18px; margin: 0 0 12px; }
  .meta { font-size: 13px; color: #334155; margin-bottom: 12px; }
  table { border-collapse: collapse; width: 100%; }
  th, td { border: 1px solid #e5e7eb; padding: 8px; text-align: left; }
  tfoot td { font-weight: 600; }
  .firmas { display:flex; gap:40px; margin-top:32px; }
  .firmas > div { flex:1; }
  .linea { border-top: 1px solid #111; height: 2px; margin-top: 48px; }
</style>
</head><body>${e}</body></html>`),t.document.close(),t.focus(),setTimeout(()=>{t.print(),t.close()},300)}function Yh(n,e,t){const r=`
  <Styles>
    <Style ss:ID="sText"><NumberFormat ss:Format="@"/></Style>
    <Style ss:ID="sNum"><NumberFormat ss:Format="0.00"/></Style>
    <Style ss:ID="sTh"><Font ss:Bold="1"/></Style>
  </Styles>`,i=E=>String(E??"").replace(/&/g,"&amp;").replace(/</g,"&lt;"),s=`<Row>${t.map(E=>`<Cell ss:StyleID="sTh"><Data ss:Type="String">${i(E)}</Data></Cell>`).join("")}</Row>`,o=E=>/sku/i.test(E),a=E=>/(total|cantidad|peso)/i.test(E),u=e.map(E=>"<Row>"+t.map(R=>{const D=typeof R=="string"?R:R.key,L=E[D];return L==null||L===""?'<Cell><Data ss:Type="String"></Data></Cell>':typeof R=="object"&&R.type==="text"?`<Cell ss:StyleID="sText"><Data ss:Type="String">${i(L)}</Data></Cell>`:typeof R=="object"&&R.type==="number"?`<Cell ss:StyleID="sNum"><Data ss:Type="Number">${Number(L)||0}</Data></Cell>`:o(D)?`<Cell ss:StyleID="sText"><Data ss:Type="String">${i(L)}</Data></Cell>`:a(D)?`<Cell ss:StyleID="sNum"><Data ss:Type="Number">${Number(L)||0}</Data></Cell>`:`<Cell><Data ss:Type="String">${i(L)}</Data></Cell>`}).join("")+"</Row>").join(""),c=`<?xml version="1.0"?>
  <?mso-application progid="Excel.Sheet"?>
  <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
            xmlns:o="urn:schemas-microsoft-com:office:office"
            xmlns:x="urn:schemas-microsoft-com:office:excel"
            xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
            xmlns:html="http://www.w3.org/TR/REC-html40">
    ${r}
    <Worksheet ss:Name="Reporte">
      <Table>
        ${s}
        ${u}
      </Table>
    </Worksheet>
  </Workbook>`,d=new Blob([c],{type:"application/vnd.ms-excel"}),p=URL.createObjectURL(d),m=document.createElement("a");m.href=p,m.download=n,document.body.appendChild(m),m.click(),setTimeout(()=>{document.body.removeChild(m),URL.revokeObjectURL(p)},0)}function Jh({title:n,children:e,right:t}){return w.jsxs("div",{style:{marginBottom:24},children:[w.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[w.jsx("h3",{style:{margin:0},children:n}),w.jsx("div",{style:{marginLeft:"auto"},children:t})]}),w.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:e})]})}function AN({from:n,to:e,setFrom:t,setTo:r}){return w.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[w.jsxs("label",{children:["Desde ",w.jsx("input",{type:"date",value:n,onChange:i=>t(i.target.value)})]}),w.jsxs("label",{children:["Hasta ",w.jsx("input",{type:"date",value:e,onChange:i=>r(i.target.value)})]})]})}function RN({branchId:n}){const[e,t]=Q.useState([]),[r,i]=Q.useState([]),[s,o]=Q.useState(wv()),[a,u]=Q.useState(wv()),[c,d]=Q.useState(!0);Q.useEffect(()=>{if(!n)return;d(!0);const M=fN(n,{},_=>{t(_||[]),d(!1)},_=>{console.error("[Reportes] entradas error:",_),d(!1)}),k=pN(n,{},_=>{i(_||[])},_=>{console.error("[Reportes] salidas error:",_)});return()=>{M&&M(),k&&k()}},[n]);const p=M=>{const k=go(M.fecha||M.createdAt);return k?k>=(s||"0000-00-00")&&k<=(a||"9999-12-31"):!1},m=Q.useMemo(()=>(e||[]).filter(p),[e,s,a]),E=Q.useMemo(()=>(r||[]).filter(p),[r,s,a]),R=Q.useMemo(()=>{const M=new Map;for(const k of m)for(const _ of k.items||[]){const g=String(_.sku||""),I=Number(_.cantidad||0)||0;g&&M.set(g,(M.get(g)||0)+I)}for(const k of E)for(const _ of k.items||[]){const g=String(_.sku||""),I=Number(_.cantidad||0)||0;g&&M.set(g,(M.get(g)||0)-I)}return Array.from(M.entries()).map(([k,_])=>({sku:k,diferencia:_})).sort((k,_)=>k.sku.localeCompare(_.sku))},[m,E]),D=(M,k)=>{const _=M.reduce((g,I)=>{var T;return g+(((T=I.items)==null?void 0:T.length)||0)},0);return w.jsx(w.Fragment,{children:w.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[w.jsx("thead",{children:w.jsxs("tr",{children:[w.jsx("th",{children:"#"}),w.jsx("th",{children:"Fecha"}),w.jsx("th",{children:k==="E"?"Proveedor":"Destino"}),w.jsx("th",{children:"Consec"}),w.jsx("th",{children:"Items"})]})}),w.jsx("tbody",{children:M.map((g,I)=>w.jsxs("tr",{children:[w.jsx("td",{children:I+1}),w.jsx("td",{children:go(g.fecha||g.createdAt)}),w.jsx("td",{children:k==="E"?g.proveedor||"—":g.destino||"—"}),w.jsx("td",{children:g.num||"—"}),w.jsx("td",{children:(g.items||[]).map((T,x)=>w.jsxs("div",{children:[T.sku," • ",Nl(T.cantidad)]},x))})]},g.id||I))}),w.jsx("tfoot",{children:w.jsx("tr",{children:w.jsxs("td",{colSpan:5,children:["Total líneas: ",_]})})})]})})},L=(M,k)=>{const _=`
      <h1>${k}</h1>
      <div class="meta">Rango: ${s} a ${a} · Registros: ${M.length}</div>
      <table>
        <thead><tr>
          <th>#</th><th>Fecha</th><th>${k.includes("Entradas")?"Proveedor":"Destino"}</th><th>Consec</th><th>Items</th>
        </tr></thead>
        <tbody>
          ${M.map((g,I)=>`
            <tr>
              <td>${I+1}</td>
              <td>${go(g.fecha||g.createdAt)}</td>
              <td>${k.includes("Entradas")?g.proveedor||"—":g.destino||"—"}</td>
              <td>${g.num||"—"}</td>
              <td>${(g.items||[]).map(T=>`${T.sku} • ${Nl(T.cantidad)}`).join("<br/>")}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
      <div class="firmas">
        <div>
          <div class="linea"></div>
          <div>Entregué conforme</div>
        </div>
        <div>
          <div class="linea"></div>
          <div>Recibí conforme</div>
        </div>
      </div>
    `;Ev(k,_)},C=()=>{const M=[];m.forEach(k=>{(k.items||[]).forEach(_=>{M.push({fecha:go(k.fecha||k.createdAt),proveedor:k.proveedor||"",num:k.num||"",sku:_.sku||"",cantidad:Number(_.cantidad||0)||0})})}),Yh(`entradas_${s}_a_${a}.xls`,M,[{key:"fecha",label:"Fecha",type:"text"},{key:"proveedor",label:"Proveedor",type:"text"},{key:"num",label:"Consec",type:"text"},{key:"sku",label:"SKU",type:"text"},{key:"cantidad",label:"Cantidad",type:"number"}])},S=()=>{const M=[];E.forEach(k=>{(k.items||[]).forEach(_=>{M.push({fecha:go(k.fecha||k.createdAt),destino:k.destino||"",num:k.num||"",sku:_.sku||"",cantidad:Number(_.cantidad||0)||0})})}),Yh(`salidas_${s}_a_${a}.xls`,M,[{key:"fecha",label:"Fecha",type:"text"},{key:"destino",label:"Destino",type:"text"},{key:"num",label:"Consec",type:"text"},{key:"sku",label:"SKU",type:"text"},{key:"cantidad",label:"Cantidad",type:"number"}])},P=()=>{Yh(`diferencia_${s}_a_${a}.xls`,R,[{key:"sku",label:"SKU",type:"text"},{key:"diferencia",label:"Diferencia",type:"number"}])},V=()=>{const M=`
      <h1>Consolidado por SKU (Entradas - Salidas)</h1>
      <div class="meta">Rango: ${s} a ${a} · SKUs: ${R.length}</div>
      <table>
        <thead><tr><th>SKU</th><th>Diferencia</th></tr></thead>
        <tbody>
          ${R.map(k=>`<tr><td>${k.sku}</td><td>${Nl(k.diferencia)}</td></tr>`).join("")}
        </tbody>
      </table>
      <div class="firmas">
        <div>
          <div class="linea"></div>
          <div>Elaboró</div>
        </div>
        <div>
          <div class="linea"></div>
          <div>Revisó</div>
        </div>
      </div>
    `;Ev("Consolidado por SKU",M)};return w.jsxs("div",{children:[w.jsx("h2",{children:"Reportes"}),w.jsx("div",{style:{marginBottom:12},children:w.jsx(AN,{from:s,to:a,setFrom:o,setTo:u})}),c&&w.jsx("div",{style:{padding:12},children:"Cargando…"}),w.jsx(Jh,{title:`Entradas (${m.length})`,right:w.jsxs("div",{style:{display:"flex",gap:8},children:[w.jsx("button",{type:"button",onClick:()=>L(m,"Entradas"),children:"Imprimir"}),w.jsx("button",{type:"button",onClick:C,children:"Exportar XLS"})]}),children:m.length===0?w.jsx("div",{children:"No hay entradas en el rango."}):D(m,"E")}),w.jsx(Jh,{title:`Salidas (${E.length})`,right:w.jsxs("div",{style:{display:"flex",gap:8},children:[w.jsx("button",{type:"button",onClick:()=>L(E,"Salidas"),children:"Imprimir"}),w.jsx("button",{type:"button",onClick:S,children:"Exportar XLS"})]}),children:E.length===0?w.jsx("div",{children:"No hay salidas en el rango."}):D(E,"S")}),w.jsx(Jh,{title:`Consolidado por SKU (Entradas - Salidas) · ${R.length} SKU`,right:w.jsxs("div",{style:{display:"flex",gap:8},children:[w.jsx("button",{type:"button",onClick:V,children:"Imprimir"}),w.jsx("button",{type:"button",onClick:P,children:"Exportar XLS"})]}),children:R.length===0?w.jsx("div",{children:"No hay movimientos en el rango seleccionado."}):w.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[w.jsx("thead",{children:w.jsxs("tr",{children:[w.jsx("th",{children:"SKU"}),w.jsx("th",{children:"Diferencia"})]})}),w.jsx("tbody",{children:R.map(M=>w.jsxs("tr",{children:[w.jsx("td",{children:M.sku}),w.jsx("td",{children:Nl(M.diferencia)})]},M.sku))})]})})]})}const PN=["Carnes Amparito Tienda","CEDI (Cr.Amp.)","Masaya gold","Masaya Mercado","Granada","Produccion"];function CN(){const{user:n}=b0(),[e,t]=Q.useState(""),r=async()=>{try{if(!(n!=null&&n.uid))throw new Error("Usuario no autenticado");await mN(n.uid,e),alert("Sucursal asignada ✅. Recarga o entra de nuevo."),window.location.reload()}catch(i){console.error("[BranchSelector] setUserBranch error:",i),alert("No se pudo asignar la sucursal: "+((i==null?void 0:i.message)||i))}};return w.jsxs("div",{style:{padding:24,maxWidth:420},children:[w.jsx("h3",{children:"Selecciona una sucursal"}),w.jsxs("select",{value:e,onChange:i=>t(i.target.value),style:{width:"100%",padding:8,marginTop:8},children:[w.jsx("option",{value:"",children:"— Seleccionar —"}),PN.map(i=>w.jsx("option",{value:i,children:i},i))]}),w.jsx("button",{type:"button",onClick:r,style:{marginTop:12,padding:"6px 10px"},disabled:!e,children:"Guardar sucursal"})]})}function Vl({active:n,children:e,onClick:t}){return w.jsx("button",{onClick:t,style:{padding:"6px 12px",borderRadius:6,border:"none",background:n?"#0f766e":"#e2e8f0",color:n?"#fff":"#1e293b",cursor:"pointer",fontWeight:500},children:e})}function xN(){const{user:n,login:e,logout:t,loading:r}=b0(),{branchId:i,loading:s}=aN(),[o,a]=Q.useState("catalogos"),[u,c]=Q.useState(""),[d,p]=Q.useState(""),m=r||s;let E=null;return m?E=w.jsx("div",{style:{padding:24},children:"Cargando…"}):n?i?E=w.jsxs("div",{style:{fontFamily:"system-ui, Arial",color:"#111827"},children:[w.jsxs("header",{style:{display:"flex",alignItems:"center",gap:12,padding:"12px 16px",borderBottom:"1px solid #e5e7eb",background:"#f8fafc"},children:[w.jsx("strong",{style:{fontSize:18},children:"Inventario San Martín"}),w.jsxs("nav",{style:{display:"flex",gap:8,marginLeft:16},children:[w.jsx(Vl,{active:o==="catalogos",onClick:()=>a("catalogos"),children:"Catálogos"}),w.jsx(Vl,{active:o==="entradas",onClick:()=>a("entradas"),children:"Entradas"}),w.jsx(Vl,{active:o==="salidas",onClick:()=>a("salidas"),children:"Salidas"}),w.jsx(Vl,{active:o==="reportes",onClick:()=>a("reportes"),children:"Reportes"})]}),w.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:12,alignItems:"center"},children:[w.jsxs("span",{style:{fontSize:13,color:"#334155"},children:[n==null?void 0:n.email," · Sucursal: ",w.jsx("b",{children:i||"N/D"})]}),w.jsx("button",{type:"button",onClick:t,style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff"},children:"Salir"})]})]}),w.jsxs("main",{style:{padding:16},children:[o==="catalogos"&&w.jsx(vN,{branchId:i}),o==="entradas"&&w.jsx(EN,{branchId:i}),o==="salidas"&&w.jsx(TN,{branchId:i}),o==="reportes"&&w.jsx(RN,{branchId:i})]})]}):E=w.jsx(CN,{}):E=w.jsxs("div",{style:{padding:24,maxWidth:400},children:[w.jsx("h2",{children:"Inicia sesión"}),w.jsxs("div",{style:{display:"grid",gap:8},children:[w.jsx("input",{placeholder:"Correo",value:u,onChange:R=>c(R.target.value)}),w.jsx("input",{placeholder:"Contraseña",type:"password",value:d,onChange:R=>p(R.target.value)}),w.jsx("button",{type:"button",onClick:async()=>{try{await e(u,d)}catch(R){alert(R.message)}},children:"Entrar"})]})]}),E}class kN extends or.Component{constructor(e){super(e),this.state={error:null}}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,t){console.error("💥 ErrorBoundary:",e,t)}render(){var e;return this.state.error?w.jsxs("div",{style:{padding:24,fontFamily:"system-ui"},children:[w.jsx("h2",{children:"Se produjo un error en la UI"}),w.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:String(((e=this.state.error)==null?void 0:e.stack)||this.state.error)}),w.jsx("p",{children:"Abre la consola (F12 → Console) para ver detalles."})]}):this.props.children}}Xh.createRoot(document.getElementById("root")).render(w.jsx(or.StrictMode,{children:w.jsx(kN,{children:w.jsx(oN,{children:w.jsx(xN,{})})})}));
